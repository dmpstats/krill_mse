<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applying the Management Strategy Evaluation tool {openMSE} to the Antarctic Krill fishery case - 2&nbsp; GYM/Grym Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../part1_openMSE_GRYM_approx/3_openMSE_sims/openmse_sims.html" rel="next">
<link href="../../part1_openMSE_GRYM_approx/1_RecCV_and_M/generate_RCV_and_M.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

<link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">GYM/Grym Analysis</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Applying the Management Strategy Evaluation tool <code>{openMSE}</code> to the Antarctic Krill fishery case</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../part1_openMSE_GRYM_approx/part1.html" class="sidebar-item-text sidebar-link">Approximating openMSE to Grym</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part1_openMSE_GRYM_approx/1_RecCV_and_M/generate_RCV_and_M.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Recruitment Variability and Natural Mortality</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part1_openMSE_GRYM_approx/2_GRYM_sims/grym_sims.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">GYM/Grym Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part1_openMSE_GRYM_approx/3_openMSE_sims/openmse_sims.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">openMSE-Grym Approximation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part1_openMSE_GRYM_approx/5_appendices/krill_om_report_example.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Appendix: OM Report (<em>scn-1</em>)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">MSE application</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-grym-intro" id="toc-sec-grym-intro" class="nav-link active" data-scroll-target="#sec-grym-intro"><span class="toc-section-number">2.1</span>  Introduction</a>
  <ul class="collapse">
  <li><a href="#sec-grym-framework" id="toc-sec-grym-framework" class="nav-link" data-scroll-target="#sec-grym-framework"><span class="toc-section-number">2.1.1</span>  The GYM/Grym framework</a></li>
  <li><a href="#analysis-goal" id="toc-analysis-goal" class="nav-link" data-scroll-target="#analysis-goal"><span class="toc-section-number">2.1.2</span>  Analysis goal</a></li>
  </ul></li>
  <li><a href="#estimating-gamma_p-under-alternative-grym-parameter-values" id="toc-estimating-gamma_p-under-alternative-grym-parameter-values" class="nav-link" data-scroll-target="#estimating-gamma_p-under-alternative-grym-parameter-values"><span class="toc-section-number">2.2</span>  Estimating <span class="math inline">\(\gamma_p\)</span> under alternative Grym parameter values</a>
  <ul class="collapse">
  <li><a href="#sec-grym-input_scens" id="toc-sec-grym-input_scens" class="nav-link" data-scroll-target="#sec-grym-input_scens"><span class="toc-section-number">2.2.1</span>  Specify input scenarios</a></li>
  <li><a href="#set-gamma-values-under-consideration" id="toc-set-gamma-values-under-consideration" class="nav-link" data-scroll-target="#set-gamma-values-under-consideration"><span class="toc-section-number">2.2.2</span>  Set <span class="math inline">\(\gamma\)</span> values under consideration</a></li>
  <li><a href="#run-grym-models" id="toc-run-grym-models" class="nav-link" data-scroll-target="#run-grym-models"><span class="toc-section-number">2.2.3</span>  Run Grym models</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="toc-section-number">2.3</span>  Results</a>
  <ul class="collapse">
  <li><a href="#simulated-spawning-stock-trajectories" id="toc-simulated-spawning-stock-trajectories" class="nav-link" data-scroll-target="#simulated-spawning-stock-trajectories"><span class="toc-section-number">2.3.1</span>  Simulated Spawning Stock trajectories</a></li>
  <li><a href="#depletion-probability-and-escapement-levels-versus-gamma-values" id="toc-depletion-probability-and-escapement-levels-versus-gamma-values" class="nav-link" data-scroll-target="#depletion-probability-and-escapement-levels-versus-gamma-values"><span class="toc-section-number">2.3.2</span>  Depletion probability and Escapement levels versus <span class="math inline">\(\gamma\)</span> values</a></li>
  <li><a href="#estimated-gamma_p-under-each-input-scenario" id="toc-estimated-gamma_p-under-each-input-scenario" class="nav-link" data-scroll-target="#estimated-gamma_p-under-each-input-scenario"><span class="toc-section-number">2.3.3</span>  Estimated <span class="math inline">\(\gamma_p\)</span> under each input scenario</a></li>
  </ul></li>
  <li><a href="#wrapping-up" id="toc-wrapping-up" class="nav-link" data-scroll-target="#wrapping-up"><span class="toc-section-number">2.4</span>  Wrapping Up</a></li>
  <li><a href="#supplementary-code" id="toc-supplementary-code" class="nav-link" data-scroll-target="#supplementary-code"><span class="toc-section-number">2.5</span>  Supplementary Code</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-grym-sims" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">GYM/Grym Analysis</span></span></h1>
<p class="subtitle lead">Estimating precautionary harvest rates using GYM/Grym under alternative input values</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- --- -->
<!-- subtitle: "Estimating precautionary harvest rates using GYM/Grym under alternative input values" -->
<!-- filters: -->
<!--    - include-code-files -->
<!-- bibliography: ../../references.json -->
<!-- --- -->
<div class="cell">

</div>
<section id="sec-grym-intro" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sec-grym-intro"><span class="header-section-number">2.1</span> Introduction</h2>
<p>The current management of the Antarctic Krill fishery is based on establishing precautionary catch limits that comply with sustainability principles set out by the Commission for the Conservation of Antarctic Marine Living Resources <span class="citation" data-cites="constable_etal00">(CCAMLR, <a href="../../references.html#ref-constable_etal00" role="doc-biblioref">Constable et al. 2000</a>)</span>. In practice, these catch limits are set on the basis of a constant long-term precautionary annual yield (<span class="math inline">\(Y_p\)</span>), which is determined as the proportion (<span class="math inline">\(\gamma_p\)</span>) of the pre-exploitation biomass of the population (<span class="math inline">\(B_0\)</span>) that can be harvested annually while ensuring that CCAMRL objectives are achieved:</p>
<p><span class="math display">\[Y_p = \gamma_p B_0\]</span></p>
<p>The estimation of <span class="math inline">\(B_0\)</span> and <span class="math inline">\(\gamma_p\)</span>, which can be though of as the precautionary harvest rate, are major tasks in the assessment of Krill fisheries.</p>
<p>Estimation of <span class="math inline">\(\gamma_p\)</span> relies on a frequentist probability approach using Monte-Carlo simulations. In this approach, a stochastic population dynamics model is used to project the stock forwards in time under a range of potential <span class="math inline">\(\gamma\)</span> values, each representing a different fraction of <span class="math inline">\(B_0\)</span> taken as a constant catch in each year of the projection.</p>
<p>For each projection, the population’s pre-exploitation state and key stock parameters (e.g.&nbsp;yearly recruitment, mortality, growth) are drawn at random from suitable statistical distributions that account for the natural variability in the population as well as the uncertainty about those key parameters. Projections are repeated thousands of times for new randomly drawn parameter values to evaluate the probability distribution of population status at each year of the projection period under different levels of yield (and thus, fishing mortality). The projection period covers a minimum of 20 years to ensure that long-term trends in the population can be adequately assessed.</p>
<p>Finally, <span class="math inline">\(\gamma_p\)</span> is determined using the following three-step decision rule <span class="citation" data-cites="constable_etal00">(<a href="../../references.html#ref-constable_etal00" role="doc-biblioref">Constable et al. 2000</a>)</span>:</p>
<ol type="1">
<li><p><strong>Depletion rule</strong>: choose a harvest rate, <span class="math inline">\(\gamma_1\)</span>, so that the probability of the spawning stock biomass (<span class="math inline">\(SSB\)</span>) dropping below 20% of its pre-exploitation level (<span class="math inline">\(SSB_0\)</span>) at any given year of a 20-year harvesting period is no more than 10%<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p></li>
<li><p><strong>Escapement rule</strong>: choose a harvest rate, <span class="math inline">\(\gamma_2\)</span>, so that the median escapement at the end of a 20 year period is 75% of the pre-exploitation median level - i.e.&nbsp;the <span class="math inline">\(\gamma\)</span> at which the median of the distribution of <span class="math inline">\(SSB\)</span> after 20 years of harvesting is no less than 75% of the median<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> of <span class="math inline">\(SSB_0\)</span>.</p></li>
<li><p>Select <span class="math inline">\(\gamma_p\)</span> the lower of <span class="math inline">\(\gamma_1\)</span> and <span class="math inline">\(\gamma_2\)</span> values (which returns an harvest rate that is consistent with both previous rules).</p></li>
</ol>
<p>The relative magnitudes of <span class="math inline">\(\gamma_1\)</span> or <span class="math inline">\(\gamma_2\)</span> depend largely on the level of recruitment variability and the degree of uncertainty associated with the estimate of <span class="math inline">\(B_0\)</span> used in the model <span class="citation" data-cites="constable_etal00">(<a href="../../references.html#ref-constable_etal00" role="doc-biblioref">Constable et al. 2000</a>)</span>.</p>
<section id="sec-grym-framework" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="sec-grym-framework"><span class="header-section-number">2.1.1</span> The GYM/Grym framework</h3>
<p>The ongoing catch limit for Antarctic Krill was established in 2010 <span class="citation" data-cites="ccamlr22">(<a href="../../references.html#ref-ccamlr22" role="doc-biblioref">CCAMLR 2022</a>)</span> based on a <span class="math inline">\(\gamma_p\)</span> estimated from the Generalized Yield Model (GYM) developed by <span class="citation" data-cites="constable_delamare96">Constable and de la Mare (<a href="../../references.html#ref-constable_delamare96" role="doc-biblioref">1996</a>)</span>. GYM is an age-structured, non-spatially explicit, single-stock simulation model that accounts for natural variability and uncertainty on population estimates. GYM is not a statistically fitted stock assessment model - i.e.&nbsp;it does not estimate stock parameters from input data. Therefore, all input parameters must be estimated externally and provided directly to the model.</p>
<p>GYM, originally written in Fortran, was later updated and converted into the R package <code>{Grym}</code> <span class="citation" data-cites="maschette_etal20">(<a href="../../references.html#ref-maschette_etal20" role="doc-biblioref">D. Maschette et al. 2020</a>)</span>, which was used to develop CCAMLR’s <a href="https://github.com/ccamlr/Grym_Base_Case/tree/Simulations">base case</a> implementation of Krill assessment for management advice purposes. <span class="citation" data-cites="maschette_wotherspoon21">D. Maschette and Wotherspoon (<a href="../../references.html#ref-maschette_wotherspoon21" role="doc-biblioref">2021</a>)</span> describe the main input parameters used by GYM/Grym for modelling the Krill fishery.</p>
<p>Most relevant features of the GYM/Grym base case configuration for the Krill stock include:</p>
<ul>
<li><p>Stock is structured into 7 age-classes, and assumes that individuals recruit to the modelled stock at age 1. Therefore, the model covers the age ranges 1-2 up to 7-8 years old.</p></li>
<li><p>The final age-class is not an age-plus group, i.e.&nbsp;it is assumed that no individual lives more than 8 years.</p></li>
<li><p>Stock dynamics are modelled at daily time steps, i.e.&nbsp;the model evaluates the status of the stock at 365 time-points whithin each year of the projection period.</p></li>
<li><p>Recruitment is not dictated by a conventional stock-recruitment relationship, such as the Beverton-Holt or the Ricker functions. Instead, yearly numbers of recruits <span class="math inline">\(R_y\)</span> are simulated as random deviates from a mean recruitment that is constant over time, regardless of the spawning stock size. However, the model includes a depletion factor that reduces the simulated recruitment in a given year when the stock falls below the depletion critical point (i.e.&nbsp;<span class="math inline">\(SSB &lt; 0.2 \, SSB_0\)</span>) in the preceding year. The magnitude of this reduction is proportional to the percentage drop from the critical depletion point.</p></li>
<li><p>The main sources of stochasticity between simulations are:</p>
<ul>
<li><p><u>Yearly Recruitment</u>: <span class="math inline">\(R_y\)</span> series are randomly generated from a statistical distribution (Inverse-Beta in the base case) with a fixed mean of 1 and variance estimated from the Proportional Recruitment (PR) model. Recruitment variance, accounting for natural variability in the recruitment process, remains fixed over all years of the projection period, in a given simulation.</p></li>
<li><p><u>Recruitment variance</u>: to account for uncertainty in the estimate of recruitment variance, each simulation uses a new random draw of PR estimates, which are generated in the PR analysis (<a href="../1_RecCV_and_M/generate_RCV_and_M.html"><span>Chapter&nbsp;1</span></a>).</p></li>
<li><p><u>Natural Mortality</u>: for each simulation, a single random value of annual scaling of natural mortality (<span class="math inline">\(M\)</span>) is used to simulate the degree of stock decay due to non-fishing causes over the entire projection period (i.e. <span class="math inline">\(M\)</span> assumed age-independent and constant over time). Natural mortality is also estimated in the PR model, which provides random draws of <span class="math inline">\(M\)</span> accounting for the uncertainty in the estimation process (<a href="../1_RecCV_and_M/generate_RCV_and_M.html"><span>Chapter&nbsp;1</span></a>).</p></li>
<li><p><u>Maturity and gear selectivity ogives</u>: the midpoints of the ogive ramps describing, respectively, the length-class at which 50% of its individuals are mature or available to the fishery, are randomly draw in each simulation from a uniform distribution bounded by a selected minimum and maximum lengths. This accounts for the lack of knowledge about the exact length at which 50% of Krill are either mature or selectable by the fishery. Sampled midpoint values are the same in all years of a given projection.</p></li>
<li><p><u>Pre-exploitation Biomass Survey Estimate</u>: within each simulation, the annual catch limit under each of the considered <span class="math inline">\(\gamma\)</span> values is simulated as <span class="math inline">\(Y = \gamma \widehat{B_0}\)</span>, where <span class="math inline">\(\widehat{B_0}\)</span> is a survey estimate of pre-exploitation biomass. To simulate this estimation process, <span class="math inline">\(\widehat{B_0}\)</span> values are generated by applying log-normal errors to the simulated <span class="math inline">\(B_0\)</span> values, with variance <span class="math inline">\(B0logSD^2\)</span> reflecting the sampling error in surveys. The input value of parameter <span class="math inline">\(B0logSD\)</span> is calculated externally from survey data <span class="citation" data-cites="kinzey21">(e.g. <a href="../../references.html#ref-kinzey21" role="doc-biblioref">Kinzey 2021</a>)</span>.</p></li>
</ul></li>
<li><p>In each simulation, sampled values of stochastic parameters are held fixed across projections covering the range of considered <span class="math inline">\(\gamma\)</span> values. This approach ensures that observed changes in population forecasts within a given simulation are solely attributable to different fishing pressures and not confounded by randomness underlying the simulation process.</p></li>
<li><p>Grym provides the ability the decompose natural mortality and fishing mortality into intra-year components to account for within-year patterns in mortality incidence. However, under the base-case implementation, natural and fishing mortality are assumed to impact all individuals equally through the year.</p></li>
<li><p>Weight-at-length and length-at-age relationships are assumed to be fully deterministic, meaning that growth is considered to be unaffected by natural variability, while power law parameters and von Bertalanffy growth parameters are treated as known without error.</p></li>
</ul>
</section>
<section id="analysis-goal" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="analysis-goal"><span class="header-section-number">2.1.2</span> Analysis goal</h3>
<p>Here we run the GYM/Grym base-case implementation for 8 alternative scenarios of input parameter values, resulting from combining four different PR estimation scenarios with two options for the maturity-at-length ogive curve. This is similar to the ensemble analysis previously conducted by <span class="citation" data-cites="maschette_etal21">D. Maschette et al. (<a href="../../references.html#ref-maschette_etal21" role="doc-biblioref">2021</a>)</span>, with the exception that here we assume recruitment to follow a Log-Normal process.</p>
<p>Random draws of <span class="math inline">\(M\)</span>, recruitment variability <span class="math inline">\(CV_R\)</span> and related PR estimates for each of the four PR scenarios were pre-generated in <a href="../1_RecCV_and_M/generate_RCV_and_M.html"><span>Chapter&nbsp;1</span></a>.</p>
</section>
</section>
<section id="estimating-gamma_p-under-alternative-grym-parameter-values" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="estimating-gamma_p-under-alternative-grym-parameter-values"><span class="header-section-number">2.2</span> Estimating <span class="math inline">\(\gamma_p\)</span> under alternative Grym parameter values</h2>
<section id="sec-grym-input_scens" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="sec-grym-input_scens"><span class="header-section-number">2.2.1</span> Specify input scenarios</h3>
<p>We begin with setting up the combination of Grym parameter values for each scenario. We consider 3 groupings of input parameters:</p>
<ol type="1">
<li>Recruitment parameters estimated from four different PR scenarios (<a href="../1_RecCV_and_M/generate_RCV_and_M.html"><span>Chapter&nbsp;1</span></a>)</li>
<li>Maturity-at-length parameters from two 2 alternative maturity ogive curves</li>
<li>All remaining input parameters, which take unique values across scenarios.</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportional Recruitment scenarios</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>prop_rec_scenarios <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"../part1_shared_files/inputs/grym_parameter_scenarios.xlsx"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">"rec_proportion_scenarios"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ref)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Maturity at length scenarios</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>maturity_scenarios <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"../part1_shared_files/inputs/grym_parameter_scenarios.xlsx"</span>, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">"maturity_ogive_scenarios"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ref)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed parameters</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>fixed_pars <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"../part1_shared_files/inputs/grym_parameter_scenarios.xlsx"</span>, </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">"fixed_parameters"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># load draws of M and CV_R for each PR scenario</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>pr_cvR_M_draws_scen <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../part1_shared_files/outputs/cvR_M_draws_scen.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The four PR scenarios are displayed in <a href="../1_RecCV_and_M/generate_RCV_and_M.html#tbl-pr-scens">Table&nbsp;<span>1.1</span></a>. Parameter values for each of the maturity ogive curves are displayed in <a href="#tbl-mat-scens">Table&nbsp;<span>2.1</span></a>, and fixed Grym input parameters are presented in <a href="#tbl-fixed-pars">Table&nbsp;<span>2.2</span></a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>maturity_scenarios <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mat_scen_id =</span> <span class="st">"Maturity ID"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"Source"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mat50Min =</span> <span class="st">"Min length 50% mature (mm)"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mat50Max =</span> <span class="st">"Max length 50% mature (mm)"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">matrange =</span> <span class="st">"Ogive ramp width (mm)"</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-mat-scens" class="anchored">

<div class="tabwid"><style>.cl-cf1db83e{table-layout:auto;}.cl-cf068cf4{font-family:'Calibri';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-cf068d08{font-family:'Calibri';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-cf18791e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf187928{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf1891ba{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf1891bb{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf1891c4{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf1891c5{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf1891ce{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf1891cf{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-cf1db83e"><caption>Table&nbsp;2.1:  Alternative maturity-at-length ogive parameters, from Maschette et al (2021) </caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-cf1891ba"><p class="cl-cf18791e"><span class="cl-cf068cf4">Maturity ID</span></p></th><th class="cl-cf1891ba"><p class="cl-cf18791e"><span class="cl-cf068cf4">Source</span></p></th><th class="cl-cf1891bb"><p class="cl-cf187928"><span class="cl-cf068cf4">Min length 50% mature (mm)</span></p></th><th class="cl-cf1891bb"><p class="cl-cf187928"><span class="cl-cf068cf4">Max length 50% mature (mm)</span></p></th><th class="cl-cf1891bb"><p class="cl-cf187928"><span class="cl-cf068cf4">Ogive ramp width (mm)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-cf1891c4"><p class="cl-cf18791e"><span class="cl-cf068d08">mat-2010</span></p></td><td class="cl-cf1891c4"><p class="cl-cf18791e"><span class="cl-cf068d08">WG-EMM-2010</span></p></td><td class="cl-cf1891c5"><p class="cl-cf187928"><span class="cl-cf068d08">32.0</span></p></td><td class="cl-cf1891c5"><p class="cl-cf187928"><span class="cl-cf068d08">37.0</span></p></td><td class="cl-cf1891c5"><p class="cl-cf187928"><span class="cl-cf068d08">6.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf1891ce"><p class="cl-cf18791e"><span class="cl-cf068d08">mat-2021</span></p></td><td class="cl-cf1891ce"><p class="cl-cf18791e"><span class="cl-cf068d08">US-AMLR summer surveys</span></p></td><td class="cl-cf1891cf"><p class="cl-cf187928"><span class="cl-cf068d08">37.6</span></p></td><td class="cl-cf1891cf"><p class="cl-cf187928"><span class="cl-cf068d08">44.3</span></p></td><td class="cl-cf1891cf"><p class="cl-cf187928"><span class="cl-cf068d08">8.8</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cit_keys &lt;- fixed_pars |&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct(citation_key) |&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   drop_na() |&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(ref_symb = tolower(as.roman(1:n())))</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>fixed_pars <span class="sc">|&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(parameter_tag, reference)) <span class="sc">|&gt;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">category =</span> <span class="st">"Category"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameter_label =</span> <span class="st">"Parameter"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="st">"Value"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">citation_key =</span> <span class="st">"Reference"</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_v</span>(<span class="at">j =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fix_border_issues</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colformat_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-fixed-pars" class="anchored">

<div class="tabwid"><style>.cl-d07b6c6c{table-layout:auto;}.cl-d072864c{font-family:'Calibri';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d0728660{font-family:'Calibri';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d0763206{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d07646ba{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d07646c4{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d07646c5{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d07646c6{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d07b6c6c"><caption>Table&nbsp;2.2:  Grym input parameters with fixed values accross simulation scenarios </caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-d07646ba"><p class="cl-d0763206"><span class="cl-d072864c">Category</span></p></th><th class="cl-d07646ba"><p class="cl-d0763206"><span class="cl-d072864c">Parameter</span></p></th><th class="cl-d07646ba"><p class="cl-d0763206"><span class="cl-d072864c">Value</span></p></th><th class="cl-d07646ba"><p class="cl-d0763206"><span class="cl-d072864c">Reference</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td rowspan="2" class="cl-d07646c4"><p class="cl-d0763206"><span class="cl-d0728660">PR</span><span class="cl-d0728660"> </span><span class="cl-d0728660">model</span></p></td><td class="cl-d07646c4"><p class="cl-d0763206"><span class="cl-d0728660">Reference</span><span class="cl-d0728660"> </span><span class="cl-d0728660">age</span></p></td><td class="cl-d07646c4"><p class="cl-d0763206"><span class="cl-d0728660">2</span></p></td><td class="cl-d07646c4"><p class="cl-d0763206"><span class="cl-d0728660">Maschette</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Recruitment</span><span class="cl-d0728660"> </span><span class="cl-d0728660">distribution</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Log-Normal</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Mortality</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Within-year</span><span class="cl-d0728660"> </span><span class="cl-d0728660">natural</span><span class="cl-d0728660"> </span><span class="cl-d0728660">mortality</span><span class="cl-d0728660"> </span><span class="cl-d0728660">pattern</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">constant</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="4" class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Population</span><span class="cl-d0728660"> </span><span class="cl-d0728660">model</span><span class="cl-d0728660"> </span><span class="cl-d0728660">structure</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">First</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Age</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Class</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">1</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Last</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Age</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Class</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">7</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Constable</span><span class="cl-d0728660"> </span><span class="cl-d0728660">and</span><span class="cl-d0728660"> </span><span class="cl-d0728660">de</span><span class="cl-d0728660"> </span><span class="cl-d0728660">la</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Mare</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(1996)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Age</span><span class="cl-d0728660"> </span><span class="cl-d0728660">plus</span><span class="cl-d0728660"> </span><span class="cl-d0728660">group</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">No</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Time</span><span class="cl-d0728660"> </span><span class="cl-d0728660">steps</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(days)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">365</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="5" class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Length-at-age</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(von</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Bertalanffy)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">t0</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">0</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Constable</span><span class="cl-d0728660"> </span><span class="cl-d0728660">and</span><span class="cl-d0728660"> </span><span class="cl-d0728660">de</span><span class="cl-d0728660"> </span><span class="cl-d0728660">la</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Mare</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(1996)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">L∞</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(mm)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">60</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Constable</span><span class="cl-d0728660"> </span><span class="cl-d0728660">and</span><span class="cl-d0728660"> </span><span class="cl-d0728660">de</span><span class="cl-d0728660"> </span><span class="cl-d0728660">la</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Mare</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(1996)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">K</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">0.48</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Start</span><span class="cl-d0728660"> </span><span class="cl-d0728660">growth</span><span class="cl-d0728660"> </span><span class="cl-d0728660">period</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(day/month)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">21/Oct</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">End</span><span class="cl-d0728660"> </span><span class="cl-d0728660">growth</span><span class="cl-d0728660"> </span><span class="cl-d0728660">period</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(day/month)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">12/Feb</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="2" class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Weight-at-length</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Weight-length</span><span class="cl-d0728660"> </span><span class="cl-d0728660">parameter</span><span class="cl-d0728660"> </span><span class="cl-d0728660">-</span><span class="cl-d0728660"> </span><span class="cl-d0728660">A</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(g)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">2.24E-06</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">SC-CAMLR</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2000)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Weight-length</span><span class="cl-d0728660"> </span><span class="cl-d0728660">parameter</span><span class="cl-d0728660"> </span><span class="cl-d0728660">-</span><span class="cl-d0728660"> </span><span class="cl-d0728660">B</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">3.314</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">SC-CAMLR</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2000)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="2" class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Spawning</span><span class="cl-d0728660"> </span><span class="cl-d0728660">season</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Start</span><span class="cl-d0728660"> </span><span class="cl-d0728660">of</span><span class="cl-d0728660"> </span><span class="cl-d0728660">spawning</span><span class="cl-d0728660"> </span><span class="cl-d0728660">season</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(day/month)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">15/Dec</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Kawaguchi</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2016)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">End</span><span class="cl-d0728660"> </span><span class="cl-d0728660">of</span><span class="cl-d0728660"> </span><span class="cl-d0728660">spawning</span><span class="cl-d0728660"> </span><span class="cl-d0728660">season</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(day/month)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">15/Feb</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Kawaguchi</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2016)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="3" class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Selectivity</span><span class="cl-d0728660"> </span><span class="cl-d0728660">ogive</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Min</span><span class="cl-d0728660"> </span><span class="cl-d0728660">length,</span><span class="cl-d0728660"> </span><span class="cl-d0728660">50%</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Selected</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(mm)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">30</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Max</span><span class="cl-d0728660"> </span><span class="cl-d0728660">length,</span><span class="cl-d0728660"> </span><span class="cl-d0728660">50%</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Selected</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(mm)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">35</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Ramp</span><span class="cl-d0728660"> </span><span class="cl-d0728660">width</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(mm)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">11</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="2" class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Fishing</span><span class="cl-d0728660"> </span><span class="cl-d0728660">effort</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Start</span><span class="cl-d0728660"> </span><span class="cl-d0728660">of</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Fishing</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Season</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(day/month)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">01/Dec</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">End</span><span class="cl-d0728660"> </span><span class="cl-d0728660">of</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Fishing</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Season</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(day/month)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">30/Nov</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="3" class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">B0</span><span class="cl-d0728660"> </span><span class="cl-d0728660">estimation</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Uncertainty</span><span class="cl-d0728660"> </span><span class="cl-d0728660">in</span><span class="cl-d0728660"> </span><span class="cl-d0728660">B0</span><span class="cl-d0728660"> </span><span class="cl-d0728660">estimate</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">0.361</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Kinzey</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Start</span><span class="cl-d0728660"> </span><span class="cl-d0728660">of</span><span class="cl-d0728660"> </span><span class="cl-d0728660">monitoring</span><span class="cl-d0728660"> </span><span class="cl-d0728660">interval</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(day/month)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">01/Jan</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">End</span><span class="cl-d0728660"> </span><span class="cl-d0728660">of</span><span class="cl-d0728660"> </span><span class="cl-d0728660">monitoring</span><span class="cl-d0728660"> </span><span class="cl-d0728660">interval</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(day/month)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">15/Jan</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Miscellaneous</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Reference</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Date</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(day/month)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">01/Oct</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Thanassekos</span><span class="cl-d0728660"> </span><span class="cl-d0728660">et</span><span class="cl-d0728660"> </span><span class="cl-d0728660">al.</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(2021)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="3" class="cl-d07646c6"><p class="cl-d0763206"><span class="cl-d0728660">Simulation</span><span class="cl-d0728660"> </span><span class="cl-d0728660">options</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Reasonable</span><span class="cl-d0728660"> </span><span class="cl-d0728660">upper</span><span class="cl-d0728660"> </span><span class="cl-d0728660">bound</span><span class="cl-d0728660"> </span><span class="cl-d0728660">for</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Annual</span><span class="cl-d0728660"> </span><span class="cl-d0728660">F</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">1.5</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Constable</span><span class="cl-d0728660"> </span><span class="cl-d0728660">and</span><span class="cl-d0728660"> </span><span class="cl-d0728660">de</span><span class="cl-d0728660"> </span><span class="cl-d0728660">la</span><span class="cl-d0728660"> </span><span class="cl-d0728660">Mare</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(1996)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">Projection</span><span class="cl-d0728660"> </span><span class="cl-d0728660">length</span><span class="cl-d0728660"> </span><span class="cl-d0728660">(number</span><span class="cl-d0728660"> </span><span class="cl-d0728660">of</span><span class="cl-d0728660"> </span><span class="cl-d0728660">years)</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660">20</span></p></td><td class="cl-d07646c5"><p class="cl-d0763206"><span class="cl-d0728660"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d07646c6"><p class="cl-d0763206"><span class="cl-d0728660">Number</span><span class="cl-d0728660"> </span><span class="cl-d0728660">of</span><span class="cl-d0728660"> </span><span class="cl-d0728660">iterations</span></p></td><td class="cl-d07646c6"><p class="cl-d0763206"><span class="cl-d0728660">10001</span></p></td><td class="cl-d07646c6"><p class="cl-d0763206"><span class="cl-d0728660"></span></p></td></tr></tbody></table></div>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># flextable::footnote(</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   j = ~ value, </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   i = ~ citation_key %in% cit_keys$citation_key, </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ref_symbols = left_join(fixed_pars, cit_keys, by = "citation_key") |&gt; drop_na(citation_key) |&gt; pull(ref_symb),</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   value = as_paragraph_md(</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     fixed_pars |&gt; drop_na(citation_key) |&gt; distinct(citation_key) |&gt; pull(citation_key)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ), inline = TRUE</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next we create a look-up table specifying the simulation scenarios, determined by combining the PR scenarios and the two maturity ogive alternatives.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Key of scenarios under consideration for Grym simulations</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>grym_scenarios_key <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pr_scen_id =</span> prop_rec_scenarios<span class="sc">$</span>pr_scen_id,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mat_scen_id =</span> maturity_scenarios<span class="sc">$</span>mat_scen_id</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scenario_id =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"scn-{1:n()}"</span>), <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># save for later</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(grym_scenarios_key, <span class="st">"../part1_shared_files/inputs/scenarios_key.rds"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>grym_scenarios_key <span class="sc">|&gt;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">layout =</span> <span class="st">"autofit"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">scenario_id =</span> <span class="st">"Scenario ID"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">pr_scen_id =</span> <span class="st">"PR Scenario ID"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mat_scen_id =</span> <span class="st">"Maturity ID"</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-sim-scenarios" class="anchored">

<div class="tabwid"><style>.cl-d094c66c{table-layout:auto;width:60%;}.cl-d08c0360{font-family:'Calibri';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d08c036a{font-family:'Calibri';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d08fdf80{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d08ff84e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d08ff84f{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d08ff858{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d08ff859{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d094c66c"><caption>Table&nbsp;2.3:  Specification of parameter input scenarios </caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-d08ff84e"><p class="cl-d08fdf80"><span class="cl-d08c0360">Scenario ID</span></p></th><th class="cl-d08ff84e"><p class="cl-d08fdf80"><span class="cl-d08c0360">PR Scenario ID</span></p></th><th class="cl-d08ff84e"><p class="cl-d08fdf80"><span class="cl-d08c0360">Maturity ID</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d08ff84f"><p class="cl-d08fdf80"><span class="cl-d08c036a">scn-1</span></p></td><td class="cl-d08ff84f"><p class="cl-d08fdf80"><span class="cl-d08c036a">PR-emm21</span></p></td><td class="cl-d08ff84f"><p class="cl-d08fdf80"><span class="cl-d08c036a">mat-2010</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">scn-2</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">PR-emm21</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">mat-2021</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">scn-3</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">PR-amlr</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">mat-2010</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">scn-4</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">PR-amlr</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">mat-2021</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">scn-5</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">PR-atlantida</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">mat-2010</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">scn-6</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">PR-atlantida</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">mat-2021</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">scn-7</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">PR-amlr-haul</span></p></td><td class="cl-d08ff858"><p class="cl-d08fdf80"><span class="cl-d08c036a">mat-2010</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d08ff859"><p class="cl-d08fdf80"><span class="cl-d08c036a">scn-8</span></p></td><td class="cl-d08ff859"><p class="cl-d08fdf80"><span class="cl-d08c036a">PR-amlr-haul</span></p></td><td class="cl-d08ff859"><p class="cl-d08fdf80"><span class="cl-d08c036a">mat-2021</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
<section id="set-gamma-values-under-consideration" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="set-gamma-values-under-consideration"><span class="header-section-number">2.2.2</span> Set <span class="math inline">\(\gamma\)</span> values under consideration</h3>
<p>We also need to define the range of harvest rates <span class="math inline">\(\gamma\)</span> over which population projections will be run. We chose to use equally spaced rates, ranging from no harvest (<span class="math inline">\(\gamma = 0\)</span>) to a constant annual harvest rate of 25% of the pre-exploitation biomass (<span class="math inline">\(\gamma = 0.25\)</span>), with 0.25% increments between them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sequence of gamma values</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e. testing fixed annual harvest rates from 0% to 25% of B0, for increments of 0.25%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>gamma_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="at">by =</span> <span class="fl">0.0025</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>gamma_seq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.0000 0.0025 0.0050 0.0075 0.0100 0.0125 0.0150 0.0175 0.0200 0.0225
 [11] 0.0250 0.0275 0.0300 0.0325 0.0350 0.0375 0.0400 0.0425 0.0450 0.0475
 [21] 0.0500 0.0525 0.0550 0.0575 0.0600 0.0625 0.0650 0.0675 0.0700 0.0725
 [31] 0.0750 0.0775 0.0800 0.0825 0.0850 0.0875 0.0900 0.0925 0.0950 0.0975
 [41] 0.1000 0.1025 0.1050 0.1075 0.1100 0.1125 0.1150 0.1175 0.1200 0.1225
 [51] 0.1250 0.1275 0.1300 0.1325 0.1350 0.1375 0.1400 0.1425 0.1450 0.1475
 [61] 0.1500 0.1525 0.1550 0.1575 0.1600 0.1625 0.1650 0.1675 0.1700 0.1725
 [71] 0.1750 0.1775 0.1800 0.1825 0.1850 0.1875 0.1900 0.1925 0.1950 0.1975
 [81] 0.2000 0.2025 0.2050 0.2075 0.2100 0.2125 0.2150 0.2175 0.2200 0.2225
 [91] 0.2250 0.2275 0.2300 0.2325 0.2350 0.2375 0.2400 0.2425 0.2450 0.2475
[101] 0.2500</code></pre>
</div>
</div>
<p>Finally we generate a grid table with input parameter setups under each scenario, which will be the reference table for the Grym simulations.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spread fixed parameters over columns</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fixed_pars_wide <span class="ot">&lt;-</span> fixed_pars <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(parameter_tag, value) <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> parameter_tag)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># merge fixed parameters with scenario's grid table</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>grym_scen_inputs <span class="ot">&lt;-</span> grym_scenarios_key <span class="sc">|&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(maturity_scenarios, <span class="at">by =</span> <span class="st">"mat_scen_id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>source) <span class="sc">|&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(fixed_pars_wide)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble with list-columns for parameters requiring non-scalar objects</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>grym_scen_setups <span class="ot">&lt;-</span> grym_scen_inputs <span class="sc">|&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(pr_ref_age, first_age, last_age, nsteps, n.years, n_iter), as.integer)) <span class="sc">|&gt;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(t0<span class="sc">:</span>K, a, b, sel50Min<span class="sc">:</span>selrange, B0logsd, Fmax), as.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">.keep =</span> <span class="st">"unused"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ages =</span> <span class="fu">list</span>(first_age<span class="sc">:</span>last_age), <span class="co"># Age-classes</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">spawnI =</span> <span class="fu">list</span>(<span class="fu">get_daily_steps</span>(spawning_start, spawning_end, ref_date)), </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">monitorI =</span> <span class="fu">list</span>(<span class="fu">get_daily_steps</span>(monitoring_start, monitoring_end, ref_date)),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">fishingI =</span> <span class="fu">list</span>(<span class="fu">get_daily_steps</span>(fishing_start, fishing_end, ref_date)),</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">f0 =</span> <span class="fu">days_since_ref</span>(growth_start, ref_date)<span class="sc">/</span><span class="dv">365</span>,      <span class="co"># fraction of year at which growth starts,</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">f1 =</span> <span class="fu">days_since_ref</span>(growth_end, ref_date)<span class="sc">/</span><span class="dv">365</span>,        <span class="co"># fraction of year at which growth ends</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draws of PR estimates (M, CV_R, mnQ, vrQ)</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">prRecruitPars =</span> pr_cvR_M_draws_scen[pr_scen_id], </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># recruitment generating function for assumed rec dist</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">prRecruit =</span> <span class="fu">case_when</span>(                             </span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>      pr_dist <span class="sc">==</span> <span class="st">"Log-Normal"</span> <span class="sc">~</span> <span class="fu">list</span>(recLogNormal),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>      pr_dist <span class="sc">==</span> <span class="st">"Gamma"</span> <span class="sc">~</span> <span class="fu">list</span>(recGamma),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>      pr_dist <span class="sc">==</span> <span class="st">"Invserse-Beta"</span> <span class="sc">~</span> <span class="fu">list</span>(recInverseBeta)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Within-year M pattern</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">ms =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>      M_within_year <span class="sc">==</span> <span class="st">"constant"</span> <span class="sc">~</span> <span class="fu">list</span>(<span class="fu">matrix</span>(<span class="dv">1</span>, nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="fu">length</span>(Ages)))</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sequence of harvest rates over which to run population projections</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">gamma =</span> <span class="fu">list</span>(gamma_seq),</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">outputs_path =</span> outputs_path</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(grym_scen_setups, <span class="st">"../part1_shared_files/inputs/grym_scen_setups.rds"</span>)</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>grym_scen_setups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["scenario_id"],"name":[1],"type":["glue"],"align":["right"]},{"label":["pr_scen_id"],"name":[2],"type":["chr"],"align":["left"]},{"label":["mat_scen_id"],"name":[3],"type":["chr"],"align":["left"]},{"label":["mat50Min"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mat50Max"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["matrange"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["pr_ref_age"],"name":[7],"type":["int"],"align":["right"]},{"label":["pr_dist"],"name":[8],"type":["chr"],"align":["left"]},{"label":["M_within_year"],"name":[9],"type":["chr"],"align":["left"]},{"label":["age_plus"],"name":[10],"type":["chr"],"align":["left"]},{"label":["nsteps"],"name":[11],"type":["int"],"align":["right"]},{"label":["t0"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Linf"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["K"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["a"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["b"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["sel50Min"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["sel50Max"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["selrange"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["B0logsd"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["Fmax"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["n.years"],"name":[22],"type":["int"],"align":["right"]},{"label":["n_iter"],"name":[23],"type":["int"],"align":["right"]},{"label":["Ages"],"name":[24],"type":["list"],"align":["right"]},{"label":["spawnI"],"name":[25],"type":["list"],"align":["right"]},{"label":["monitorI"],"name":[26],"type":["list"],"align":["right"]},{"label":["fishingI"],"name":[27],"type":["list"],"align":["right"]},{"label":["f0"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["f1"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["prRecruitPars"],"name":[30],"type":["named list"],"align":["right"]},{"label":["prRecruit"],"name":[31],"type":["list"],"align":["right"]},{"label":["ms"],"name":[32],"type":["list"],"align":["right"]},{"label":["gamma"],"name":[33],"type":["list"],"align":["right"]},{"label":["outputs_path"],"name":[34],"type":["chr"],"align":["left"]}],"data":[{"1":"scn-1","2":"PR-emm21","3":"mat-2010","4":"32.0","5":"37.0","6":"6.0","7":"2","8":"Log-Normal","9":"constant","10":"No","11":"365","12":"0","13":"60","14":"0.48","15":"2.24e-06","16":"3.314","17":"30","18":"35","19":"11","20":"0.361","21":"1.5","22":"20","23":"10001","24":"<int [7]>","25":"<dbl [63]>","26":"<dbl [15]>","27":"<dbl [365]>","28":"0.05753425","29":"0.369863","30":"<tibble[,4]>","31":"<fun>","32":"<dbl[,7] [366 × 7]>","33":"<dbl [101]>","34":"../part1_shared_files/outputs/grym/model_outputs"},{"1":"scn-2","2":"PR-emm21","3":"mat-2021","4":"37.6","5":"44.3","6":"8.8","7":"2","8":"Log-Normal","9":"constant","10":"No","11":"365","12":"0","13":"60","14":"0.48","15":"2.24e-06","16":"3.314","17":"30","18":"35","19":"11","20":"0.361","21":"1.5","22":"20","23":"10001","24":"<int [7]>","25":"<dbl [63]>","26":"<dbl [15]>","27":"<dbl [365]>","28":"0.05753425","29":"0.369863","30":"<tibble[,4]>","31":"<fun>","32":"<dbl[,7] [366 × 7]>","33":"<dbl [101]>","34":"../part1_shared_files/outputs/grym/model_outputs"},{"1":"scn-3","2":"PR-amlr","3":"mat-2010","4":"32.0","5":"37.0","6":"6.0","7":"2","8":"Log-Normal","9":"constant","10":"No","11":"365","12":"0","13":"60","14":"0.48","15":"2.24e-06","16":"3.314","17":"30","18":"35","19":"11","20":"0.361","21":"1.5","22":"20","23":"10001","24":"<int [7]>","25":"<dbl [63]>","26":"<dbl [15]>","27":"<dbl [365]>","28":"0.05753425","29":"0.369863","30":"<tibble[,4]>","31":"<fun>","32":"<dbl[,7] [366 × 7]>","33":"<dbl [101]>","34":"../part1_shared_files/outputs/grym/model_outputs"},{"1":"scn-4","2":"PR-amlr","3":"mat-2021","4":"37.6","5":"44.3","6":"8.8","7":"2","8":"Log-Normal","9":"constant","10":"No","11":"365","12":"0","13":"60","14":"0.48","15":"2.24e-06","16":"3.314","17":"30","18":"35","19":"11","20":"0.361","21":"1.5","22":"20","23":"10001","24":"<int [7]>","25":"<dbl [63]>","26":"<dbl [15]>","27":"<dbl [365]>","28":"0.05753425","29":"0.369863","30":"<tibble[,4]>","31":"<fun>","32":"<dbl[,7] [366 × 7]>","33":"<dbl [101]>","34":"../part1_shared_files/outputs/grym/model_outputs"},{"1":"scn-5","2":"PR-atlantida","3":"mat-2010","4":"32.0","5":"37.0","6":"6.0","7":"2","8":"Log-Normal","9":"constant","10":"No","11":"365","12":"0","13":"60","14":"0.48","15":"2.24e-06","16":"3.314","17":"30","18":"35","19":"11","20":"0.361","21":"1.5","22":"20","23":"10001","24":"<int [7]>","25":"<dbl [63]>","26":"<dbl [15]>","27":"<dbl [365]>","28":"0.05753425","29":"0.369863","30":"<tibble[,4]>","31":"<fun>","32":"<dbl[,7] [366 × 7]>","33":"<dbl [101]>","34":"../part1_shared_files/outputs/grym/model_outputs"},{"1":"scn-6","2":"PR-atlantida","3":"mat-2021","4":"37.6","5":"44.3","6":"8.8","7":"2","8":"Log-Normal","9":"constant","10":"No","11":"365","12":"0","13":"60","14":"0.48","15":"2.24e-06","16":"3.314","17":"30","18":"35","19":"11","20":"0.361","21":"1.5","22":"20","23":"10001","24":"<int [7]>","25":"<dbl [63]>","26":"<dbl [15]>","27":"<dbl [365]>","28":"0.05753425","29":"0.369863","30":"<tibble[,4]>","31":"<fun>","32":"<dbl[,7] [366 × 7]>","33":"<dbl [101]>","34":"../part1_shared_files/outputs/grym/model_outputs"},{"1":"scn-7","2":"PR-amlr-haul","3":"mat-2010","4":"32.0","5":"37.0","6":"6.0","7":"2","8":"Log-Normal","9":"constant","10":"No","11":"365","12":"0","13":"60","14":"0.48","15":"2.24e-06","16":"3.314","17":"30","18":"35","19":"11","20":"0.361","21":"1.5","22":"20","23":"10001","24":"<int [7]>","25":"<dbl [63]>","26":"<dbl [15]>","27":"<dbl [365]>","28":"0.05753425","29":"0.369863","30":"<tibble[,4]>","31":"<fun>","32":"<dbl[,7] [366 × 7]>","33":"<dbl [101]>","34":"../part1_shared_files/outputs/grym/model_outputs"},{"1":"scn-8","2":"PR-amlr-haul","3":"mat-2021","4":"37.6","5":"44.3","6":"8.8","7":"2","8":"Log-Normal","9":"constant","10":"No","11":"365","12":"0","13":"60","14":"0.48","15":"2.24e-06","16":"3.314","17":"30","18":"35","19":"11","20":"0.361","21":"1.5","22":"20","23":"10001","24":"<int [7]>","25":"<dbl [63]>","26":"<dbl [15]>","27":"<dbl [365]>","28":"0.05753425","29":"0.369863","30":"<tibble[,4]>","31":"<fun>","32":"<dbl[,7] [366 × 7]>","33":"<dbl [101]>","34":"../part1_shared_files/outputs/grym/model_outputs"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="run-grym-models" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="run-grym-models"><span class="header-section-number">2.2.3</span> Run Grym models</h3>
<p>In this section we run the Grym simulations, and thus the estimation of <span class="math inline">\(\gamma_y\)</span>, for each scenario. We do this by sequentially mapping the function <a href="#sec-code-proj-wrapper-fnct"><code>run_grym_krill()</code></a> to each scenarios setup. Function <code>run_grym_krill()</code> is a wrapper that runs simulations within each scenario in parallel, using the projection function <a href="#sec-code-proj-fnct"><code>KrillProjection()</code></a>. It then selects the <span class="math inline">\(\gamma_1\)</span> and <span class="math inline">\(\gamma_2\)</span> values for the scenario being evaluated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: runtime is substantial (~8hrs across 20 cores), so we don't want to run</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this chunk on rendering!</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Progress bar configuration</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">handlers</span>(<span class="fu">handler_progress</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">":spin :current/:total [:bar] :percent in :elapsed ETA: :eta"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">70</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># set-up cores for parallization</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(multisession, <span class="at">workers =</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run simulations - needs to be wrapped in `with-progress` to get progress bars </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># for projection runs</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>grym_scen_outputs <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">with_progress</span>(</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap</span>(grym_scen_setups, run_grym_krill), </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">delay_stdout =</span> <span class="cn">FALSE</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># switch back to sequential computations</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(sequential)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(grym_scen_outputs) <span class="ot">&lt;-</span> grym_scen_setups<span class="sc">$</span>scenario_id</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Write out object with all the results (compressing due to large size)</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(grym_scen_outputs,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>          <span class="st">"../part1_shared_files/outputs/grym/grym_scen_results.rds"</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">compress =</span> <span class="st">"gz"</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">compression =</span> <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="results" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="results"><span class="header-section-number">2.3</span> Results</h2>
<div class="cell">

</div>
<section id="simulated-spawning-stock-trajectories" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="simulated-spawning-stock-trajectories"><span class="header-section-number">2.3.1</span> Simulated Spawning Stock trajectories</h3>
<p><a href="#fig-grym-sss-traject">Figure&nbsp;<span>2.1</span></a> presents the simulated trajectories of spawning Stock Status (<span class="math inline">\(SSS\)</span>), expressing the proportion of <span class="math inline">\(SSB\)</span> relative to <span class="math inline">\(SSB_0\)</span>, at each year of the projecting period. As expected, in all scenarios, trajectories show an increasing proportion of simulations in which <span class="math inline">\(SSB\)</span> drops bellow 20% of <span class="math inline">\(SSB_0\)</span> as the level of harvesting <span class="math inline">\(\gamma\)</span> increases.</p>
<p>It is also clear that input scenarios with higher levels of recruitment variability and uncertainty in <span class="math inline">\(M\)</span> estimates (scen-3 to scen-8, check <a href="#tbl-sim-scenarios">Table&nbsp;<span>2.3</span></a> and <a href="../1_RecCV_and_M/generate_RCV_and_M.html#fig-M-RCV-draws">Figure&nbsp;<span>1.1</span></a> for reference) produce widely variable <span class="math inline">\(SSS\)</span> trajectories. As a result, a large proportion of simulations falls below the depletion threshold even in the absence of fishing (i.e.&nbsp;<span class="math inline">\(\gamma = 0\)</span>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>grym_scen_outputs_sub <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../part1_shared_files/outputs/grym/grym_scen_outputs_sub.rds"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plots of simulated SSS across years, for each scenario under a subset of gammas</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># SSS trajectories that go below 0.2 are signaled in green</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> grym_scen_outputs_sub <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> SSS, <span class="at">group =</span> Run)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="sc">~</span><span class="fu">filter</span>(.x, below_dpl <span class="sc">==</span> <span class="cn">FALSE</span>), </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"gray75"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="sc">~</span><span class="fu">filter</span>(.x, below_dpl <span class="sc">==</span> <span class="cn">TRUE</span>), </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"#1B5E20"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.2</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_sqrt</span>() <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Spawning stock status (SSB/"</span>, SSB[<span class="dv">0</span>], <span class="st">")"</span>))) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(scenario_id), <span class="at">cols =</span> <span class="fu">vars</span>(Gamma), <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> p, </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"../part1_shared_files/outputs/grym/grym_SSS_scenarios.png"</span>, </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">8</span>, </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">9</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-grym-sss-traject" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;2.1: Simulated trajectories of spawning stock status over time, for each scenario (rows) under a subset of the considered <span class="math inline">\(\gamma\)</span> values (columns). Dashed line indicates the depletion threshold (0.2). Trajectories that fall below the 0.2 depletion threshold are signaled in green.</figcaption><p></p>
<p><img src="../part1_shared_files/outputs/grym/grym_SSS_scenarios.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The impact of increasing <span class="math inline">\(\gamma\)</span> values on the biomass of spawners at the end of the projection period (<span class="math inline">\(SSB_Y\)</span>) is also evident in <a href="#fig-grym-ssb0-ssb-dist-final-year">Figure&nbsp;<span>2.2</span></a>. As expected, distributions of <span class="math inline">\(SSB_Y\)</span> fall further from <span class="math inline">\(SSB_0\)</span> distributions as annual harvest rates increase.</p>
<p>In addition, plots in <a href="#fig-grym-ssb0-ssb-dist-final-year">Figure&nbsp;<span>2.2</span></a> illustrate how variability in recruitment (<span class="math inline">\(R\)</span>) and <span class="math inline">\(M\)</span> affect the escapement levels on the stock. Specifically, simulations under scenarios scn-3 to scn-8, which are based on estimates of <span class="math inline">\(M\)</span> and <span class="math inline">\(R\)</span> with higher variability (as shown by wider quantile intervals), tend to produce median <span class="math inline">\(SSB_Y\)</span> values that drop below 75% of the median <span class="math inline">\(SSB_0\)</span> at lower <span class="math inline">\(\gamma\)</span> values compared to those simulated under scenarios scn-1 and scn-2 (which have narrower quantile intervals).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get simulated values of SSB0 and SSB in final year of the projection</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>spawners <span class="ot">&lt;-</span> grym_scen_outputs_sub <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="fu">max</span>(Year)) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario_id, Run, Gamma, SSB, SSB0) <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(SSB , SSB0), <span class="at">names_to =</span> <span class="st">"metric"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">if_else</span>(metric <span class="sc">==</span> <span class="st">"SSB"</span>, <span class="st">"SSBY"</span>, metric),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">if_else</span>(metric <span class="sc">==</span> <span class="st">"SSBY"</span>,  <span class="st">"20"</span>, <span class="st">"0"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compute medians SSB0 and SSB across all simulations , under each scenario</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>med_spawners <span class="ot">&lt;-</span> spawners <span class="sc">|&gt;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scenario_id, metric, Year, Gamma) <span class="sc">|&gt;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">medians =</span> <span class="fu">median</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span>) </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute escapement threshold value, i.e. 75% of median SSB0)</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: values are constant across gammas, as simulated SSB0s are held constant</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># across gamma-specific projections.</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>esc_thresh <span class="ot">&lt;-</span> med_spawners <span class="sc">|&gt;</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(metric <span class="sc">==</span> <span class="st">"SSB0"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">esc_thrs =</span> medians<span class="sc">*</span><span class="fl">0.75</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> spawners <span class="sc">|&gt;</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_interval</span>() <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> med_spawners, <span class="fu">aes</span>(<span class="at">y =</span> medians)) <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> esc_thresh, <span class="fu">aes</span>(<span class="at">yintercept =</span> esc_thrs), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(scenario_id <span class="sc">~</span> Gamma, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Spawning Biomass"</span>, ) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_grey(end = 0.2, start = 0.8)</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Greens"</span>, <span class="at">name =</span> <span class="st">"Quantile Interval (prob)"</span>) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> p2, </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"../part1_shared_files/outputs/grym/grym_SSB0_SSBY_dstbn_scenarios.png"</span>, </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">8</span>, </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">9</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-grym-ssb0-ssb-dist-final-year" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;2.2: Quantile intervals (blue bars) and medians (dots) of simulated pre-explotation spawining biomass (Year 0) and spawning biomass at the final year of the projection (Year 20), across a subset of <span class="math inline">\(\gamma\)</span>s (columns) for each scenario (rows). Dashed lines indicate the critical escapement threshold (i.e.&nbsp;75% of median SSB0).</figcaption><p></p>
<p><img src="../part1_shared_files/outputs/grym/grym_SSB0_SSBY_dstbn_scenarios.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="depletion-probability-and-escapement-levels-versus-gamma-values" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="depletion-probability-and-escapement-levels-versus-gamma-values"><span class="header-section-number">2.3.2</span> Depletion probability and Escapement levels versus <span class="math inline">\(\gamma\)</span> values</h3>
<p><a href="#fig-grym-dplt-esc-gammas">Figure&nbsp;<span>2.3</span></a> shows the depletion probability<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> and the escapement level<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> at the considered range of harvest rates. Here are the main observations:</p>
<ul>
<li><p>For scenarios scn-3, scn-4, scn-7 and scn-8, probability of depletion would be considerably above the 10% critical limit even in the absence of fishing (i.e.&nbsp;<span class="math inline">\(\gamma = 0\)</span>).</p></li>
<li><p>In the remaining scenarios, depletion probability would remain under the 10% critical limit for <span class="math inline">\(\gamma\)</span> values up to 0.075 (scn-6) and 0.125 (scn-1).</p></li>
<li><p>Escapement levels stay above the 75% threshold for a large range of <span class="math inline">\(\gamma\)</span> values, depending on the input scenario. For example, simulations under scn-1 inputs suggest that stock would remain above the 75% escapement threshold for constant harvest rates up to 10% of <span class="math inline">\(B_0\)</span> (i.e.&nbsp;<span class="math inline">\(\gamma = 0.1\)</span>), while for scn-8 the stock would fall below precautionary escapement levels under constant harvest rates above 2% of <span class="math inline">\(B_0\)</span> (i.e.&nbsp;<span class="math inline">\(\gamma = 0.02\)</span>).</p></li>
<li><p>Both plots illustrate how alternative maturity ogives can have a significant impact on the simulation outcomes, as highlighted by the separation between pairs of scenarios (scn-1 &amp; scn-2, scn-3 &amp; scn-4, etc.). Scenarios using the mat-2010 maturity ogive, such as scn-1, scn-3, scn-5, and scn-7, which yields a higher percentage of mature individuals at smaller sizes, show greater resilience to fishing pressure. The projections suggest that under these scenarios, the stock could withstand higher levels of <span class="math inline">\(\gamma\)</span> before falling to unsustainable levels of depletion risk and escapement.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>grym_dpl_esc_gammas <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../part1_shared_files/outputs/grym/grym_dpl_esc_gammas.rds"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for depletion probability under considered gammas</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>p_dpl <span class="ot">&lt;-</span> <span class="fu">plot_gammas_vs_rule</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dt =</span> grym_dpl_esc_gammas, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> Gamma, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">rule_value =</span> Pr_depleted, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scen =</span> scenario_id,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">thresh =</span> <span class="fl">0.1</span>, </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Pr[min(SSB/SSB0) &lt; 0.2] (Years 1 - 20)"</span>, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(gamma),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Depletion"</span>, </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">scen_label =</span> <span class="st">"Scenario ID"</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for escapement level under considered gammas</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>p_esc <span class="ot">&lt;-</span> <span class="fu">plot_gammas_vs_rule</span>(</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">dt =</span> grym_dpl_esc_gammas, </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> Gamma, </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">rule_value =</span> Escapement, </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">scen =</span> scenario_id, </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">thresh =</span> <span class="fl">0.75</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Escapement"</span>, </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"med(SSB)/med(SSB0) in Final Year"</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(gamma),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">scen_label =</span> <span class="st">"Scenario ID"</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>p_dpl<span class="sc">/</span>p_esc <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">'collect'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-grym-dplt-esc-gammas" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;2.3: Depletion probabilities and escapement levels at considered harvest rates <span class="math inline">\(\gamma\)</span> under each scenario. Horizontal dashed lines indicate the 10% probability limit of the depletion rule (top plot) and the 75% critical threshold of the escapement rule (bottom plot).</figcaption><p></p>
<p><img src="grym_sims_files/figure-html/fig-grym-dplt-esc-gammas-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimated-gamma_p-under-each-input-scenario" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="estimated-gamma_p-under-each-input-scenario"><span class="header-section-number">2.3.3</span> Estimated <span class="math inline">\(\gamma_p\)</span> under each input scenario</h3>
<p>Finally, we determine the precautionary harvest rate <span class="math inline">\(\gamma_p\)</span> for each input scenario based on the 3-stage decision rule (<a href="#tbl-grym-selected-gamma">Table&nbsp;<span>2.4</span></a>).</p>
<p>As expected, the chosen Proportional Recruitment scenario had the largest impact on the estimated values of <span class="math inline">\(\gamma_p\)</span>. Specifically, scenarios using PR estimates reflecting lower variability and uncertainty in <span class="math inline">\(R\)</span> and <span class="math inline">\(M\)</span> (scn-1 and scn-2) resulted in higher estimates of <span class="math inline">\(\gamma_p\)</span>, based on the escapement rule (<span class="math inline">\(\gamma_2\)</span>). Conversely, scenarios scn-3, scn-4, scn-7 and scn-8, based on PR estimates conveying the highest variability in <span class="math inline">\(R\)</span> and <span class="math inline">\(M\)</span> (PR-amlr and PR-amlr-haul), returned <span class="math inline">\(\gamma_p\)</span> estimates of 0 based on the depletion rule (<span class="math inline">\(\gamma_1\)</span>). In fact, as seen in <a href="#fig-grym-dplt-esc-gammas">Figure&nbsp;<span>2.3</span></a>, under these scenarios, the risk of depletion in the absence of fishing is already very high, between approximately 25% and 45%.</p>
<!-- that the stock would likely collapse whithin a short period of time. -->
<!-- [^5]: @maschette_etal21 raised concerns about the quality of the recruitment -->
<!-- proportion data used to fit the PR models under the PR-amlr and PR-amlr-haul -->
<!-- scenarios, suggesting they should not be used for management advice. However, in -->
<!-- the context of our analysis, the inclusion of these two PR scenarios are deemed -->
<!-- useful to compare the two different modelling frameworks. -->
<p>The effect of maturity-at-length on <span class="math inline">\(\gamma_p\)</span> estimates is also evident, as previously observed in <a href="#fig-grym-dplt-esc-gammas">Figure&nbsp;<span>2.3</span></a>. Scenarios employing the mat-2021 ogive yielded lower estimates of <span class="math inline">\(\gamma_p\)</span> compared to scenarios using the mat-2010 ogive. Under the same selectivity ogive, the mat-2021 ogive allows a larger number of immature individuals to be vulnerable to the fishery than the mat-2010 ogive. This leads to a reduced incidence of spawners in an exploited population, causing a faster decline of <span class="math inline">\(SSB\)</span> from <span class="math inline">\(SSB_0\)</span> over the projection period. Consequently, the estimates of <span class="math inline">\(\gamma_p\)</span> are lower and more conservative when the mat-2021 ogive is applied.</p>
<p>Scenarios scn-5 and scn-6 are also interesting because they demonstrate how variability in maturity ogives can affect which of the decision rules determines the choice of <span class="math inline">\(\gamma_p\)</span>. Specifically, population simulations using the mat-2021 ogive (scn-6), which sample midpoints from a larger range of values (i.e.&nbsp;higher variability) than the mat-2010 ogive (scn-5), hit the depletion rule at lower <span class="math inline">\(\gamma\)</span> values than the escapement rule (i.e.&nbsp;<span class="math inline">\(\gamma_1 &lt; \gamma_2\)</span>).</p>
<div class="cell" data-hash="grym_sims_cache/html/tbl-grym-selected-gamma_efda863c54dc557c614102153ffbd6a7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>grym_gammas_tbl <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../part1_shared_files/outputs/grym/grym_gammas_tbl.rds"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># gammas in math format</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>gamma_symb <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">gamma_1"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">gamma_2"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">gamma_p"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>grym_gammas_tbl <span class="sc">|&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span>scenario_id, as.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Gamma_1, Gamma_2), <span class="sc">~</span><span class="fu">if_else</span>(<span class="fu">is.infinite</span>(.), <span class="dv">0</span>, .))) <span class="sc">|&gt;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(grym_scenarios_key, <span class="at">by =</span> <span class="st">"scenario_id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Gamma_1<span class="sc">:</span>Gamma_choice, <span class="at">.after =</span> <span class="fu">last_col</span>()) <span class="sc">|&gt;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gamma_p =</span> <span class="fu">pmin</span>(Gamma_1, Gamma_2)) <span class="sc">|&gt;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Gamma_choice) <span class="sc">|&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">layout =</span> <span class="st">"autofit"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bold(j = ~ gamma_p) |&gt;</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="sc">~</span> Gamma_1, <span class="at">i =</span> <span class="sc">~</span> Gamma_1 <span class="sc">&lt;</span> Gamma_2) <span class="sc">|&gt;</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="sc">~</span> Gamma_2, <span class="at">i =</span> <span class="sc">~</span> Gamma_2 <span class="sc">&lt;</span> Gamma_1) <span class="sc">|&gt;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vline</span>(<span class="at">j =</span> <span class="sc">~</span> Gamma_2, <span class="at">border =</span> <span class="fu">fp_border_default</span>(<span class="at">width =</span> .<span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="sc">~</span> gamma_p, <span class="at">bg =</span> <span class="st">"#E8F5E9"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">scenario_id =</span> <span class="st">"Scenario ID"</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">pr_scen_id =</span> <span class="st">"PR Scenario ID"</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">mat_scen_id =</span> <span class="st">"Maturity ID"</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="sc">~</span> Gamma_1 <span class="sc">+</span> Gamma_2 <span class="sc">+</span> gamma_p, <span class="at">width =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">j =</span> <span class="sc">~</span> Gamma_1 <span class="sc">+</span> Gamma_2 <span class="sc">+</span> gamma_p, </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">part =</span> <span class="st">"header"</span>, </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_equation</span>(gamma_symb))) <span class="sc">|&gt;</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span> <span class="sc">~</span> Gamma_1 <span class="sc">+</span> Gamma_2 <span class="sc">+</span> gamma_p, <span class="at">align =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-grym-selected-gamma" class="anchored">

<div class="tabwid"><style>.cl-b539a960{table-layout:auto;width:80%;}.cl-b52d39e6{font-family:'Calibri';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b52d39f0{font-family:'Calibri';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5329062{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5329076{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5329080{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b532b38a{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b394{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b39e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0.5pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b39f{background-color:rgba(232, 245, 233, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0.5pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3a8{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3a9{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3aa{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0.5pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3b2{background-color:rgba(232, 245, 233, 1.00);vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0.5pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3b3{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3bc{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3bd{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0.5pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3c6{background-color:rgba(232, 245, 233, 1.00);vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0.5pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3c7{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3d0{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3da{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0.5pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b532b3f8{background-color:rgba(232, 245, 233, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0.5pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b539a960"><caption>Table&nbsp;2.4:  Estimated precautionary harvest rate under each Grym inputs scenario </caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-b532b38a"><p class="cl-b5329062"><span class="cl-b52d39e6">Scenario ID</span></p></th><th class="cl-b532b38a"><p class="cl-b5329062"><span class="cl-b52d39e6">PR Scenario ID</span></p></th><th class="cl-b532b38a"><p class="cl-b5329062"><span class="cl-b52d39e6">Maturity ID</span></p></th><th class="cl-b532b394"><p class="cl-b5329076"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" data-external="1"><span class="cl-b52d39e6"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>γ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\gamma_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></th><th class="cl-b532b39e"><p class="cl-b5329076"><span class="cl-b52d39e6"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>γ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\gamma_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></th><th class="cl-b532b39f"><p class="cl-b5329076"><span class="cl-b52d39e6"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>γ</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b532b3a8"><p class="cl-b5329062"><span class="cl-b52d39f0">scn-1</span></p></td><td class="cl-b532b3a8"><p class="cl-b5329062"><span class="cl-b52d39f0">PR-emm21</span></p></td><td class="cl-b532b3a8"><p class="cl-b5329062"><span class="cl-b52d39f0">mat-2010</span></p></td><td class="cl-b532b3a9"><p class="cl-b5329080"><span class="cl-b52d39f0">0.1275</span></p></td><td class="cl-b532b3aa"><p class="cl-b5329080"><span class="cl-b52d39e6">0.1075</span></p></td><td class="cl-b532b3b2"><p class="cl-b5329080"><span class="cl-b52d39f0">0.1075</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">scn-2</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">PR-emm21</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">mat-2021</span></p></td><td class="cl-b532b3bc"><p class="cl-b5329080"><span class="cl-b52d39f0">0.1025</span></p></td><td class="cl-b532b3bd"><p class="cl-b5329080"><span class="cl-b52d39e6">0.0900</span></p></td><td class="cl-b532b3c6"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0900</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">scn-3</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">PR-amlr</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">mat-2010</span></p></td><td class="cl-b532b3bc"><p class="cl-b5329080"><span class="cl-b52d39e6">0.0000</span></p></td><td class="cl-b532b3bd"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0375</span></p></td><td class="cl-b532b3c6"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">scn-4</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">PR-amlr</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">mat-2021</span></p></td><td class="cl-b532b3bc"><p class="cl-b5329080"><span class="cl-b52d39e6">0.0000</span></p></td><td class="cl-b532b3bd"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0300</span></p></td><td class="cl-b532b3c6"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">scn-5</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">PR-atlantida</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">mat-2010</span></p></td><td class="cl-b532b3bc"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0800</span></p></td><td class="cl-b532b3bd"><p class="cl-b5329080"><span class="cl-b52d39e6">0.0775</span></p></td><td class="cl-b532b3c6"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0775</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">scn-6</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">PR-atlantida</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">mat-2021</span></p></td><td class="cl-b532b3bc"><p class="cl-b5329080"><span class="cl-b52d39e6">0.0675</span></p></td><td class="cl-b532b3bd"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0700</span></p></td><td class="cl-b532b3c6"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0675</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">scn-7</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">PR-amlr-haul</span></p></td><td class="cl-b532b3b3"><p class="cl-b5329062"><span class="cl-b52d39f0">mat-2010</span></p></td><td class="cl-b532b3bc"><p class="cl-b5329080"><span class="cl-b52d39e6">0.0000</span></p></td><td class="cl-b532b3bd"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0200</span></p></td><td class="cl-b532b3c6"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b532b3c7"><p class="cl-b5329062"><span class="cl-b52d39f0">scn-8</span></p></td><td class="cl-b532b3c7"><p class="cl-b5329062"><span class="cl-b52d39f0">PR-amlr-haul</span></p></td><td class="cl-b532b3c7"><p class="cl-b5329062"><span class="cl-b52d39f0">mat-2021</span></p></td><td class="cl-b532b3d0"><p class="cl-b5329080"><span class="cl-b52d39e6">0.0000</span></p></td><td class="cl-b532b3da"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0150</span></p></td><td class="cl-b532b3f8"><p class="cl-b5329080"><span class="cl-b52d39f0">0.0000</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
</section>
<section id="wrapping-up" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="wrapping-up"><span class="header-section-number">2.4</span> Wrapping Up</h2>
<p>We now have estimates of <span class="math inline">\(\gamma_p\)</span> using the current Grym base-case implementation for the Krill stock under alternative input parameter values. The next step is to replicate this estimation process using the openMSE/DLMtool and assess whether these two frameworks could be used interchangeably.</p>
</section>
<section id="supplementary-code" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="supplementary-code"><span class="header-section-number">2.5</span> Supplementary Code</h2>
<section id="sec-code-proj-wrapper-fnct" class="level4">
<h4 class="anchored" data-anchor-id="sec-code-proj-wrapper-fnct">Wrapper function for running simulations across scenarios</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># --------------------------------------------------------------------------------</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># Run GRYM simulations for the assessment/managements of antarctic krill</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># --------------------------------------------------------------------------------</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co"># </span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#  This is a wrapper on code provided for krill's assessement base-case, useful</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#  for setting up Grym runs under different input scenarios. Specifically:</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#   - Uses the projection function `KrillProjection()`</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#   - Derives gammas based on decision rules</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co"># --------------------------------------------------------------------------------</span></span>
<span id="cb14-11"><a href="#cb14-11"></a></span>
<span id="cb14-12"><a href="#cb14-12"></a>run_grym_krill <span class="ot">&lt;-</span> <span class="cf">function</span>(nsteps, Ages, spawnI, monitorI, fishingI,</span>
<span id="cb14-13"><a href="#cb14-13"></a>        t0, K, Linf, f0, f1, a, b, sel50Min, sel50Max, selrange,</span>
<span id="cb14-14"><a href="#cb14-14"></a>        mat50Min, mat50Max, matrange, B0logsd, prRecruitPars, prRecruit, </span>
<span id="cb14-15"><a href="#cb14-15"></a>        gamma, n.years, ms, Fmax, n_iter, scenario_id, pr_scen_id, </span>
<span id="cb14-16"><a href="#cb14-16"></a>        mat_scen_id, outputs_path, ...){</span>
<span id="cb14-17"><a href="#cb14-17"></a>  </span>
<span id="cb14-18"><a href="#cb14-18"></a>  cli<span class="sc">::</span><span class="fu">cli_h2</span>(<span class="st">"Running GRYM for scenario {scenario_id} [{pr_scen_id}:{mat_scen_id}]"</span>)</span>
<span id="cb14-19"><a href="#cb14-19"></a></span>
<span id="cb14-20"><a href="#cb14-20"></a>  <span class="co"># ---- Set-up projection function</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>  Project <span class="ot">&lt;-</span> <span class="fu">KrillProjection</span>(nsteps, Ages, spawnI, monitorI, fishingI, </span>
<span id="cb14-22"><a href="#cb14-22"></a>    t0, K, Linf, f0, f1, a, b, sel50Min, sel50Max, selrange, </span>
<span id="cb14-23"><a href="#cb14-23"></a>    mat50Min, mat50Max, matrange, B0logsd, prRecruitPars, prRecruit, </span>
<span id="cb14-24"><a href="#cb14-24"></a>    gamma, n.years, ms, Fmax)</span>
<span id="cb14-25"><a href="#cb14-25"></a>  </span>
<span id="cb14-26"><a href="#cb14-26"></a>  </span>
<span id="cb14-27"><a href="#cb14-27"></a>  <span class="co"># ---- Run projections for all gamma values, paralellizing over iterations</span></span>
<span id="cb14-28"><a href="#cb14-28"></a>  </span>
<span id="cb14-29"><a href="#cb14-29"></a>  cli<span class="sc">::</span><span class="fu">cli_alert_info</span>(<span class="st">"Running projections"</span>)</span>
<span id="cb14-30"><a href="#cb14-30"></a>  </span>
<span id="cb14-31"><a href="#cb14-31"></a>  <span class="co">#future::plan(multisession, workers = future::availableCores()-1)</span></span>
<span id="cb14-32"><a href="#cb14-32"></a></span>
<span id="cb14-33"><a href="#cb14-33"></a>  <span class="co"># set progressor counter  </span></span>
<span id="cb14-34"><a href="#cb14-34"></a>  p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> n_iter)</span>
<span id="cb14-35"><a href="#cb14-35"></a>  </span>
<span id="cb14-36"><a href="#cb14-36"></a>  <span class="co"># run projections (for all gammas) </span></span>
<span id="cb14-37"><a href="#cb14-37"></a>  scen_proj <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map_dfr</span>(</span>
<span id="cb14-38"><a href="#cb14-38"></a>    <span class="dv">1</span><span class="sc">:</span>n_iter, <span class="cf">function</span>(x){</span>
<span id="cb14-39"><a href="#cb14-39"></a>      out <span class="ot">&lt;-</span> <span class="fu">Project</span>(x)</span>
<span id="cb14-40"><a href="#cb14-40"></a>      <span class="fu">p</span>()</span>
<span id="cb14-41"><a href="#cb14-41"></a>      out</span>
<span id="cb14-42"><a href="#cb14-42"></a>    },</span>
<span id="cb14-43"><a href="#cb14-43"></a>    <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-44"><a href="#cb14-44"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-45"><a href="#cb14-45"></a>    <span class="fu">mutate</span>(<span class="at">scenario_id =</span> scenario_id, <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb14-46"><a href="#cb14-46"></a>  </span>
<span id="cb14-47"><a href="#cb14-47"></a> <span class="co"># future::plan(sequential)</span></span>
<span id="cb14-48"><a href="#cb14-48"></a>  </span>
<span id="cb14-49"><a href="#cb14-49"></a>  <span class="co">#cat("\n\n")</span></span>
<span id="cb14-50"><a href="#cb14-50"></a>  cli<span class="sc">::</span><span class="fu">cli_alert_success</span>(<span class="st">"Finished projections for scenario {scenario_id}"</span>)</span>
<span id="cb14-51"><a href="#cb14-51"></a>  </span>
<span id="cb14-52"><a href="#cb14-52"></a>  </span>
<span id="cb14-53"><a href="#cb14-53"></a>  <span class="co"># ----  Deriving gammas (using code from workshop)</span></span>
<span id="cb14-54"><a href="#cb14-54"></a>  cli<span class="sc">::</span><span class="fu">cli_alert_info</span>(<span class="st">"Deriving gamma1, gamma2, and final chosen gamma"</span>)</span>
<span id="cb14-55"><a href="#cb14-55"></a></span>
<span id="cb14-56"><a href="#cb14-56"></a>  gamma_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb14-57"><a href="#cb14-57"></a>  <span class="co">#gamma_results$Scenario &lt;- scenario_id</span></span>
<span id="cb14-58"><a href="#cb14-58"></a>  gamma_results<span class="sc">$</span>dep_rule <span class="ot">&lt;-</span> scen_proj <span class="sc">|&gt;</span></span>
<span id="cb14-59"><a href="#cb14-59"></a>    <span class="fu">group_by</span>(Gamma, Run) <span class="sc">|&gt;</span></span>
<span id="cb14-60"><a href="#cb14-60"></a>    <span class="fu">summarize</span>(<span class="at">min_pop_status =</span> <span class="fu">min</span>(SSB<span class="sc">/</span>SSB0), <span class="at">.groups =</span> <span class="st">"drop_last"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-61"><a href="#cb14-61"></a>    <span class="fu">summarize</span>(<span class="at">Pr_depleted =</span> <span class="fu">mean</span>(min_pop_status <span class="sc">&lt;</span> <span class="fl">0.2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb14-62"><a href="#cb14-62"></a>    <span class="fu">mutate</span>(<span class="at">scenario_id =</span> scenario_id, <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb14-63"><a href="#cb14-63"></a></span>
<span id="cb14-64"><a href="#cb14-64"></a>  <span class="co"># Given the gamma values tested, gamma 1 is:</span></span>
<span id="cb14-65"><a href="#cb14-65"></a>  gamma_results<span class="sc">$</span>Gamma_1 <span class="ot">&lt;-</span> <span class="fu">max</span>(gamma_results<span class="sc">$</span>dep_rule<span class="sc">$</span>Gamma[gamma_results<span class="sc">$</span>dep_rule<span class="sc">$</span>Pr_depleted<span class="sc">&lt;=</span><span class="fl">0.1</span>])</span>
<span id="cb14-66"><a href="#cb14-66"></a></span>
<span id="cb14-67"><a href="#cb14-67"></a>  <span class="co"># What is the approximate Gamma that meets 10% depletion to test.</span></span>
<span id="cb14-68"><a href="#cb14-68"></a>  gamma_results<span class="sc">$</span>test_gamma_1 <span class="ot">&lt;-</span> <span class="fu">approx</span>(gamma_results<span class="sc">$</span>dep_rule<span class="sc">$</span>Pr_depleted,gamma_results<span class="sc">$</span>dep_rule<span class="sc">$</span>Gamma,<span class="fl">0.1</span>, <span class="at">ties =</span> mean)<span class="sc">$</span>y</span>
<span id="cb14-69"><a href="#cb14-69"></a></span>
<span id="cb14-70"><a href="#cb14-70"></a>  <span class="co"># Gamma 2:</span></span>
<span id="cb14-71"><a href="#cb14-71"></a>  gamma_results<span class="sc">$</span>esc_rule <span class="ot">&lt;-</span> scen_proj <span class="sc">|&gt;</span></span>
<span id="cb14-72"><a href="#cb14-72"></a>    <span class="fu">group_by</span>(Gamma) <span class="sc">|&gt;</span></span>
<span id="cb14-73"><a href="#cb14-73"></a>    <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="fu">max</span>(Year)) <span class="sc">|&gt;</span></span>
<span id="cb14-74"><a href="#cb14-74"></a>    <span class="fu">summarise</span>(<span class="at">ssb_med =</span> <span class="fu">median</span>(SSB), <span class="at">ssb0_med =</span> <span class="fu">median</span>(SSB0)) <span class="sc">|&gt;</span></span>
<span id="cb14-75"><a href="#cb14-75"></a>    <span class="fu">mutate</span>(</span>
<span id="cb14-76"><a href="#cb14-76"></a>      <span class="at">Escapement =</span> ssb_med<span class="sc">/</span>ssb0_med,</span>
<span id="cb14-77"><a href="#cb14-77"></a>      <span class="at">scenario_id =</span> scenario_id</span>
<span id="cb14-78"><a href="#cb14-78"></a>    ) </span>
<span id="cb14-79"><a href="#cb14-79"></a>  </span>
<span id="cb14-80"><a href="#cb14-80"></a>  <span class="co">#gamma_results$esc_rule$Escapement&lt;-gamma_results$esc_rule$ssb_med/gamma_results$esc_rule$ssb0_med</span></span>
<span id="cb14-81"><a href="#cb14-81"></a>  </span>
<span id="cb14-82"><a href="#cb14-82"></a>  <span class="co">#Given the gamma values tested, gamma 2 is:</span></span>
<span id="cb14-83"><a href="#cb14-83"></a>  gamma_results<span class="sc">$</span>Gamma_2<span class="ot">&lt;-</span><span class="fu">max</span>(gamma_results<span class="sc">$</span>esc_rule<span class="sc">$</span>Gamma[gamma_results<span class="sc">$</span>esc_rule<span class="sc">$</span>Escapement<span class="sc">&gt;=</span><span class="fl">0.75</span>])</span>
<span id="cb14-84"><a href="#cb14-84"></a></span>
<span id="cb14-85"><a href="#cb14-85"></a>  <span class="co">#What is the approximate Gamma that meets 75% escapement to test.</span></span>
<span id="cb14-86"><a href="#cb14-86"></a>  gamma_results<span class="sc">$</span>test_gamma_2 <span class="ot">&lt;-</span> <span class="fu">approx</span>(gamma_results<span class="sc">$</span>esc_rule<span class="sc">$</span>Escapement,gamma_results<span class="sc">$</span>esc_rule<span class="sc">$</span>Gamma,<span class="fl">0.75</span>, <span class="at">ties =</span> mean)<span class="sc">$</span>y</span>
<span id="cb14-87"><a href="#cb14-87"></a></span>
<span id="cb14-88"><a href="#cb14-88"></a>  <span class="co">#The actual Gamma is the smallest of the two gammas:</span></span>
<span id="cb14-89"><a href="#cb14-89"></a>  gamma_results<span class="sc">$</span>GammaToUse <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">c</span>(gamma_results<span class="sc">$</span>Gamma_1,gamma_results<span class="sc">$</span>Gamma_2)<span class="sc">==</span></span>
<span id="cb14-90"><a href="#cb14-90"></a>                                      <span class="fu">min</span>(gamma_results<span class="sc">$</span>Gamma_1,gamma_results<span class="sc">$</span>Gamma_2)) <span class="co">#Which gamma is min?</span></span>
<span id="cb14-91"><a href="#cb14-91"></a>  <span class="cf">if</span>(<span class="fu">length</span>(gamma_results<span class="sc">$</span>GammaToUse)<span class="sc">==</span><span class="dv">2</span>){gamma_results<span class="sc">$</span>GammaToUse<span class="ot">=</span><span class="dv">3</span>} <span class="co">#when gamma1 and gamma2 are equal</span></span>
<span id="cb14-92"><a href="#cb14-92"></a>  gamma_results<span class="sc">$</span>Selected_gamma<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(gamma_results<span class="sc">$</span>Gamma_1, gamma_results<span class="sc">$</span>Gamma_2,</span>
<span id="cb14-93"><a href="#cb14-93"></a>                                                    gamma_results<span class="sc">$</span>GammaToUse, scenario_id))</span>
<span id="cb14-94"><a href="#cb14-94"></a>  <span class="fu">names</span>(gamma_results<span class="sc">$</span>Selected_gamma) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gamma_1"</span>, <span class="st">"Gamma_2"</span>, <span class="st">"Gamma_choice"</span>, <span class="st">"scenario_id"</span>)</span>
<span id="cb14-95"><a href="#cb14-95"></a></span>
<span id="cb14-96"><a href="#cb14-96"></a>  <span class="co"># writing out projections</span></span>
<span id="cb14-97"><a href="#cb14-97"></a>  cli<span class="sc">::</span><span class="fu">cli_alert_info</span>(<span class="st">"Writing out results"</span>)</span>
<span id="cb14-98"><a href="#cb14-98"></a></span>
<span id="cb14-99"><a href="#cb14-99"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">scen_proj =</span> scen_proj, <span class="at">gamma_results =</span> gamma_results)</span>
<span id="cb14-100"><a href="#cb14-100"></a></span>
<span id="cb14-101"><a href="#cb14-101"></a>  <span class="fu">write_rds</span>(</span>
<span id="cb14-102"><a href="#cb14-102"></a>    results,</span>
<span id="cb14-103"><a href="#cb14-103"></a>    <span class="at">file =</span> fs<span class="sc">::</span><span class="fu">path</span>(outputs_path, glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"grym_results_{scenario_id}_{pr_scen_id}_{mat_scen_id}.rds"</span>)),</span>
<span id="cb14-104"><a href="#cb14-104"></a>    <span class="at">compress =</span> <span class="st">"gz"</span>,</span>
<span id="cb14-105"><a href="#cb14-105"></a>    <span class="at">compression =</span> <span class="dv">9</span></span>
<span id="cb14-106"><a href="#cb14-106"></a>  )</span>
<span id="cb14-107"><a href="#cb14-107"></a>  </span>
<span id="cb14-108"><a href="#cb14-108"></a>  results</span>
<span id="cb14-109"><a href="#cb14-109"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-code-proj-fnct" class="level4">
<h4 class="anchored" data-anchor-id="sec-code-proj-fnct">Krill Base-case projection function</h4>
<p>This is modified version of the <code>KrillProjection()</code> function available in CCAMLR’s Krill base-case <a href="https://github.com/ccamlr/Grym_Base_Case/blob/Simulations/3_Code/Source/Projection_function.R">repo</a> that adds arguments <code>ms</code> and <code>Fmax</code>, for convenience.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># --------------------------------------------------------------------------------</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co"># GRYM's Projection function for Krill</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># --------------------------------------------------------------------------------</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co"># Modified by BARC in 15/12/2021 to:</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#   - include the parameter `ms` as a function argument to allow for the</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#   specification of intra-annual natural mortality patterns</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#   - remove unused arguments for proportional recruitment estimates</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#   - Add argument `Fmax`, defining a reasonable upper bound for Annual F</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co"># --------------------------------------------------------------------------------</span></span>
<span id="cb15-14"><a href="#cb15-14"></a></span>
<span id="cb15-15"><a href="#cb15-15"></a>KrillProjection <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb15-16"><a href="#cb15-16"></a>        nsteps, Ages, <span class="co">#time step numbers and age classes</span></span>
<span id="cb15-17"><a href="#cb15-17"></a>        spawnI,monitorI,fishingI, <span class="co">#Interval sequences</span></span>
<span id="cb15-18"><a href="#cb15-18"></a>        t0,K,Linf,f0,f1, <span class="co">#Growth details</span></span>
<span id="cb15-19"><a href="#cb15-19"></a>        a, b, <span class="co">#Length/Weight Details</span></span>
<span id="cb15-20"><a href="#cb15-20"></a>        sel50Min,	sel50Max,	selrange, <span class="co">#Selectivity Parameters</span></span>
<span id="cb15-21"><a href="#cb15-21"></a>        mat50Min,	mat50Max,	matrange, <span class="co">#Maturity parameters</span></span>
<span id="cb15-22"><a href="#cb15-22"></a>        B0logsd, <span class="co">#biomass log cv</span></span>
<span id="cb15-23"><a href="#cb15-23"></a>        prRecruitPars,prRecruit, <span class="co">#recruitment parameters and quantile function</span></span>
<span id="cb15-24"><a href="#cb15-24"></a>        <span class="at">gamma=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.04</span>,<span class="fl">0.08</span>,<span class="fl">0.1</span>),</span>
<span id="cb15-25"><a href="#cb15-25"></a>        <span class="at">n.years=</span><span class="dv">20</span>, <span class="co">#Test details</span></span>
<span id="cb15-26"><a href="#cb15-26"></a>        ms, <span class="co"># matrix with intra-annual natural mortality patterns for each age class (dimesions: nr time intervals x nr age-classes)</span></span>
<span id="cb15-27"><a href="#cb15-27"></a>        Fmax</span>
<span id="cb15-28"><a href="#cb15-28"></a>        ) {</span>
<span id="cb15-29"><a href="#cb15-29"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">inherits</span>(prRecruitPars, <span class="st">"matrix"</span>)) prRecruitPars <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(prRecruitPars)</span>
<span id="cb15-30"><a href="#cb15-30"></a>  <span class="co"># Create a sequence from 0-1 for each time step. The value is the proportion of that timestep in the year.</span></span>
<span id="cb15-31"><a href="#cb15-31"></a>  Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb15-32"><a href="#cb15-32"></a>  <span class="co">#The proportion of an individual time step in the year (0.002739726 for daily timesteps)</span></span>
<span id="cb15-33"><a href="#cb15-33"></a>  h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span>
<span id="cb15-34"><a href="#cb15-34"></a></span>
<span id="cb15-35"><a href="#cb15-35"></a>  <span class="do">## Spawning and monitoring interval are defined as inputs into the function.</span></span>
<span id="cb15-36"><a href="#cb15-36"></a>  <span class="do">## Should be as timesteps eg 76:138</span></span>
<span id="cb15-37"><a href="#cb15-37"></a></span>
<span id="cb15-38"><a href="#cb15-38"></a>  <span class="do">## Ages, length at age and weight at age</span></span>
<span id="cb15-39"><a href="#cb15-39"></a>  ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(Days,Ages,<span class="at">FUN=</span><span class="st">"+"</span>)<span class="co">#Ages of each age class for every timestep</span></span>
<span id="cb15-40"><a href="#cb15-40"></a>  ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyRAL</span>(ages,<span class="at">t0=</span>t0,<span class="at">K=</span>K,<span class="at">Linf=</span>Linf,<span class="at">f0=</span>f0,<span class="at">f1=</span>f1)<span class="co">#length of each age class for every timestep</span></span>
<span id="cb15-41"><a href="#cb15-41"></a>  ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(ls,<span class="at">a=</span>a,<span class="at">b=</span>b)<span class="co">#weight of each age class for every timestep</span></span>
<span id="cb15-42"><a href="#cb15-42"></a></span>
<span id="cb15-43"><a href="#cb15-43"></a>  <span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb15-44"><a href="#cb15-44"></a>  <span class="co">#  ms &lt;- matrix(1,nsteps+1,length(Ages))#Proportion of mortality to apply for each timestep to each age class (if constant should all be one)</span></span>
<span id="cb15-45"><a href="#cb15-45"></a>  Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(ms,h)<span class="co"># Cumulative timestep proportional mortality</span></span>
<span id="cb15-46"><a href="#cb15-46"></a>  Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(Ms)<span class="co">#Sum of mortality for each age class (if constant across ages, should all be one.)</span></span>
<span id="cb15-47"><a href="#cb15-47"></a></span>
<span id="cb15-48"><a href="#cb15-48"></a>  <span class="do">## Within year fishing pattern - season is first 90 days</span></span>
<span id="cb15-49"><a href="#cb15-49"></a>  fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(nsteps<span class="sc">+</span><span class="dv">1</span>) <span class="co">#Sequence of 0s for the length of the year</span></span>
<span id="cb15-50"><a href="#cb15-50"></a>  fwy[fishingI] <span class="ot">&lt;-</span> <span class="dv">1</span>		<span class="co">#Set the fishing season increments to 1.</span></span>
<span id="cb15-51"><a href="#cb15-51"></a>  fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">mean</span>(fwy)  <span class="co">#Average the fishing mortality so the average is 1 across all increments.</span></span>
<span id="cb15-52"><a href="#cb15-52"></a></span>
<span id="cb15-53"><a href="#cb15-53"></a>  <span class="co">#B0logsd &lt;- 0.2</span></span>
<span id="cb15-54"><a href="#cb15-54"></a></span>
<span id="cb15-55"><a href="#cb15-55"></a>  <span class="do">## This function performs the a projection for each prescibed gamma.</span></span>
<span id="cb15-56"><a href="#cb15-56"></a>  <span class="cf">function</span>(run) {</span>
<span id="cb15-57"><a href="#cb15-57"></a>    <span class="do">## Length based maturity and selectivity - ramp width is constant</span></span>
<span id="cb15-58"><a href="#cb15-58"></a>    <span class="do">## but the midpoint is selected uniformly from a range.</span></span>
<span id="cb15-59"><a href="#cb15-59"></a>    gs <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(ls,<span class="fu">runif</span>(<span class="dv">1</span>,mat50Min,mat50Max),matrange) <span class="co">#Maturity ogive</span></span>
<span id="cb15-60"><a href="#cb15-60"></a>    ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(ls,<span class="fu">runif</span>(<span class="dv">1</span>,sel50Min,sel50Max),selrange)  <span class="co">#Selectivity ogive</span></span>
<span id="cb15-61"><a href="#cb15-61"></a></span>
<span id="cb15-62"><a href="#cb15-62"></a>    <span class="do">## Construct fishing mortalities from season and selectivity</span></span>
<span id="cb15-63"><a href="#cb15-63"></a>    fs <span class="ot">&lt;-</span> fwy<span class="sc">*</span>ss <span class="co">#Age + time step fishing mortality</span></span>
<span id="cb15-64"><a href="#cb15-64"></a>    Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(fs,h) <span class="co">#Cumulative #Age + time step fishing mortality</span></span>
<span id="cb15-65"><a href="#cb15-65"></a>    Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(Fs) <span class="co">#Final yearly fishing mortality for each age class.</span></span>
<span id="cb15-66"><a href="#cb15-66"></a></span>
<span id="cb15-67"><a href="#cb15-67"></a>    <span class="do">## Extract recruitment parameters for this run</span></span>
<span id="cb15-68"><a href="#cb15-68"></a>    ps <span class="ot">&lt;-</span> <span class="fu">unname</span>(prRecruitPars[run,])</span>
<span id="cb15-69"><a href="#cb15-69"></a></span>
<span id="cb15-70"><a href="#cb15-70"></a>    <span class="do">## Natural mortalities from proprtional recruitment model</span></span>
<span id="cb15-71"><a href="#cb15-71"></a>    M <span class="ot">&lt;-</span> ps[<span class="dv">1</span>] <span class="co">#Yearly M from bootstrapped recruitment</span></span>
<span id="cb15-72"><a href="#cb15-72"></a>    MMs <span class="ot">&lt;-</span> M<span class="sc">*</span>Ms <span class="co">#Timestep cumulative mortality for each age class.</span></span>
<span id="cb15-73"><a href="#cb15-73"></a></span>
<span id="cb15-74"><a href="#cb15-74"></a>    <span class="do">## Median spawning biomass estimated from 1000 samples</span></span>
<span id="cb15-75"><a href="#cb15-75"></a>    R <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">prRecruit</span>(<span class="dv">1000</span><span class="sc">*</span><span class="fu">length</span>(Msf),ps[<span class="dv">3</span>],ps[<span class="dv">4</span>]),<span class="dv">1000</span>,<span class="fu">length</span>(Msf))</span>
<span id="cb15-76"><a href="#cb15-76"></a>    ssb0 <span class="ot">&lt;-</span> <span class="fu">spawningB0S</span>(R,gs,ws,Ms,M,<span class="at">spawn=</span>spawnI)<span class="sc">$</span>median</span>
<span id="cb15-77"><a href="#cb15-77"></a>    <span class="do">## Stochastic initial age structure in the absence of fishing</span></span>
<span id="cb15-78"><a href="#cb15-78"></a>    N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="fu">prRecruit</span>(<span class="fu">length</span>(Msf),ps[<span class="dv">3</span>],ps[<span class="dv">4</span>]),Msf,M)</span>
<span id="cb15-79"><a href="#cb15-79"></a>    <span class="do">## Recruitment series</span></span>
<span id="cb15-80"><a href="#cb15-80"></a>    Rs <span class="ot">&lt;-</span> <span class="fu">prRecruit</span>(n.years,ps[<span class="dv">3</span>],ps[<span class="dv">4</span>])</span>
<span id="cb15-81"><a href="#cb15-81"></a>    <span class="do">## Matrix of annual summaries</span></span>
<span id="cb15-82"><a href="#cb15-82"></a>    n <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">+</span>n.years)<span class="sc">*</span><span class="fu">length</span>(gamma)</span>
<span id="cb15-83"><a href="#cb15-83"></a>    df <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="dv">11</span>)</span>
<span id="cb15-84"><a href="#cb15-84"></a>    <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>,<span class="st">"Gamma"</span>,<span class="st">"R"</span>,<span class="st">"N"</span>,<span class="st">"B"</span>,<span class="st">"B0"</span>,<span class="st">"SSN"</span>,<span class="st">"SSB"</span>,<span class="st">"SSB0"</span>,<span class="st">"Catch"</span>,<span class="st">"F"</span>)</span>
<span id="cb15-85"><a href="#cb15-85"></a>    <span class="do">## Initial projection assuming no fishing</span></span>
<span id="cb15-86"><a href="#cb15-86"></a>    pr0 <span class="ot">&lt;-</span> <span class="fu">project</span>(ws,MMs,<span class="at">Nref=</span>N0,<span class="at">yield=</span><span class="dv">0</span>)</span>
<span id="cb15-87"><a href="#cb15-87"></a>    pr0<span class="sc">$</span>F <span class="ot">&lt;-</span> pr0<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-88"><a href="#cb15-88"></a>    <span class="do">## Initial biomass in monitoring period + log Normal error</span></span>
<span id="cb15-89"><a href="#cb15-89"></a>    b0 <span class="ot">&lt;-</span> <span class="fu">meanStock</span>(pr0<span class="sc">$</span>B,<span class="at">period=</span>monitorI)</span>
<span id="cb15-90"><a href="#cb15-90"></a>    b0 <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">1</span>,<span class="fu">log</span>(b0)<span class="sc">-</span>B0logsd<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>,B0logsd)</span>
<span id="cb15-91"><a href="#cb15-91"></a></span>
<span id="cb15-92"><a href="#cb15-92"></a>    k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-93"><a href="#cb15-93"></a>    <span class="do">## Project for each gamma ratio</span></span>
<span id="cb15-94"><a href="#cb15-94"></a>    <span class="cf">for</span>(g <span class="cf">in</span> gamma) {</span>
<span id="cb15-95"><a href="#cb15-95"></a>      <span class="do">## Target catch</span></span>
<span id="cb15-96"><a href="#cb15-96"></a>      catch <span class="ot">&lt;-</span> g<span class="sc">*</span>b0</span>
<span id="cb15-97"><a href="#cb15-97"></a>      <span class="do">## Reset to virgin state</span></span>
<span id="cb15-98"><a href="#cb15-98"></a>      pr <span class="ot">&lt;-</span> pr0</span>
<span id="cb15-99"><a href="#cb15-99"></a>      ssb <span class="ot">&lt;-</span> <span class="fu">spawningStock</span>(pr<span class="sc">$</span>B,gs,spawnI)</span>
<span id="cb15-100"><a href="#cb15-100"></a></span>
<span id="cb15-101"><a href="#cb15-101"></a>      <span class="cf">for</span>(yr <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>n.years) {</span>
<span id="cb15-102"><a href="#cb15-102"></a>        <span class="cf">if</span>(yr <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-103"><a href="#cb15-103"></a>          <span class="do">## Recruitment depletion</span></span>
<span id="cb15-104"><a href="#cb15-104"></a>          r <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>,ssb<span class="sc">/</span>(<span class="fl">0.2</span><span class="sc">*</span>ssb0))</span>
<span id="cb15-105"><a href="#cb15-105"></a>          <span class="do">## Project over year</span></span>
<span id="cb15-106"><a href="#cb15-106"></a>          N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(pr<span class="sc">$</span>N,r<span class="sc">*</span>Rs[yr])</span>
<span id="cb15-107"><a href="#cb15-107"></a>          pr <span class="ot">&lt;-</span> <span class="fu">projectC</span>(ws,MMs,Fs,fs,catch,<span class="at">Nref=</span>N0,<span class="at">yield=</span><span class="dv">1</span>,<span class="at">Fmax=</span>Fmax)</span>
<span id="cb15-108"><a href="#cb15-108"></a>          <span class="co">#if(pr$F==1.5) return(NULL)</span></span>
<span id="cb15-109"><a href="#cb15-109"></a>        }</span>
<span id="cb15-110"><a href="#cb15-110"></a>        ssb <span class="ot">&lt;-</span> <span class="fu">spawningStock</span>(pr<span class="sc">$</span>B,gs,spawnI)</span>
<span id="cb15-111"><a href="#cb15-111"></a></span>
<span id="cb15-112"><a href="#cb15-112"></a>        <span class="do">## Collate annual summaries</span></span>
<span id="cb15-113"><a href="#cb15-113"></a>        df[k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(yr,g,<span class="fu">initial</span>(pr<span class="sc">$</span>N)[<span class="dv">1</span>],<span class="fu">sum</span>(<span class="fu">initial</span>(pr<span class="sc">$</span>N)),<span class="fu">sum</span>(<span class="fu">initial</span>(pr<span class="sc">$</span>B)),b0,</span>
<span id="cb15-114"><a href="#cb15-114"></a>                         <span class="fu">spawningStock</span>(pr<span class="sc">$</span>N,gs,spawnI),ssb,ssb0,<span class="fu">sum</span>(pr<span class="sc">$</span>Y),pr<span class="sc">$</span>F)</span>
<span id="cb15-115"><a href="#cb15-115"></a>      }</span>
<span id="cb15-116"><a href="#cb15-116"></a>    }</span>
<span id="cb15-117"><a href="#cb15-117"></a>    <span class="fu">data.frame</span>(<span class="at">Run=</span>run,<span class="at">M=</span>M,df)</span>
<span id="cb15-118"><a href="#cb15-118"></a>  }</span>
<span id="cb15-119"><a href="#cb15-119"></a>}</span>
<span id="cb15-120"><a href="#cb15-120"></a></span>
<span id="cb15-121"><a href="#cb15-121"></a></span>
<span id="cb15-122"><a href="#cb15-122"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-ccamlr22" class="csl-entry" role="doc-biblioentry">
CCAMLR. 2022. <span>“CCAMLR’s Approach to Managing the Krill Fishery. Euphausia Superba in Area 48.”</span> <a href="https://fishdocs.ccamlr.org/SAreport_48_KRI_2021.pdf">https://fishdocs.ccamlr.org/SAreport_48_KRI_2021.pdf</a>.
</div>
<div id="ref-constable_delamare96" class="csl-entry" role="doc-biblioentry">
Constable, A, and W. de la Mare. 1996. <span>“A Generalised Model for Evaluating Yield and the Long-Term Status of Fish Stocks Under Conditions of Uncertainty.”</span> <em>CCAMLR Science</em> 3: 31–54.
</div>
<div id="ref-constable_etal00" class="csl-entry" role="doc-biblioentry">
Constable, A, William de la Mare, David Agnew, Inigo Everson, and Denzil Miller. 2000. <span>“Managing Fisheries to Conserve the Antarctic Marine Ecosystem: Practical Implementation of the Convention on the Conservation of Antarctic Marine Living Resources (CCAMLR).”</span> <em>ICES Journal of Marine Science</em> 57 (3): 778–91. <a href="https://doi.org/10.1006/jmsc.2000.0725">https://doi.org/10.1006/jmsc.2000.0725</a>.
</div>
<div id="ref-kawaguchi16" class="csl-entry" role="doc-biblioentry">
Kawaguchi, So. 2016. <span>“Reproduction and Larval Development in Antarctic Krill (Euphausia Superba).”</span> In <em>Biology and Ecology of Antarctic Krill</em>, edited by Volker Siegel, 225–46. Advances in Polar Ecology. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-29279-3_6">https://doi.org/10.1007/978-3-319-29279-3_6</a>.
</div>
<div id="ref-kinzey21" class="csl-entry" role="doc-biblioentry">
Kinzey, D. 2021. <span>“Summary of Proportional Recruitment and Multiyear Biomass Variability for Krill in Subarea 48 from Research Surveys.”</span> WG-SAM-2021/21 Rev1. CCAMLR.
</div>
<div id="ref-maschette_wotherspoon21" class="csl-entry" role="doc-biblioentry">
Maschette, D., and S. Wotherspoon. 2021. <span>“Use of Parameters Within Euphausia Superba Grym Simulations.”</span> WG-FSA-2021/40. CCAMLR.
</div>
<div id="ref-maschette_etal20" class="csl-entry" role="doc-biblioentry">
Maschette, D., S. Wotherspoon, C. Pavez, P. Ziegler, S. Thanassekos, K Reid, D Kawagushi, D Welsford, and A Constable. 2020. <span>“Generalised R Yield Model (Grym).”</span> Scientific Committee SC-CAMLR-39/BG/19. CCAMLR.
</div>
<div id="ref-maschette_etal21" class="csl-entry" role="doc-biblioentry">
Maschette, D, S Wotherspoon, S Kawaguchi, and Philippe Ziegler. 2021. <span>“Grym Assessment for Subarea 48.1 Euphausia Superba Populations.”</span> WG-FSA-2021/39. Hobart, Autralia: CCAMLR. <a href="https://meetings.ccamlr.org/en/wg-fsa-2021/39">https://meetings.ccamlr.org/en/wg-fsa-2021/39</a>.
</div>
<div id="ref-sc-camlr00" class="csl-entry" role="doc-biblioentry">
SC-CAMLR. 2000. <span>“Report of the Bo Workshop.”</span> SC-CAMLR-XIX. Annex 4, Appendix G. CCAMLR.
</div>
<div id="ref-thanassekos_etal21" class="csl-entry" role="doc-biblioentry">
Thanassekos, S, K Reid, S Kawaguchi, S Wotherspoon, D Maschette, P Ziegler, D Welsford, et al. 2021. <span>“Grym Parameter Values for Subareas 48.1, 48.2 and 48.3.”</span> WG-SAM-2021/12. CCAMLR.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This definition deviates from the original one by <span class="citation" data-cites="constable_etal00">Constable et al. (<a href="../../references.html#ref-constable_etal00" role="doc-biblioref">2000</a>)</span> and <span class="citation" data-cites="ccamlr22">CCAMLR (<a href="../../references.html#ref-ccamlr22" role="doc-biblioref">2022</a>)</span>, which specifies <span class="math inline">\(\gamma_1\)</span> as:</p>
<p><em>(…) the probability of the spawning biomass dropping below 20% of its median pre-exploitation level over a 20-year harvesting period is 10%.</em></p>
<p>However, the term “median pre-exploitation level” can be misleading since it refers to an estimate of <span class="math inline">\(SSB_0\)</span> - obtained by taking the median of <span class="math inline">\(SSB_0\)</span> from multiple starting populations generated within a given simulation - and <strong>not</strong> the median of <span class="math inline">\(SSB_0\)</span> estimates across all simulations. Therefore we decided to drop the term “median” to avoid confusion with its use in the definition of <span class="math inline">\(\gamma_2\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In this case, ‘median’ refers to the median of the distribution of <span class="math inline">\(SSB_0\)</span> estimates.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Calculated as the proportion of simulations where the minimum value of yearly <span class="math inline">\(SSS\)</span> over the projection period is less than the 0.2 threshold.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Calculated as the ratio between the medians of simulated <span class="math inline">\(SSB_Y\)</span> and <span class="math inline">\(SSB_0\)</span> values.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../part1_openMSE_GRYM_approx/1_RecCV_and_M/generate_RCV_and_M.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Recruitment Variability and Natural Mortality</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../part1_openMSE_GRYM_approx/3_openMSE_sims/openmse_sims.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">openMSE-Grym Approximation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>