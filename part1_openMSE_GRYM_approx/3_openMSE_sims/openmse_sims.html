<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applying the Management Strategy Evaluation tool {openMSE} to the Antarctic Krill fishery case - 3&nbsp; openMSE-Grym Approximation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../part1_openMSE_GRYM_approx/5_appendices/krill_om_report_example.html" rel="next">
<link href="../../part1_openMSE_GRYM_approx/2_GRYM_sims/grym_sims.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

<link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">openMSE-Grym Approximation</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Applying the Management Strategy Evaluation tool <code>{openMSE}</code> to the Antarctic Krill fishery case</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../part1_openMSE_GRYM_approx/part1.html" class="sidebar-item-text sidebar-link">Approximating openMSE to Grym</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part1_openMSE_GRYM_approx/1_RecCV_and_M/generate_RCV_and_M.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Recruitment Variability and Natural Mortality</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part1_openMSE_GRYM_approx/2_GRYM_sims/grym_sims.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">GYM/Grym Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part1_openMSE_GRYM_approx/3_openMSE_sims/openmse_sims.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">openMSE-Grym Approximation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part1_openMSE_GRYM_approx/5_appendices/krill_om_report_example.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Appendix: OM Report (<em>scn-1</em>)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">MSE Application</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part2_openMSE_application/mse_application.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Krill MSE Application</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../part2_openMSE_application/krill_base_om_report.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Appendix: Krill base-case Operating Model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">3.1</span>  Introduction</a></li>
  <li><a href="#sec-openmse-inherent-diffs" id="toc-sec-openmse-inherent-diffs" class="nav-link" data-scroll-target="#sec-openmse-inherent-diffs"><span class="toc-section-number">3.2</span>  Inherent differences between openMSE and Grym</a>
  <ul class="collapse">
  <li><a href="#temporal-resolution" id="toc-temporal-resolution" class="nav-link" data-scroll-target="#temporal-resolution"><span class="toc-section-number">3.2.1</span>  Temporal Resolution</a></li>
  <li><a href="#sec-openmse-diffs-sr" id="toc-sec-openmse-diffs-sr" class="nav-link" data-scroll-target="#sec-openmse-diffs-sr"><span class="toc-section-number">3.2.2</span>  Stock-Recruitment Relationship</a></li>
  <li><a href="#historical-period" id="toc-historical-period" class="nav-link" data-scroll-target="#historical-period"><span class="toc-section-number">3.2.3</span>  Historical Period</a></li>
  <li><a href="#unfished-reference-points-calculation" id="toc-unfished-reference-points-calculation" class="nav-link" data-scroll-target="#unfished-reference-points-calculation"><span class="toc-section-number">3.2.4</span>  Unfished Reference Points Calculation</a></li>
  </ul></li>
  <li><a href="#configuring-openmse" id="toc-configuring-openmse" class="nav-link" data-scroll-target="#configuring-openmse"><span class="toc-section-number">3.3</span>  Configuring openMSE</a>
  <ul class="collapse">
  <li><a href="#build-oms-for-input-scenarios" id="toc-build-oms-for-input-scenarios" class="nav-link" data-scroll-target="#build-oms-for-input-scenarios"><span class="toc-section-number">3.3.1</span>  Build OMs for input scenarios</a></li>
  <li><a href="#define-management-plans" id="toc-define-management-plans" class="nav-link" data-scroll-target="#define-management-plans"><span class="toc-section-number">3.3.2</span>  Define Management Plans</a></li>
  <li><a href="#set-performance-metrics" id="toc-set-performance-metrics" class="nav-link" data-scroll-target="#set-performance-metrics"><span class="toc-section-number">3.3.3</span>  Set Performance Metrics</a></li>
  </ul></li>
  <li><a href="#run-mse-simulations" id="toc-run-mse-simulations" class="nav-link" data-scroll-target="#run-mse-simulations"><span class="toc-section-number">3.4</span>  Run MSE Simulations</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="toc-section-number">3.5</span>  Results</a>
  <ul class="collapse">
  <li><a href="#spawning-stock-trajectories" id="toc-spawning-stock-trajectories" class="nav-link" data-scroll-target="#spawning-stock-trajectories"><span class="toc-section-number">3.5.1</span>  Spawning stock trajectories</a></li>
  <li><a href="#depletion-probability-and-escapement-levels-versus-gamma-values" id="toc-depletion-probability-and-escapement-levels-versus-gamma-values" class="nav-link" data-scroll-target="#depletion-probability-and-escapement-levels-versus-gamma-values"><span class="toc-section-number">3.5.2</span>  Depletion probability and Escapement levels versus <span class="math inline">\(\gamma\)</span> values</a></li>
  <li><a href="#estimated-gamma_p-under-each-input-scenario" id="toc-estimated-gamma_p-under-each-input-scenario" class="nav-link" data-scroll-target="#estimated-gamma_p-under-each-input-scenario"><span class="toc-section-number">3.5.3</span>  Estimated <span class="math inline">\(\gamma_p\)</span> under each input scenario</a></li>
  <li><a href="#comparison-between-grym-and-openmse-results" id="toc-comparison-between-grym-and-openmse-results" class="nav-link" data-scroll-target="#comparison-between-grym-and-openmse-results"><span class="toc-section-number">3.5.4</span>  Comparison between Grym and openMSE results</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="toc-section-number">3.6</span>  Discussion</a></li>
  <li><a href="#supplementary-code" id="toc-supplementary-code" class="nav-link" data-scroll-target="#supplementary-code"><span class="toc-section-number">3.7</span>  Supplementary Code</a>
  <ul class="collapse">
  <li><a href="#sec-openmse-om-builder" id="toc-sec-openmse-om-builder" class="nav-link" data-scroll-target="#sec-openmse-om-builder"><span class="toc-section-number">3.7.1</span>  Operating Model builder function</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-openmse-sims" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">openMSE-Grym Approximation</span></span></h1>
<p class="subtitle lead">Reproducing the Grym’s base case for the krill fishery using the openMSE framework</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="introduction" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">3.1</span> Introduction</h2>
<p>In this section, we aim to configure and run the models under the {<code>openMSE</code>} package <span class="citation" data-cites="hordyk_etal21">(<a href="../../references.html#ref-hordyk_etal21" role="doc-biblioref">Hordyk, Huynh, and Carruthers 2021</a>)</span> to approximate Grym’s base-case implementation for the assessment and management of the Antarctic Krill fishery. Our primary objective for this analysis is to determine whether the openMSE framework can generate estimates of precautionary harvest rates (<span class="math inline">\(\gamma_p\)</span>) similar to those obtained under the Grym framework, for a range of alternative scenarios involving key stock parameters, as described in <a href="../2_GRYM_sims/grym_sims.html"><span>Chapter&nbsp;2</span></a>. The ability to achieve comparable results will establish the suitability of the openMSE framework to model the population dynamics of the Krill stock, and subsequently, its applicability to evaluate prospective alternative management options for the fishery.</p>
<p>In its essence, like the Grym approach, the openMSE framework is based on an stochastic age-structured population model that simulates fishery dynamics while taking into account uncertainties about stock parameters and system dynamics. This enables the identification of potential management strategies that are robust to a range credible scenarios of the fishery system. Details about the openMSE’s components and features are available on its <a href="https://openmse.com/">documentation site</a>.</p>
<p>However, there are fundamental structural differences between the Grym and the openMSE frameworks that may affect the success of the approximation. In the following subsection we describe the main discrepancies between the two approaches in detail.</p>
</section>
<section id="sec-openmse-inherent-diffs" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-openmse-inherent-diffs"><span class="header-section-number">3.2</span> Inherent differences between openMSE and Grym</h2>
<p>Here we list relevant built-in differences between the Grym’s base-case implementation and the openMSE framework in terms of population model structure.</p>
<section id="temporal-resolution" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="temporal-resolution"><span class="header-section-number">3.2.1</span> Temporal Resolution</h3>
<p>The openMSE’s population model describes a fished stock and its dynamics at yearly time-steps, whereas Grym represents populations at daily time-steps.</p>
<p>Grym’s daily-based structure allows to model stock characteristics at a day-level resolution, which permits the specification of whithin-year patterns in e.g.&nbsp;growth, spawning, natural and fishing mortality. It also provides the flexibility to evaluate population parameters and reference points at specific periods of the year (e.g.&nbsp;during the spawning season or fishing period).</p>
<p>On the other hand, the openMSE framework is constrained to yearly-level computations and hence it is unable to account for within-year features nor to derive the stock status at particular fractions of the year - reported annual stock quantities are strictly related to the stock status at start of each year.</p>
<p>A concrete example of deviations between the two approaches related to temporal resolution is the calculation of key biomass quantities. In the Grym base-case, yearly <span class="math inline">\(SSB_y\)</span> and <span class="math inline">\(SSB_0\)</span> are computed relative to the spawning period, and <span class="math inline">\(B_0\)</span> is computed for a specific monitoring period. By comparison, under the openMSE dynamics model, these quantities are purely related to the first day of the year.</p>
</section>
<section id="sec-openmse-diffs-sr" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="sec-openmse-diffs-sr"><span class="header-section-number">3.2.2</span> Stock-Recruitment Relationship</h3>
<p>In contrast with the Grym approach, the openMSE framework uses a conventional stock-recruitment model to compute the expected number of recruits given the spawning stock size.</p>
<p>As described in <a href="../2_GRYM_sims/grym_sims.html#sec-grym-framework"><span>Section&nbsp;2.1.1</span></a>, the simulation of recruitment in Grym is assumed to be independent of the stock size, except when the stock falls below a critical depletion point (20% of <span class="math inline">\(SSB_0\)</span>) in the preceding year. In this scenario, the simulated recruitment is penalized by a reduction factor calculated as the percentage drop from the critical point.</p>
<p>Under the openMSE approach, yearly recruitments are generated as random deviates from a mean recruitment that is dictated by a standard stock-recruitment relationship (the Beverton-Holt or the Ricker curves), which specifies the expected number of recruits at any given stock size. However, unlike Grym, openMSE does not offer the option to penalize recruitment deviates based in depletion levels.</p>
<p>As a result, when the stock falls below critical depletion levels, the strength of simulated recruitment in the two frameworks will tend to diverge, especially under high levels of recruitment variability.</p>
</section>
<section id="historical-period" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="historical-period"><span class="header-section-number">3.2.3</span> Historical Period</h3>
<p>The openMSE tool takes into account for the historical period of the fishery leading up to a current state, before projecting the population forward under potential future management strategies under evaluation. In the Grym base-case implementation, stock projections start from a pre-exploitation state without considering information on historical trends or current status of the fishery.</p>
<p>An obvious way to align the two approaches would be to skip the historical period in the openMSE simulation. However, for the current version of the openMSE, and in particular its <code>{MSEtool}</code> package (v<code>r packageVersion("MSEtool")</code>), a minimum historical period of 5 years is required. Local changes to the <code>{MSEtool}</code> codebase allowed the reduction of the minimum required historical period to 2 years.</p>
<p>Therefore, even when an historical period with no fishing mortality is specified, the openMSE simulations will still have an additional 2-year lead-up period subject to stochasticity, which is not present in the Grym implementation.</p>
</section>
<section id="unfished-reference-points-calculation" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="unfished-reference-points-calculation"><span class="header-section-number">3.2.4</span> Unfished Reference Points Calculation</h3>
<p>The Grym approach includes recruitment deviations in the calculation of unfished/pre-exploitation reference points, such as <span class="math inline">\(SSB_0\)</span> and <span class="math inline">\(B_0\)</span>. The openMSE approach provides similar estimates, referred to as “dynamic unfished reference points”. Under both approaches, these quantities are used to evaluate the status of the stock at different time points of the projection period for each of the management strategies under consideration.</p>
<p>However, there is a key divergence between approaches regarding the estimation of <span class="math inline">\(SSB_0\)</span>. In the Grym approach, <span class="math inline">\(SSB_0\)</span> is estimated stochastically within each simulation by taking the median of multiple realizations of <span class="math inline">\(SSB_0\)</span> from repeated samples of initial age structures. In contrast, the openMSE approach computes <span class="math inline">\(SSB_0\)</span> based on one single random sample of initial age structure generated at each given simulation. Consequently, estimates of <span class="math inline">\(SSB_0\)</span> under the Grym approach will tend to be more stable (i.e., have a lower variance) across simulations than those calculated in the openMSE approach. This difference could be especially pronounced in situations of high variability in stock parameters, such as natural mortality and recruitment.</p>
</section>
</section>
<section id="configuring-openmse" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="configuring-openmse"><span class="header-section-number">3.3</span> Configuring openMSE</h2>
<p>Here we describe how the openMSE components are configured to approximate the estimation of precautionary harvest rates for the krill fishery as it is performed under the Grym base-case implementation<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>The openMSE framework requires the specification of 3 main components to run a Management Strategy Evaluation (MSE):</p>
<ol type="1">
<li><p><strong>Operating Model</strong> (<a href="https://openmse.com/object-operating-model/" target="_blank">OM</a>): containing parameters specifying the characteristics of the population and fishery dynamics, as well as parameters required to simulate the collection of data and the implementation of management procedures.</p></li>
<li><p><strong>Management Procedure(s)</strong> (<a href="https://openmse.com/features-management-procedures/" target="_blank">MP</a>): A MP defines a set of rules specifying how the fishery will be managed during the projection period (e.g.&nbsp;setting a fixed annual total allowable catch, TAC).</p></li>
<li><p><strong>Performance Metric(s)</strong> (<a href="https://openmse.com/features-calculating-performance/" target="_blank">PM</a>): A PM summarises the MSE outputs in order to evaluate the performance of the considered MPs against the management objectives specified for the fisheries, as e.g.&nbsp;the expected level of depletion over the projection period associated with a given MP.</p></li>
</ol>
<p>We start off by building OMs for the 8 inputs scenarios under consideration.</p>
<section id="build-oms-for-input-scenarios" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="build-oms-for-input-scenarios"><span class="header-section-number">3.3.1</span> Build OMs for input scenarios</h3>
<p>As described in <a href="../2_GRYM_sims/grym_sims.html#sec-grym-input_scens"><span>Section&nbsp;2.2.1</span></a>, input scenarios forming alternative parameter setups for modelling the Krill fishery were generated from combining 4 different PR scenarios with 2 alternative maturity ogive curves. In order to run MSE simulations for each of the considered scenarios, we need to build scenario-specific OMs.</p>
<p>Therefore, OM parameter values were selected to closely approximate the parameter setups used in the Grym analyses presented in <a href="../2_GRYM_sims/grym_sims.html"><span>Chapter&nbsp;2</span></a>. Specifically, for each scenario-specific OM, all OM parameters were held constant except for:</p>
<ul>
<li><p>Natural Mortality <strong>M</strong>, provided as random draws from the fitted PR model associated with the scenario (generated in <a href="../1_RecCV_and_M/generate_RCV_and_M.html"><span>Chapter&nbsp;1</span></a>);</p></li>
<li><p>Recruitment Process error <strong>Perr</strong>, derived from random draws of <span class="math inline">\(CV_R\)</span>, also from the fitted PR model;</p></li>
<li><p>maturity-at-length parameters <strong>L50</strong> and <strong>L50_95</strong> associated with the scenario</p></li>
</ul>
<p>The function <a href="#sec-openmse-om-builder"><code>build_OM_grym_approx()</code></a> was created to build OMs for the parameters values specified under each input scenario, as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>openmse_scen_OMs <span class="ot">&lt;-</span> grym_setups <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario_id<span class="sc">:</span>matrange, t0<span class="sc">:</span>Ages, prRecruitPars) <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">OM =</span> <span class="fu">list</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">build_OM_grym_approx</span>(</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">om_name =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"krill_grym_approx_{scenario_id}"</span>),  </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxage =</span> <span class="fu">last</span>(Ages), <span class="at">Linf =</span> Linf, <span class="at">K =</span> K, <span class="at">t0 =</span> t0, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">mat50Min =</span> mat50Min, <span class="at">mat50Max =</span> mat50Max, <span class="at">matrange =</span> matrange, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">sel50Min =</span> sel50Min, <span class="at">sel50Max =</span> sel50Max, <span class="at">selrange =</span> selrange, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">a =</span> a, <span class="at">b =</span> b, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">M_draws =</span> <span class="fu">pull</span>(prRecruitPars, M) , <span class="at">RCV_draws =</span> <span class="fu">pull</span>(prRecruitPars, CV),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxF =</span> Fmax, <span class="at">n_iter =</span> n_iter, <span class="at">proj_yrs =</span> n.years</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(OM)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(openmse_scen_OMs) <span class="ot">&lt;-</span> grym_setups<span class="sc">$</span>scenario_id</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(openmse_scen_OMs, <span class="st">"../part1_shared_files/inputs/openmse_scen_OMs.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>The openMSE framework includes a report generation tool that was used to document in detail the choice of OM parameter values for one of the input scenarios (<em>scn-1</em>), for reference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize OM report for scn-1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">OMinit</span>(<span class="at">name =</span> <span class="st">"OM_krill_grym_approx_scn-1"</span>, <span class="at">files =</span> <span class="st">"rmd"</span>, <span class="at">overwrite =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The documentation step is performed externally to this document. Once the OM is appropriately documented, we compile the report. The resultant document can be viewed in <a href="../5_appendices/krill_om_report_example.html"><span>Chapter&nbsp;4</span></a>.</p>
<div class="callout-important callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Due to a bug in <code>MSEtool::OMdoc()</code>, the number of years to project the population forward must be set to 50 years, otherwise the markdown rendering process fails. This issue is exclusive to the <code>OM_doc</code> function.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># changed version of the MSEtool::OMdoc() that solves issues with the inclusion</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of bibliographic references, provides better integration in another document</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># as an embedded html. Also adds option to change html theme</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"OMdoc_dmp.r"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Length of projection must be 50 years, otherwise compilation crashes due to</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># bug in OMdoc</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>OM_to_report <span class="ot">&lt;-</span> openmse_scen_OMs<span class="sc">$</span><span class="st">`</span><span class="at">scn-1</span><span class="st">`</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>OM_to_report<span class="sc">@</span>proyears <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">OMdoc_dmp</span>(</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">OM =</span> OM_to_report, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">openFile =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">rmd.source =</span> <span class="st">"OM_krill_grym_approx_scn-1.rmd"</span>, </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">bib_file =</span> <span class="st">"../../references.json"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">html_theme =</span> <span class="st">"lumen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Relevant choices to approximate the OMs specification to the Grym setups include:</p>
<ul>
<li>Set up the historical period to two years (minimum restricted by the basecode).</li>
<li>Stock assumed to remain unexploited during the historical period.</li>
<li>Define a range of high values (0.9 - 0.95) for the steepness of the Beverton-Holt stock-recruitment model in order to simulate yearly recruitments that are weakly dependent on stock size, unless when the stock is below 20% of its pre-exploitation size.</li>
<li>Life-history parameters defining individual growth (i.e.&nbsp;<strong>Linf</strong>, <strong>K</strong>, <strong>t0</strong>, <strong>a</strong> and <strong>b</strong>) assumed to be known without error.</li>
<li>Management procedures assumed to be perfectly implemented, i.e.&nbsp;annual catches never exceed nor fall short of the stipulated TACs.</li>
</ul>
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- #| code-fold: true -->
<!-- # Note: openMSE takes some time to run, so this code chunk must only be executed -->
<!-- # interactively, i.e. it shouldn't be evaluated during document rendering -->
<!-- # get one random draw of PR parameters  -->
<!-- PR_pars <- grym_setups |> -->
<!--   filter(scenario_id == "scn-1") |>  -->
<!--   select(prRecruitPars) |>  -->
<!--   unnest(prRecruitPars) |> -->
<!--   slice(1) -->
<!-- # --- Simulate recruitment series from Grym functions -->
<!-- grym_rec_simulator <- grym_setups |> -->
<!--   filter(scenario_id == "scn-1") |> -->
<!--   select(prRecruit) |> -->
<!--   pluck(1, 1) -->
<!-- R_grym <- tibble( -->
<!--   framework = "Grym",  -->
<!--   R = grym_rec_simulator(n = 25000, mn = PR_pars$mnQ, vr = PR_pars$vrQ) -->
<!-- ) -->
<!-- # --- Simulate recruitment series from openMSE -->
<!-- OM_test <- openmse_scen_OMs$`scn-1` -->
<!-- OM_test@nsim <- 5000 -->
<!-- # change steepness to 1 for equivalence between the two approaches. Grym applies -->
<!-- # depletion reduction at a later stage of the simulation -->
<!-- OM_test@h <- c(1,1) -->
<!-- # forcing perr to be constant across all simulations. Since OM specifies no -->
<!-- # inter-annual variability in recruitment, all draws of R are generated from the -->
<!-- # same value of perr, across simulations and years -->
<!-- OM_test@cpars$Perr <- rep(OM_test@cpars$Perr[1], OM_test@nsim) -->
<!-- OM_test@cpars$M <- rep(OM_test@cpars$M[1], OM_test@nsim) -->
<!-- OM_test@cpars$qs <- OM_test@cpars$qs[1:OM_test@nsim] -->
<!-- # Simulate fishery history -->
<!-- OM_test_hist <- Simulate(OM_test) -->
<!-- # Historic annual recruitment, by simulation (as used by markdown documentation) -->
<!-- R_mse <- apply(OM_test_hist@AtAge$Number[, 1, , ], 1:2, sum) -->
<!-- R_mse <- data.frame(framework = "openMSE", R = as.vector(R_mse)) -->
<!-- frw_sim_rec <- bind_rows(R_grym, R_mse)  -->
<!-- write_rds(frw_sim_rec, "frw_sim_rec.rds") -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- frw_sim_rec <- read_rds("frw_sim_rec.rds") -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| fig-align: center -->
<!-- #| fig-cap: Comparison between simulated recruitment under each modelling framework -->
<!-- #| label: fig-recr-coherence-fwrks -->
<!-- # --- Graphical comparison -->
<!-- p <- frw_sim_rec |> -->
<!--   ggplot(aes(x = framework, y = R)) + -->
<!--   stat_histinterval(slab_color = "gray70", slab_fill = "gray85", -->
<!--                     outline_bars = TRUE, breaks = 25, slab_linewidth = .7) + -->
<!--   labs(y = "Simulated Recruitment", x = "Framework") -->
<!-- p -->
<!-- ``` -->
</section>
<section id="define-management-plans" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="define-management-plans"><span class="header-section-number">3.3.2</span> Define Management Plans</h3>
<p>The openMSE framework define Management Plans (MPs) as programmatic functions establishing how the fishery could prospectively be managed, by running a set of calculations and criteria on fishery information and returning management recommendations.</p>
<p>In the context of the openMSE-Grym approximation, and Krill’s current management approach, we want to specify one MP for each of the considered harvest rates <span class="math inline">\(\gamma\)</span>. Thus, each MP establishes a constant harvest rate policy with a recommended fixed annual catch limit of <span class="math inline">\(\gamma \widehat{B_0}\)</span> throughout the projection period.</p>
<p>As explained in <a href="../2_GRYM_sims/grym_sims.html#sec-grym-framework"><span>Section&nbsp;2.1.1</span></a>, <span class="math inline">\(\widehat{B_0}\)</span> represents an estimate of pre-exploitation biomass which, similarly to the Grym approach, is simulated here as</p>
<p><span class="math display">\[\widehat{B_0} = B_0 \times \epsilon_{B_0}, \epsilon_{B_0} \sim \textrm{log-Normal}\left(-B0logSD^2/2, B0logSD^2 \right)\]</span></p>
<p>where the standard deviation <span class="math inline">\(B0logSD\)</span>, conveying the observational error in survey estimates of <span class="math inline">\(B_0\)</span>, is estimated externally from survey data <span class="citation" data-cites="kinzey21">(e.g. <a href="../../references.html#ref-kinzey21" role="doc-biblioref">Kinzey 2021</a>)</span>. The <span class="math inline">\(\gamma\)</span>-based MPs are set using the estimated dynamic unfished stock biomass (i.e.&nbsp;including recruitment process error) at the end of the historical period, serving as a proxy for the pre-exploitation biomass <span class="math inline">\(B_0\)</span>. This is to approximate the Grym implementation, which incorporates recruitment variability in the estimation of reference points.</p>
<p>Below are the custom functions we developed to generate the <span class="math inline">\(\gamma\)</span>-based MPs. These functions need to be defined as objects of class <code>MP</code> in order to be used with openMSE’s simulation functions.</p>
<div class="sourceCode" id="cb4" data-code-line-numbers="false"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom-made MP for krill based current CCAMLR management: constant TAC as a</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># proportion (gamma, i.e. the exploitation rate) of an estimate of</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pre-exploitation biomass (B0)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This is only an approximation to current krill management methods.</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Literature and Grym code point to the use of an estimate of mean B0 at a given</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># "monitoring period" - the time of the year in which surveys are typically done</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># to estimate B0. Population dynamics in DLMtool follow yearly time-steps, so</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># there is no obvious way to derive the B0 for a given time period within the</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># year</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># core function</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param gamma double, the harvest rate that, combined with B0, sets the TAC</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param B0err numeric vector of size `nsim`, random draws of errors in B0</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#'   estimates</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>gammaB0_ <span class="ot">&lt;-</span> <span class="cf">function</span>(x, Data, <span class="at">reps =</span> <span class="dv">1</span>, gamma, nyears, B0err){</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create a 'Rec' object</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  Rec <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">"Rec"</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the dynamic unfished biomass (i.e., including recruitment deviations) at</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the end of the spool-up/historical period (i.e. last year before first year</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of projection)</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  B0 <span class="ot">&lt;-</span> Data<span class="sc">@</span>Misc<span class="sc">$</span>ReferencePoints<span class="sc">$</span>Dynamic_Unfished<span class="sc">$</span>B0[x, nyears]</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replicating Grym's approach for setting the catch limit, based on a survey</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate of B0. So, first generate an estimate of B0, accounting for</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># observational error</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  B0_hat <span class="ot">&lt;-</span> B0 <span class="sc">*</span> B0err[x]</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Then compute the catch limit recommendation, and assign it to the TAC slot of</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 'Rec'</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  Rec<span class="sc">@</span>TAC <span class="ot">&lt;-</span> gamma <span class="sc">*</span> B0_hat</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return the 'Rec' object</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  Rec</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co">#' Function to build multiple gamma_B0-based MPs for a choice of gammas. Also</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co">#' passing the number of years in historical simulation and the SD of B0 survey</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="co">#' estimates.</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co">#' In MSEtool, each MP must be defined as a unique function, and must be of class "MP"</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="co">#' @inheritParams gammaB0_</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>build_gammaB0 <span class="ot">&lt;-</span> <span class="cf">function</span>(gammas, nyears, B0err){</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_chr</span>(gammas, <span class="cf">function</span>(x){</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># name of the function</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    fn_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"gammaB0_"</span>, x)</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># function re-definition for the gamma value</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    fn_def <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">partial</span>(gammaB0_, <span class="at">gamma =</span> <span class="sc">!!</span>x, <span class="at">nyears =</span> <span class="sc">!!</span>nyears, <span class="at">B0err =</span> <span class="sc">!!</span>B0err)</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># assign function to name</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(fn_name, fn_def, <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># assign class MP to function</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eval</span>(</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>      rlang<span class="sc">::</span><span class="fu">call2</span>(<span class="st">"&lt;-"</span>, </span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>                   rlang<span class="sc">::</span><span class="fu">expr</span>(<span class="fu">class</span>(<span class="sc">!!</span>rlang<span class="sc">::</span><span class="fu">sym</span>(fn_name))), <span class="st">"MP"</span>), </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">envir =</span> .GlobalEnv</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return function name for use in MSE run</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    fn_name</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="set-performance-metrics" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="set-performance-metrics"><span class="header-section-number">3.3.3</span> Set Performance Metrics</h3>
<p>Lastly, we must define Performance Metrics (PMs) to evaluate the <span class="math inline">\(\gamma\)</span>-based MPs under consideration. In the context of Krill management, and as seen in <a href="../2_GRYM_sims/grym_sims.html"><span>Chapter&nbsp;2</span></a>, there are two PMs of interest:</p>
<ul>
<li><p>the depletion probability, the probability of <span class="math inline">\(SSB\)</span> being below 20% of its pre-exploitation level <span class="math inline">\(SSB_0\)</span> at any year of a 20-year projection period)</p></li>
<li><p>Escapement level, the median of simulated <span class="math inline">\(SSB\)</span> estimates at the end of the projection period relative to the median of simulated <span class="math inline">\(SSB_0\)</span> estimates</p></li>
</ul>
<p>Following the same approach taken in the definition of MPs and in alignment with the Grym implementation, both PM calculations use the estimate of unfished spawning biomass at the end of the historical period as the pre-exploitation spawning biomass <span class="math inline">\(SSB_0\)</span>.</p>
<p>We create two functions, <code>PD()</code> and <code>ESC()</code>, of class <code>PM</code> to formalize these metrics for use within the openMSE package.</p>
<div class="sourceCode" id="cb5" data-code-line-numbers="false"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance metrics for krill based on current CCAMLR management (i.e.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the two  decision rules)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ------------------------- ##</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Depletion Probability   ##</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ------------------------- ##</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># *Depletion probability*: Probability of lowest spawning biomass over a 20-year</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># harvesting period dropping below 20% of its pre-exploitation level</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Following krill's Grym Workshop - the probability that the</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># minimum value of SSB over the projection period is less than 20% of SSB0,</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e. p[min(SSB)/SSB0 &lt; 0.2]</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">&lt;-</span> <span class="cf">function</span> (<span class="at">MSEobj =</span> <span class="cn">NULL</span>, <span class="at">Ref =</span> <span class="fl">0.2</span>, <span class="at">Yrs =</span> <span class="dv">20</span>){</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  Yrs <span class="ot">&lt;-</span> <span class="fu">ChkYrs</span>(Yrs, MSEobj)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  PMobj <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">"PMobj"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Name <span class="ot">&lt;-</span> <span class="st">"Depletion: Lowest Spawning Biomass relative to SSB0"</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Ref <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    PMobj<span class="sc">@</span>Caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Prob. min(SSB) &lt; "</span>, Ref, <span class="st">" SSB0 (Years "</span>, </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                            Yrs[<span class="dv">1</span>], <span class="st">" - "</span>, Yrs[<span class="dv">2</span>], <span class="st">")"</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    PMobj<span class="sc">@</span>Caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Prob. min(SSB) &lt; SSB0 (Years "</span>, Yrs[<span class="dv">1</span>], <span class="st">" - "</span>, </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                            Yrs[<span class="dv">2</span>], <span class="st">")"</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Ref <span class="ot">&lt;-</span> Ref</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get lowest SSB over the selected window of the projection period, for each</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulation and MP</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (MSEobj<span class="sc">@</span>nMPs <span class="sc">&gt;</span> <span class="dv">1</span>) mar <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="cf">else</span> mar <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  mar <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>mar</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  SSB_lowest <span class="ot">&lt;-</span> <span class="fu">apply</span>(MSEobj<span class="sc">@</span>SSB[ , ,  Yrs[<span class="dv">1</span>]<span class="sc">:</span>Yrs[<span class="dv">2</span>]], mar, min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># step required to conform with PMobj@Stat requirements</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(MSEobj<span class="sc">@</span>nMPs <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    SSB_lowest <span class="ot">&lt;-</span> <span class="fu">array</span>(SSB_lowest, <span class="at">dim =</span> <span class="fu">c</span>(MSEobj<span class="sc">@</span>nsim, <span class="dv">1</span>))</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using the unfished dynamics estimate of SB at the end of the historical</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># period as a proxy for pre-exploitation SB</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Stat <span class="ot">&lt;-</span> SSB_lowest<span class="sc">/</span>MSEobj<span class="sc">@</span>RefPoint<span class="sc">$</span>Dynamic_Unfished<span class="sc">$</span>SSB0[, MSEobj<span class="sc">@</span>nyears]</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Prob <span class="ot">&lt;-</span> PMobj<span class="sc">@</span>Stat <span class="sc">&lt;</span> PMobj<span class="sc">@</span>Ref</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Mean <span class="ot">&lt;-</span> <span class="fu">calcMean</span>(PMobj<span class="sc">@</span>Prob)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>MPs <span class="ot">&lt;-</span> MSEobj<span class="sc">@</span>MPs</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  PMobj</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(PD) <span class="ot">&lt;-</span> <span class="st">"PM"</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="do">## --------------------- ##</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="do">##   Escapement in SSB   ##</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="do">## --------------------- ##</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Escapement: median SSB at end of a 20-year harvesting period relative to</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co"># median SSB0, i.e. median(SSBF)/median(SSB0)</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Escapement Rule: median escapement at the end of a 20 year period is 75% of</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="co"># the median pre-exploitation level</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>ESC <span class="ot">&lt;-</span> <span class="cf">function</span> (<span class="at">MSEobj =</span> <span class="cn">NULL</span>, <span class="at">Ref =</span> <span class="dv">1</span>, <span class="at">Yrs =</span> <span class="dv">20</span>){</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>  Yrs <span class="ot">&lt;-</span> <span class="fu">ChkYrs</span>(Yrs, MSEobj)</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>  PMobj <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">"PMobj"</span>)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Name <span class="ot">&lt;-</span> <span class="st">"Escapement: Final Spawning Biomass relative to SSB0"</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"median(SSB at Year "</span>, Yrs[<span class="dv">2</span>], <span class="st">")/median(SSB0)"</span>)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Ref <span class="ot">&lt;-</span> Ref</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># derive median SSB0 over all simulations - using the unfished dynamics SB at</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the end of the historical period as a proxy for pre-exploitation SB</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>  SSB0_med <span class="ot">&lt;-</span> <span class="fu">median</span>(MSEobj<span class="sc">@</span>RefPoint<span class="sc">$</span>Dynamic_Unfished<span class="sc">$</span>SSB0[, MSEobj<span class="sc">@</span>nyears])</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select SSB in final year of the selected window</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Stat <span class="ot">&lt;-</span> MSEobj<span class="sc">@</span>SSB[, , Yrs[<span class="dv">2</span>], drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># since size of 3rd dimension is 1 (last year only), calProb merely simplifies</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># array</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Prob <span class="ot">&lt;-</span> <span class="fu">calcProb</span>(PMobj<span class="sc">@</span>Stat, MSEobj)</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>Mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(PMobj<span class="sc">@</span>Stat, <span class="dv">2</span>, median)<span class="sc">/</span>SSB0_med</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>  PMobj<span class="sc">@</span>MPs <span class="ot">&lt;-</span> MSEobj<span class="sc">@</span>MPs</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>  PMobj</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ESC) <span class="ot">&lt;-</span> <span class="st">"PM"</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="run-mse-simulations" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="run-mse-simulations"><span class="header-section-number">3.4</span> Run MSE Simulations</h2>
<p>With all the necessary components specified for the openMSE framework, we are now ready to run the MSE simulations for each of the scenario-specific OMs defined above.</p>
<p>Due to the large number of simulations (10k) and the extensive quantity of <span class="math inline">\(\gamma\)</span>-based MPs involved in each MSE run, we use the “slice-apply-combine” parallelization feature available on the main function <code>MSEtool::runMSE()</code> to speed up computations.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: runtime is substantial (~2.5 days across 20 cores), so we don't want to run</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this chunk on rendering!</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>openmse_scen_OMs <span class="sc">|&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imap</span>(\(x, y){</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    cli<span class="sc">::</span><span class="fu">cli_h1</span>(<span class="st">"Starting MSE run for {y} @ {Sys.time()}"</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate observational errors in survey estimates of B0. `B0logsd` is the</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SD of survey estimates of (log) B0 conveying the  observational error in</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># surveys, assumed to be log-Normally distributed. `B0logsd` is calculated</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># externally from survey data.</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    b0lgsd <span class="ot">&lt;-</span> grym_setups <span class="sc">|&gt;</span> <span class="fu">filter</span>(scenario_id <span class="sc">==</span> y) <span class="sc">|&gt;</span> <span class="fu">pull</span>(B0logsd)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    B0err_draws <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(x<span class="sc">@</span>nsim, <span class="sc">-</span>b0lgsd<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>, b0lgsd)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># build MPs for considered gammas</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    gammas <span class="ot">&lt;-</span> grym_setups <span class="sc">|&gt;</span> <span class="fu">filter</span>(scenario_id <span class="sc">==</span> y) <span class="sc">|&gt;</span> <span class="fu">pull</span>(gamma) <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="dv">1</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    gamma_B0_MPs <span class="ot">&lt;-</span> <span class="fu">build_gammaB0</span>(</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">gammas =</span> gammas, </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">nyears =</span> x<span class="sc">@</span>nyears,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">B0err =</span> B0err_draws)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># run MSE for current scenario    </span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    mse_output <span class="ot">&lt;-</span> <span class="fu">runMSE</span>(<span class="at">OM =</span> x, <span class="at">MPs =</span> gamma_B0_MPs, <span class="at">parallel =</span> <span class="st">"sac"</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    runtime <span class="ot">&lt;-</span> tictoc<span class="sc">::</span><span class="fu">toc</span>(<span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># write out mse outputs</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write_rds</span>(</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      mse_output,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> fs<span class="sc">::</span><span class="fu">path</span>(model_outputs_path, glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"openmse_mse_outputs_{y}.rds"</span>)), </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    cli<span class="sc">::</span><span class="fu">cli_alert_success</span>(<span class="st">"Finished MSE for {y}: {runtime$callback_msg}"</span>)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next we extract the most relevant outputs from the MSE simulations, while also computing the precautionary harvest rate <span class="math inline">\(\gamma_p\)</span> for each input scenario. As described in <a href="../2_GRYM_sims/grym_sims.html#sec-grym-intro"><span>Section&nbsp;2.1</span></a>, <span class="math inline">\(\gamma_p\)</span> is derived based on the three-step decision rule involving the depletion probability and escapement performance metrics.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  Utility function to extract relevant results and perform gammas selection</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>mse_extract_gammas <span class="ot">&lt;-</span> <span class="cf">function</span>(mseObj_file, <span class="at">SSB0_type =</span> <span class="st">"equilibrium"</span>){</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  cli<span class="sc">::</span><span class="fu">cli_alert</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Processing file {mseObj_file} @ {Sys.time()}"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  mse_out <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(mseObj_file)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># SSB0 data and source metrics functions, based on choice of type of reference point</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(SSB0_type <span class="sc">==</span> <span class="st">"equilibrium"</span>){</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    SSB0 <span class="ot">&lt;-</span> mse_out<span class="sc">@</span>OM<span class="sc">$</span>SSB0  </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">source</span>(<span class="st">"part1_openMSE_GRYM_approx/3_openMSE_sims/krill_mngnt_ccamlr_metrics_equilibrium.R"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSB0_type <span class="sc">==</span> <span class="st">"dyn_unfished"</span>){</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      SSB0 <span class="ot">&lt;-</span> mse_out<span class="sc">@</span>RefPoint<span class="sc">$</span>Dynamic_Unfished<span class="sc">$</span>SSB0[, mse_out<span class="sc">@</span>nyears]</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">source</span>(<span class="st">"part1_openMSE_GRYM_approx/3_openMSE_sims/krill_mngnt_ccamlr_metrics_dynamic.R"</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get considered gammas</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  gammas <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace</span>(mse_out<span class="sc">@</span>MPs, <span class="st">"gammaB0_"</span>, <span class="st">""</span>))</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract projected SSB and cast it into a dataframe</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dimnames</span>(mse_out<span class="sc">@</span>SSB) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">sim =</span> <span class="dv">1</span><span class="sc">:</span>mse_out<span class="sc">@</span>nsim, <span class="at">gamma =</span> gammas, <span class="at">Year =</span> <span class="dv">1</span><span class="sc">:</span>mse_out<span class="sc">@</span>proyears)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  ssb_proj <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(mse_out<span class="sc">@</span>SSB, <span class="at">value.name =</span> <span class="st">"SSB"</span>) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  ssb0 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sim =</span> <span class="dv">1</span><span class="sc">:</span>mse_out<span class="sc">@</span>nsim, </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">SSB0 =</span> SSB0</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># merge in SSB0, calculate yearly spawning stock status (SSS), and identify</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulations where SSS &lt; 0.2 at any point in the time-series</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  ssb_proj <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ssb_proj, ssb0, <span class="at">by =</span> <span class="st">"sim"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(sim, gamma) <span class="sc">|&gt;</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">SSS =</span> SSB<span class="sc">/</span>SSB0,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">below_dpl =</span> <span class="fu">if_else</span>(<span class="fu">min</span>(SSS) <span class="sc">&lt;</span> <span class="fl">0.2</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute depletion metric for each gamma</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  dep_metric <span class="ot">&lt;-</span> <span class="fu">PD</span>(mse_out)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute escapement metric for each gamma</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  esc_metric <span class="ot">&lt;-</span> <span class="fu">ESC</span>(mse_out)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  mse_metrics <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">gamma =</span> gammas, <span class="at">PD =</span> dep_metric<span class="sc">@</span>Mean, <span class="at">ESC =</span> esc_metric<span class="sc">@</span>Mean)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Derive gammas that satisfy the depletion and the escapement rules, and the</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># final gamma_p as min(gamma_1, gamma_2)</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  gamma_results <span class="ot">&lt;-</span> mse_metrics <span class="sc">|&gt;</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">gamma1 =</span> <span class="fu">max</span>(<span class="fu">max</span>(gamma[PD <span class="sc">&lt;=</span> <span class="fl">0.1</span>]), <span class="dv">0</span>), </span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">gamma1_approx =</span> <span class="fu">approx</span>(PD, gamma, <span class="fl">0.1</span>)<span class="sc">$</span>y, </span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">gamma2 =</span> <span class="fu">max</span>(gamma[ESC <span class="sc">&gt;=</span> <span class="fl">0.75</span>]),</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">gamma2_approx =</span> <span class="fu">approx</span>(ESC, gamma, <span class="fl">0.75</span>)<span class="sc">$</span>y</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">selected_gamma =</span> <span class="fu">if_else</span>(gamma1 <span class="sc">&lt;</span> gamma2, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return results in tibble with list-columns</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">ssb_proj =</span> <span class="fu">list</span>(ssb_proj), <span class="at">dep_metric =</span> <span class="fu">list</span>(dep_metric), </span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">esc_metric =</span> <span class="fu">list</span>(esc_metric), <span class="at">mse_metrics =</span> <span class="fu">list</span>(mse_metrics), </span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">gamma_results =</span> <span class="fu">list</span>(gamma_results)</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------------------</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Results and gammas for unfished dynamics SSB0 and dynamic B0</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>openmse_2yrhst_dynB0_dynSSB0_scen <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(model_outputs_path, <span class="at">regexp =</span> <span class="st">"scn"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">mse_extract_gammas</span>(.x, <span class="at">SSB0_type =</span> <span class="st">"dyn_unfished"</span>), <span class="at">.id =</span> <span class="st">"fname"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scen_id =</span> <span class="fu">str_extract</span>(fname, <span class="st">"scn-</span><span class="sc">\\</span><span class="st">d+"</span>), <span class="at">.before =</span> <span class="dv">1</span>, <span class="at">.keep =</span> <span class="st">"unused"</span>)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="co"># -- write out selected gammas</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>openmse_2yrhst_dynB0_dynSSB0_scen <span class="sc">|&gt;</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scen_id, gamma_results) <span class="sc">|&gt;</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(gamma_results) <span class="sc">|&gt;</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"approx"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_rds</span>(</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> fs<span class="sc">::</span><span class="fu">path</span>(results_path, <span class="st">"openmse_2yrhst_dynB0_dynSSB0_scen_gamma_select.rds"</span>)</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a><span class="co"># -- write out performance metrics</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>openmse_2yrhst_dynB0_dynSSB0_scen <span class="sc">|&gt;</span></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scen_id, mse_metrics) <span class="sc">|&gt;</span></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(mse_metrics) <span class="sc">|&gt;</span></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_rds</span>(<span class="at">file =</span> fs<span class="sc">::</span><span class="fu">path</span>(results_path, <span class="st">"openmse_2yrhst_dynB0_dynSSB0_scen_metrics.rds"</span>))</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a><span class="co"># -- write out simulated SSB trajectories under all scenarios</span></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>openmse_2yrhst_dynB0_dynSSB0_scen <span class="sc">|&gt;</span></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scen_id, ssb_proj) <span class="sc">|&gt;</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(ssb_proj) <span class="sc">|&gt;</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_rds</span>(<span class="at">file =</span> fs<span class="sc">::</span><span class="fu">path</span>(results_path, <span class="st">"openmse_2yrhst_dynB0_dynSSB0_scen_ssb.rds"</span>),</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="results" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="results"><span class="header-section-number">3.5</span> Results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  Read-in relevant outputs</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># import scenario key</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>scenarios_key <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../part1_shared_files/inputs/scenarios_key.rds"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">scen_id =</span> scenario_id)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># read in grym projections under each scenario, for a subset of gamma</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>grym_scen_outputs_sub <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../part1_shared_files/outputs/grym/grym_scen_outputs_sub.rds"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># subset of gammas to display in plots</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>gamma_subset <span class="ot">&lt;-</span> <span class="fu">unique</span>(grym_scen_outputs_sub<span class="sc">$</span>Gamma)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Grym gamma estimates</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>grym_gammas_tbl <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../part1_shared_files/outputs/grym/grym_gammas_tbl.rds"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span>scenario_id, as.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Gamma_1, Gamma_2), <span class="sc">~</span><span class="fu">if_else</span>(<span class="fu">is.infinite</span>(.), <span class="dv">0</span>, .))) <span class="sc">|&gt;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rename</span>(<span class="at">scen_id =</span> scenario_id, <span class="at">gamma1 =</span> Gamma_1, <span class="at">gamma2 =</span> Gamma_2, <span class="at">selected_gamma =</span> Gamma_choice)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># openmse </span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>openmse_scen_metrics <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  fs<span class="sc">::</span><span class="fu">path</span>(results_path, <span class="st">"openmse_2yrhst_dynB0_dynSSB0_scen_metrics.rds"</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fs::path(results_path, "openmse_100yrhst_dynB0_dynSSB0med_scen_metrics.rds")</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co"># open mse gamma estimates</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>openmse_scen_gamma_select <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  fs<span class="sc">::</span><span class="fu">path</span>(results_path, <span class="st">"openmse_2yrhst_dynB0_dynSSB0_scen_gamma_select.rds"</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fs::path(results_path, "openmse_100yrhst_dynB0_dynSSB0med_scen_gamma_select.rds") </span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<section id="spawning-stock-trajectories" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="spawning-stock-trajectories"><span class="header-section-number">3.5.1</span> Spawning stock trajectories</h3>
<p>Simulated trajectories of spawning Stock Status (<span class="math inline">\(SSS\)</span>) across the projecting period are presented in <a href="#fig-openmse-sss-traject">Figure&nbsp;<span>3.1</span></a>. As expected, trajectories show an increasing proportion of simulations in which <span class="math inline">\(SSB\)</span> drops bellow 20% of <span class="math inline">\(SSB_0\)</span> as the level of harvesting <span class="math inline">\(\gamma\)</span> increases. Consistent with the Grym analysis (<a href="../2_GRYM_sims/grym_sims.html#fig-grym-sss-traject">Figure&nbsp;<span>2.1</span></a>), there is greater variability in the <span class="math inline">\(SSS\)</span> trajectories across simulations in scenarios scen-3 to scen-8, reflecting the higher variance in simulated recruitment and natural mortality in those scenarios. Consequently, a substantial portion of simulations show stock depletion levels falling below the critical 20% threshold at low levels of fishing pressure (including when fishing is not present, i.e.&nbsp;<span class="math inline">\(\gamma = 0\)</span>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plots of simulated SSS across years, for each scenario under a subset of gammas</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SSS trajectories that go below 0.2 are signaled in green</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> openmse_scen_ssb <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gamma <span class="sc">%in%</span> gamma_subset) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> SSS, <span class="at">group =</span> sim)) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="sc">~</span><span class="fu">filter</span>(.x, below_dpl <span class="sc">==</span> <span class="cn">FALSE</span>), </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>, </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray75"</span>, </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.3</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="sc">~</span><span class="fu">filter</span>(.x, below_dpl <span class="sc">==</span> <span class="cn">TRUE</span>), </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>, </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> frmwk_colours[<span class="st">"openMSE"</span>], </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.3</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.2</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_sqrt</span>() <span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Spawning stock status (SSB/"</span>, SSB[<span class="dv">0</span>], <span class="st">")"</span>))) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(scen_id), <span class="at">cols =</span> <span class="fu">vars</span>(gamma), <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> p, </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"../part1_shared_files/outputs/openmse/openmse_fig_SSS_trajectories_gammas_scens.png"</span>, </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filename = "../part1_shared_files/outputs/openmse/openmse_fig_SSS_trajectories_gammas_scens_2.png", </span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">8</span>, </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">9</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-openmse-sss-traject" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;3.1: Simulated trajectories of spawning stock status over time, for each scenario (rows) under a subset of the considered <span class="math inline">\(\gamma\)</span> values (columns). Dashed line indicates the depletion threshold (0.2). Trajectories that fall below the 0.2 critical depletion threshold are signaled in blue.</figcaption><p></p>
<p><img src="../part1_shared_files/outputs/openmse/openmse_fig_SSS_trajectories_gammas_scens.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><a href="#fig-openmse-ssb0-ssb-dist-final-year">Figure&nbsp;<span>3.2</span></a> compares the distributions of simulated spawning stock biomass at a two time points: before exploitation (Year 0, <span class="math inline">\(SSB_0)\)</span> and after a 20-year period of harvesting (<span class="math inline">\(SSB_Y\)</span>). The comparison is shown for a selection of annual harvest rates <span class="math inline">\(\gamma\)</span> considered in the analysis. As expected, the decline of <span class="math inline">\(SSB_Y\)</span> relative to <span class="math inline">\(SSB_0\)</span> becomes more pronounced as the value of <span class="math inline">\(\gamma\)</span> increases.</p>
<p>In line with the Grym analysis, plots in <a href="#fig-openmse-ssb0-ssb-dist-final-year">Figure&nbsp;<span>3.2</span></a> also highlight the effects of high variability in recruitment and natural mortality in projected stock escapement levels. Simulations conducted under scenarios scn-3 to scn-8, which are based on Proportional Recruitment estimates yielding higher variance in simulated values of <span class="math inline">\(M\)</span> and <span class="math inline">\(R\)</span>, return median <span class="math inline">\(SSB_Y\)</span> estimates that are below 75% of the median <span class="math inline">\(SSB_0\)</span> at lower <span class="math inline">\(\gamma\)</span> values, in contrast to simulations conducted under scenarios scn-1 and scn-2.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get simulated values of SSB0 and SSB in final year of the projection</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>spawners <span class="ot">&lt;-</span> openmse_scen_ssb <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    gamma <span class="sc">%in%</span> gamma_subset,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">%in%</span> <span class="fu">max</span>(Year)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scen_id, sim, gamma, SSB, SSB0) <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(SSB , SSB0), <span class="at">names_to =</span> <span class="st">"metric"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">if_else</span>(metric <span class="sc">==</span> <span class="st">"SSB"</span>, <span class="st">"SSBY"</span>, metric),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">if_else</span>(metric <span class="sc">==</span> <span class="st">"SSBY"</span>,  <span class="st">"20"</span>, <span class="st">"0"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># compute medians SSB0 and SSB across all simulations , under each scenario</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>med_spawners <span class="ot">&lt;-</span> spawners <span class="sc">|&gt;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scen_id, metric, Year, gamma) <span class="sc">|&gt;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">medians =</span> <span class="fu">median</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span>) </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute escapement threshold value, i.e. 75% of median SSB0)</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: values are constant across gammas, as simulated SSB0s are held constant</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># across gamma-specific projections.</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>esc_thresh <span class="ot">&lt;-</span> med_spawners <span class="sc">|&gt;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(metric <span class="sc">==</span> <span class="st">"SSB0"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">esc_thrs =</span> medians<span class="sc">*</span><span class="fl">0.75</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> spawners <span class="sc">|&gt;</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_interval</span>() <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> med_spawners, <span class="fu">aes</span>(<span class="at">y =</span> medians)) <span class="sc">+</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> esc_thresh, <span class="fu">aes</span>(<span class="at">yintercept =</span> esc_thrs), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(scen_id <span class="sc">~</span> gamma, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Spawning Biomass"</span> ) <span class="sc">+</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">name =</span> <span class="st">"Quantile Interval (prob)"</span>) <span class="sc">+</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> p2, </span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"../part1_shared_files/outputs/openmse/openmse_SSB0_SSBY_dstbn_scens.png"</span>, </span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filename = "../part1_shared_files/outputs/openmse/openmse_SSB0_SSBY_dstbn_scens_2.png", </span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">8</span>, </span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">9</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-openmse-ssb0-ssb-dist-final-year" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;3.2: Quantile intervals (blue bars) and medians (dots) of simulated pre-explotation spawining biomass (Year 0) and spawning biomass at the final year of the projection (Year 20), across a subset of <span class="math inline">\(\gamma\)</span> values (columns) for each scenario (rows). Dashed lines indicate the critical escapement threshold (i.e.&nbsp;75% of median SSB0).</figcaption><p></p>
<p><img src="../part1_shared_files/outputs/openmse/openmse_SSB0_SSBY_dstbn_scens.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="depletion-probability-and-escapement-levels-versus-gamma-values" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="depletion-probability-and-escapement-levels-versus-gamma-values"><span class="header-section-number">3.5.2</span> Depletion probability and Escapement levels versus <span class="math inline">\(\gamma\)</span> values</h3>
<p>An overall view of the potential impact of various fixed annual harvest rates on the health of the stock, measured in terms of depletion probability and escapement levels, is shown in <a href="#fig-openmse-dplt-esc-gammas">Figure&nbsp;<span>3.3</span></a>. Main findings follow broadly those found in the Grym analysis, e.g.:</p>
<ul>
<li><p>For scenarios scn-3, scn-4, scn-7 and scn-8, probability of depletion would be substantially above the 10% critical limit even in the absence of fishing (i.e.&nbsp;<span class="math inline">\(\gamma = 0\)</span>). In the remaining scenarios, depletion probability would remain under the 10% critical limit for <span class="math inline">\(\gamma\)</span> values up to approximately 0.05 (scn-6) and 0.1 (scn-1).</p></li>
<li><p><span class="math inline">\(\gamma\)</span> values at which the stock is maintained at escapement levels above the critical 75% threshold also vary markedly between input scenarios. Scenario scn-8 simulates a stock with high vulnerability to fishing pressure, only able to sustain escapement levels above the critical point for harvest rates up to 1.5% of <span class="math inline">\(B_0\)</span>. On the other hand, under scenario scn-1, simulations suggest that the stock would remain above 75% escapement levels if the harvest rates are kept at least below 8% of <span class="math inline">\(B_0\)</span>.</p></li>
<li><p>Plots also show the effect of using alternative maturity ogives in the simulations, as evidenced by the separation between the pairs of scenarios scn-1 &amp; scn-2, scn-3 &amp; scn-4, etc. In comparison with scenarios under the maturity ogive mat-2021, those using the mat-2010 maturity ogive (scn-1, scn-3, scn-5, and scn-7) would cope with higher levels of <span class="math inline">\(\gamma\)</span> before dropping into unsustainable levels of depletion risk and escapement.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for depletion probability under considered gammas</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>p_dpl <span class="ot">&lt;-</span> <span class="fu">plot_gammas_vs_rule</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dt =</span> openmse_scen_metrics, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> gamma, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">rule_value =</span> PD, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scen =</span> scen_id,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">thresh =</span> <span class="fl">0.1</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Pr[min(SSB/SSB0) &lt; 0.2] (Years 1 - 20)"</span>, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(gamma),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Depletion"</span>, </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">scen_label =</span> <span class="st">"Scenario ID"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for escapement level under considered gammas</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>p_esc <span class="ot">&lt;-</span> <span class="fu">plot_gammas_vs_rule</span>(</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">dt =</span> openmse_scen_metrics, </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> gamma, </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">rule_value =</span> ESC, </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">scen =</span> scen_id, </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">thresh =</span> <span class="fl">0.75</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Escapement"</span>, </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"med(SSB)/med(SSB0) in Final Year"</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(gamma),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">scen_label =</span> <span class="st">"Scenario ID"</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>p_dpl<span class="sc">/</span>p_esc <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">'collect'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-openmse-dplt-esc-gammas" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;3.3: Depletion probabilities and escapement levels at considered harvest rates <span class="math inline">\(\gamma\)</span> under each scenario. Horizontal dashed lines indicate the 10% probability limit of the depletion rule (top plot) and the 75% critical threshold of the escapement rule (bottom plot).</figcaption><p></p>
<p><img src="openmse_sims_files/figure-html/fig-openmse-dplt-esc-gammas-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimated-gamma_p-under-each-input-scenario" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="estimated-gamma_p-under-each-input-scenario"><span class="header-section-number">3.5.3</span> Estimated <span class="math inline">\(\gamma_p\)</span> under each input scenario</h3>
<p><a href="#tbl-openmse-selected-gamma">Table&nbsp;<span>3.1</span></a> shows the precautionary harvest rate <span class="math inline">\(\gamma_p\)</span> estimated under the openMSE framework for each input scenario based on the 3-stage decision rule (<a href="../2_GRYM_sims/grym_sims.html#sec-grym-intro"><span>Section&nbsp;2.1</span></a>).</p>
<p>Similarly to the results obtained under the Grym approach, the magnitude of <span class="math inline">\(\gamma_p\)</span> estimates across the considered input scenarios is strongly influenced by the chosen Proportional Recruitment scenario. Scenarios using PR estimates reflecting lower variability and uncertainty in yearly recruitment (<span class="math inline">\(R\)</span>) and <span class="math inline">\(M\)</span> (scn-1 &amp; scn-2 under PR-emm21) produced the highest estimates <span class="math inline">\(\gamma_p\)</span>, based on the escapement rule (<span class="math inline">\(\gamma_2\)</span>). In contrast, scn-3, scn-4, scn-7 and scn-8, using PR estimates conveying the highest variability in <span class="math inline">\(R\)</span> (PR-amlr and PR-amlr-haul), returned <span class="math inline">\(\gamma_p\)</span> estimates of 0 based on the depletion rule (<span class="math inline">\(\gamma_1\)</span>). Therefore, under these scenarios, current management objectives would not be satisfied even in the absence of fishing.</p>
<p>The effect of maturity-at-length on <span class="math inline">\(\gamma_p\)</span> estimates is also evident, with scenarios employing the mat-2021 ogive yielding lower estimates of <span class="math inline">\(\gamma_p\)</span> compared to scenarios using the mat-2010 ogive. Under the mat-2021 ogive, the relatively higher proportion of immatures being vulnerable to fishing accelerates the decline of <span class="math inline">\(SSB\)</span> from <span class="math inline">\(SSB_0\)</span>, returning more conservative <span class="math inline">\(\gamma_p\)</span> estimates.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gammas in math format</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>gamma_symb <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">gamma_1"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">gamma_2"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">gamma_p"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>openmse_scen_gamma_select <span class="sc">|&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"approx"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span>scen_id, as.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(gamma1, gamma2), <span class="sc">~</span><span class="fu">if_else</span>(<span class="fu">is.infinite</span>(.), <span class="dv">0</span>, .))) <span class="sc">|&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(scenarios_key, <span class="at">by =</span> <span class="st">"scen_id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(gamma1<span class="sc">:</span>selected_gamma, <span class="at">.after =</span> <span class="fu">last_col</span>()) <span class="sc">|&gt;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gamma_p =</span> <span class="fu">pmin</span>(gamma1, gamma2)) <span class="sc">|&gt;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>selected_gamma) <span class="sc">|&gt;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">layout =</span> <span class="st">"autofit"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bold(j = ~ gamma_p) |&gt;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="sc">~</span> gamma1, <span class="at">i =</span> <span class="sc">~</span> gamma1 <span class="sc">&lt;</span> gamma2) <span class="sc">|&gt;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="sc">~</span> gamma2, <span class="at">i =</span> <span class="sc">~</span> gamma2 <span class="sc">&lt;</span> gamma1) <span class="sc">|&gt;</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vline</span>(<span class="at">j =</span> <span class="sc">~</span> gamma2, <span class="at">border =</span> <span class="fu">fp_border_default</span>(<span class="at">width =</span> .<span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="sc">~</span> gamma_p, <span class="at">bg =</span> <span class="st">"#E1F5FE"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">scenario_id =</span> <span class="st">"Scenario ID"</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pr_scen_id =</span> <span class="st">"PR Scenario ID"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">mat_scen_id =</span> <span class="st">"Maturity ID"</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="sc">~</span> gamma1 <span class="sc">+</span> gamma2 <span class="sc">+</span> gamma_p, <span class="at">width =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">j =</span> <span class="sc">~</span> gamma1 <span class="sc">+</span> gamma2 <span class="sc">+</span> gamma_p, </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">part =</span> <span class="st">"header"</span>, </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_equation</span>(gamma_symb))) <span class="sc">|&gt;</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span> <span class="sc">~</span> gamma1 <span class="sc">+</span> gamma2 <span class="sc">+</span> gamma_p, <span class="at">align =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-openmse-selected-gamma" class="anchored">

<div class="tabwid"><style>.cl-0462cc74{table-layout:auto;width:80%;}.cl-0452156e{font-family:'Calibri';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-04521582{font-family:'Calibri';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-045b3ee6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-045b3efa{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-045b3efb{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-045b6a9c{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6ab0{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6ab1{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0.5pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6ac4{background-color:rgba(225, 245, 254, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0.5pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6ace{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6acf{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6ad8{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0.5pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6ad9{background-color:rgba(225, 245, 254, 1.00);vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0.5pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6ae2{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6aec{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6af6{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0.5pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6af7{background-color:rgba(225, 245, 254, 1.00);vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0.5pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6b00{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6b01{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6b0a{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0.5pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-045b6b0b{background-color:rgba(225, 245, 254, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0.5pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-0462cc74"><caption>Table&nbsp;3.1:  Estimated precautionary harvest rate under each inputs scenario </caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-045b6a9c"><p class="cl-045b3ee6"><span class="cl-0452156e">scen_id</span></p></th><th class="cl-045b6a9c"><p class="cl-045b3ee6"><span class="cl-0452156e">PR Scenario ID</span></p></th><th class="cl-045b6a9c"><p class="cl-045b3ee6"><span class="cl-0452156e">Maturity ID</span></p></th><th class="cl-045b6ab0"><p class="cl-045b3efa"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" data-external="1"><span class="cl-0452156e"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>γ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\gamma_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></th><th class="cl-045b6ab1"><p class="cl-045b3efa"><span class="cl-0452156e"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>γ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\gamma_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></th><th class="cl-045b6ac4"><p class="cl-045b3efa"><span class="cl-0452156e"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>γ</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-045b6ace"><p class="cl-045b3ee6"><span class="cl-04521582">scn-1</span></p></td><td class="cl-045b6ace"><p class="cl-045b3ee6"><span class="cl-04521582">PR-emm21</span></p></td><td class="cl-045b6ace"><p class="cl-045b3ee6"><span class="cl-04521582">mat-2010</span></p></td><td class="cl-045b6acf"><p class="cl-045b3efb"><span class="cl-04521582">0.1000</span></p></td><td class="cl-045b6ad8"><p class="cl-045b3efb"><span class="cl-0452156e">0.0900</span></p></td><td class="cl-045b6ad9"><p class="cl-045b3efb"><span class="cl-04521582">0.0900</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">scn-2</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">PR-emm21</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">mat-2021</span></p></td><td class="cl-045b6aec"><p class="cl-045b3efb"><span class="cl-04521582">0.0675</span></p></td><td class="cl-045b6af6"><p class="cl-045b3efb"><span class="cl-0452156e">0.0650</span></p></td><td class="cl-045b6af7"><p class="cl-045b3efb"><span class="cl-04521582">0.0650</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">scn-3</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">PR-amlr</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">mat-2010</span></p></td><td class="cl-045b6aec"><p class="cl-045b3efb"><span class="cl-0452156e">0.0000</span></p></td><td class="cl-045b6af6"><p class="cl-045b3efb"><span class="cl-04521582">0.0425</span></p></td><td class="cl-045b6af7"><p class="cl-045b3efb"><span class="cl-04521582">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">scn-4</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">PR-amlr</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">mat-2021</span></p></td><td class="cl-045b6aec"><p class="cl-045b3efb"><span class="cl-0452156e">0.0000</span></p></td><td class="cl-045b6af6"><p class="cl-045b3efb"><span class="cl-04521582">0.0250</span></p></td><td class="cl-045b6af7"><p class="cl-045b3efb"><span class="cl-04521582">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">scn-5</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">PR-atlantida</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">mat-2010</span></p></td><td class="cl-045b6aec"><p class="cl-045b3efb"><span class="cl-0452156e">0.0700</span></p></td><td class="cl-045b6af6"><p class="cl-045b3efb"><span class="cl-04521582">0.0750</span></p></td><td class="cl-045b6af7"><p class="cl-045b3efb"><span class="cl-04521582">0.0700</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">scn-6</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">PR-atlantida</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">mat-2021</span></p></td><td class="cl-045b6aec"><p class="cl-045b3efb"><span class="cl-0452156e">0.0525</span></p></td><td class="cl-045b6af6"><p class="cl-045b3efb"><span class="cl-04521582">0.0650</span></p></td><td class="cl-045b6af7"><p class="cl-045b3efb"><span class="cl-04521582">0.0525</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">scn-7</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">PR-amlr-haul</span></p></td><td class="cl-045b6ae2"><p class="cl-045b3ee6"><span class="cl-04521582">mat-2010</span></p></td><td class="cl-045b6aec"><p class="cl-045b3efb"><span class="cl-0452156e">0.0000</span></p></td><td class="cl-045b6af6"><p class="cl-045b3efb"><span class="cl-04521582">0.0275</span></p></td><td class="cl-045b6af7"><p class="cl-045b3efb"><span class="cl-04521582">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-045b6b00"><p class="cl-045b3ee6"><span class="cl-04521582">scn-8</span></p></td><td class="cl-045b6b00"><p class="cl-045b3ee6"><span class="cl-04521582">PR-amlr-haul</span></p></td><td class="cl-045b6b00"><p class="cl-045b3ee6"><span class="cl-04521582">mat-2021</span></p></td><td class="cl-045b6b01"><p class="cl-045b3efb"><span class="cl-0452156e">0.0000</span></p></td><td class="cl-045b6b0a"><p class="cl-045b3efb"><span class="cl-04521582">0.0150</span></p></td><td class="cl-045b6b0b"><p class="cl-045b3efb"><span class="cl-04521582">0.0000</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
<section id="comparison-between-grym-and-openmse-results" class="level3" data-number="3.5.4">
<h3 data-number="3.5.4" class="anchored" data-anchor-id="comparison-between-grym-and-openmse-results"><span class="header-section-number">3.5.4</span> Comparison between Grym and openMSE results</h3>
<p>Projections of spawning stock status (<span class="math inline">\(SSS\)</span>) simulated under the Grym implementation (obtained in <a href="../2_GRYM_sims/grym_sims.html"><span>Chapter&nbsp;2</span></a>) and the openMSE approach, for the considered input scenarios, are compared in <a href="#fig-openmse-vs-grym-sss-scen">Figure&nbsp;<span>3.4</span></a> and <a href="#fig-openmse-vs-grym-diff-med_sss">Figure&nbsp;<span>3.5</span></a>. Key findings include:</p>
<ul>
<li><p>OpenMSE simulations demonstrate higher variability (i.e.&nbsp;greater uncertainty) in the annual <span class="math inline">\(SSS\)</span> estimates compared to the Grym approach. This is evident from the wider 90% quantile intervals observed in the openMSE results.</p></li>
<li><p>The difference in dispersion between the two frameworks is more pronounced in scenarios scn-3, scn-4, scn-7 &amp; scn-8, which are characterized by PR estimates with higher variability in <span class="math inline">\(R\)</span>.</p></li>
<li><p>Moreover, for scenarios scn-3, scn-4, scn-7 &amp; scn-8, dispersion levels estimated by the Grym implementation tend to decrease over the projection period at higher <span class="math inline">\(\gamma\)</span> values, while dispersion remains stable in the openMSE simulations. This discrepancy may be attributed to the recruitment depletion penalization applied in Grym, which is not incorporated in the openMSE implementation (see <a href="#sec-openmse-diffs-sr"><span>Section&nbsp;3.2.2</span></a>).</p></li>
<li><p>Similarity between the two frameworks in terms of median annual <span class="math inline">\(SSS\)</span> is primarily determined by the chosen PR scenario. For instance, in scenarios scn-1 and scn-2 (under PR-emm21), the two implementations return matching trajectories of median <span class="math inline">\(SSS\)</span> up to harvest rates of <span class="math inline">\(\gamma = 0.05\)</span>, while for scn-5 and scn-6 (under PR-atlantida) the proximity in trajectories extends to harvest rates up to <span class="math inline">\(\gamma = 0.12\)</span>. However, in the remaining scenarios (under PR-amlr and PR-amlr-haul), the separation between the two frameworks occurs at lower harvest rates.</p></li>
<li><p>The impact of the recruitment depletion penalization is also evident in the median <span class="math inline">\(SSS\)</span> trajectories in scenarios scn-3, scn-4, scn-7 &amp; scn-8, where the decay in the projected median <span class="math inline">\(SSS\)</span> is faster under the Grym approach.</p></li>
</ul>
<!-- - The application of alternative maturity ogives appear to have a greater impact -->
<!-- on the openMSE framework, as median $SSS$ projections under the ogive mat-2021 -->
<!-- (i.e. scn-2, scn-4, sn-6 and scn-8) tend to decline faster than those under is -->
<ul>
<li>The degree of impact of alternative maturity ogives on median <span class="math inline">\(SSS\)</span> projections appears to vary between frameworks as well. The differences in trajectories between scenarios using contrasting maturity ogives (e.g.&nbsp;scn-1 &amp; scn-2, scn-3 &amp; scn-4, etc) are more pronounced under the openMSE approach. This discrepancy is likely attributed to the difference in the computation of <span class="math inline">\(SSB\)</span> between the two frameworks. Grym calculates <span class="math inline">\(SSB\)</span> at a specific fraction of the year (“Spawning season”: days 76 to 138; <a href="../2_GRYM_sims/grym_sims.html#tbl-fixed-pars">Table&nbsp;<span>2.2</span></a>) during which the stock biomass peaks due to peak individual growth. As a result, Grym tends to produce higher estimates of <span class="math inline">\(SSB\)</span> compared to the openMSE implementation, which estimates <span class="math inline">\(SSB\)</span> at the start of the year.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>grym_scen_SSS <span class="ot">&lt;-</span> grym_scen_outputs_sub <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">scen_id =</span> scenario_id, <span class="at">sim =</span> Run, <span class="at">gamma =</span> Gamma) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scen_id, sim, gamma, Year, SSS) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Framework =</span> <span class="st">"Grym"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>openmse_scen_SSS <span class="ot">&lt;-</span> openmse_scen_ssb <span class="sc">|&gt;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gamma <span class="sc">%in%</span> gamma_subset) <span class="sc">|&gt;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scen_id, sim, gamma, Year, SSS) <span class="sc">|&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Framework =</span> <span class="st">"openMSE"</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>frmwk_scen_SSS <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(grym_scen_SSS, openmse_scen_SSS) </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot projections of spawning stock status under each gamma, across input</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># scenarios</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>p_SSS_proj_frmwk <span class="ot">&lt;-</span> frmwk_scen_SSS <span class="sc">|&gt;</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(scen_id == "scn-1", gamma == 0) |&gt;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scen_id, Year, gamma, Framework) <span class="sc">|&gt;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(SSS, <span class="at">.width =</span> <span class="fl">0.9</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> SSS, <span class="at">fill =</span> Framework, <span class="at">color =</span> Framework)) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_lineribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> frmwk_colours) <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> frmwk_colours) <span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(scen_id <span class="sc">~</span> gamma, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Spawning stock status (SSB/"</span>, SSB[<span class="dv">0</span>], <span class="st">")"</span>))) <span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> p_SSS_proj_frmwk, </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"../part1_shared_files/outputs/plot_openMSE_vs_Grym_SSS_traject_scens.png"</span>,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filename = "../part1_shared_files/outputs/plot_openMSE_vs_Grym_SSS_traject_scens_2.png", </span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">8</span>, </span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">11</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>p_med_SSS_proj_frmwk <span class="ot">&lt;-</span> frmwk_scen_SSS <span class="sc">|&gt;</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(scen_id == "scn-1", gamma == 0) |&gt;</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scen_id, Year, gamma, Framework) <span class="sc">|&gt;</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">med_SSS =</span> <span class="fu">median</span>(SSS), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> med_SSS, <span class="at">colour =</span> Framework)) <span class="sc">+</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> frmwk_colours) <span class="sc">+</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(scen_id <span class="sc">~</span> gamma, <span class="at">scales =</span> <span class="st">"fixed"</span>) <span class="sc">+</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Spawning stock status (SSB/"</span>, SSB[<span class="dv">0</span>], <span class="st">")"</span>))) <span class="sc">+</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> p_med_SSS_proj_frmwk, </span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"../part1_shared_files/outputs/plot_openMSE_vs_Grym_med_SSS_traject_scens.png"</span>,</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filename = "../part1_shared_files/outputs/plot_openMSE_vs_Grym_med_SSS_traject_scens_2.png", </span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">8</span>, </span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">8</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-openmse-vs-grym-sss-scen" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;3.4: Median (solid lines) and 90% intervals (shaded ribbons) of simulated projections of Spawning Stock Status under the openMSE and Grym frameworks, for considered input scenarios (rows) and a subset of <span class="math inline">\(\gamma\)</span> values.</figcaption><p></p>
<p><img src="../part1_shared_files/outputs/plot_openMSE_vs_Grym_SSS_traject_scens.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-openmse-vs-grym-diff-med_sss" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;3.5: Median of simulated annual Spawning Stock Status in the projection period under the openMSE and Grym frameworks, for the considered input scenarios (rows) and a subset of <span class="math inline">\(\gamma\)</span> values.</figcaption><p></p>
<p><img src="../part1_shared_files/outputs/plot_openMSE_vs_Grym_med_SSS_traject_scens.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The estimated harvest rates satisfying the depletion (<span class="math inline">\(\gamma_1\)</span>) and escapement (<span class="math inline">\(\gamma_2\)</span>) decision rules are compared between the two frameworks in <a href="#fig-openmse-vs-grym-gammas">Figure&nbsp;<span>3.6</span></a>.</p>
<p>In general, the openMSE implementation tends to produce estimates of <span class="math inline">\(\gamma_1\)</span> and <span class="math inline">\(\gamma_2\)</span> that are either slightly lower (scn-1, scn-2, scn-5 and scn-6) or identical (scn-4 and scn-8) to those estimated by the Grym implementation. For scenarios scn-3 and scn-7, the estimates of <span class="math inline">\(\gamma_2\)</span> obtained in openMSE are marginally higher than those obtained in Grym. This reflects the faster decline in median <span class="math inline">\(SSS\)</span> trajectories under Grym, as observed and discussed in <a href="#fig-openmse-vs-grym-diff-med_sss">Figure&nbsp;<span>3.5</span></a>.</p>
<p>There is no clear pattern regarding the impact of alternative maturity ogives on <span class="math inline">\(\gamma_1\)</span> and <span class="math inline">\(\gamma_2\)</span> estimates from the two frameworks.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>openmse_gammas_est <span class="ot">&lt;-</span> openmse_scen_gamma_select <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Framework =</span> <span class="st">"openMSE"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>grym_gammas_est <span class="ot">&lt;-</span> grym_gammas_tbl <span class="sc">|&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Framework =</span> <span class="st">"Grym"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>frmwk_gammas_est <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(openmse_gammas_est, grym_gammas_est)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>gamma_support_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Framework =</span> <span class="fu">c</span>(<span class="st">"openMSE"</span>, <span class="st">"Grym"</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> grym_setups<span class="sc">$</span>gamma[[<span class="dv">1</span>]]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>frmwk_gammas_est <span class="sc">|&gt;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(gamma1, gamma2), <span class="at">names_to =</span> <span class="st">"gamma_type"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Framework, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(data = gamma_support_tbl, aes(x = Framework, y = gamma), size = 0.5, color = "gray80") +</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> gamma_support_tbl, <span class="fu">aes</span>(<span class="at">x =</span> Framework, <span class="at">y =</span> gamma), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">shape =</span> <span class="st">"|"</span>) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> gamma_type, <span class="at">group =</span> gamma_type), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> gamma_type, <span class="at">group =</span> gamma_type)) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Harvest rate ("</span>, gamma, <span class="st">")"</span>)),</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Type of "</span>, gamma))</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AFB42B"</span>, <span class="st">"#FF8F00"</span>), <span class="at">name =</span> <span class="st">"Harvest Rule"</span>,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">expression</span>(gamma[<span class="dv">1</span>], gamma[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>scen_id, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-openmse-vs-grym-gammas" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;3.6: openMSE an Grym estimates of harvest rates complying with the depletion rule (<span class="math inline">\(\gamma_1\)</span>) and the escapement rule (<span class="math inline">\(\gamma_2\)</span>) for each of the considered input scenarios. Vertical gray ticks represent the values of <span class="math inline">\(\gamma\)</span> considered for the analysis.</figcaption><p></p>
<p><img src="openmse_sims_files/figure-html/fig-openmse-vs-grym-gammas-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Therefore, and considering the estimates of precautionary harvest rates presented in <a href="#tbl-openmse-vs-grym-selected-gamma">Table&nbsp;<span>3.2</span></a>, results indicate a reasonable level of agreement between the two approaches across the considered input scenarios. The implemented openMSE-Grym approximation is capable of producing estimates of <span class="math inline">\(\gamma_p\)</span> that are either identical or within a range of 1.25 - 2.25 percentage points lower than those obtained under the Grym’s base-case implementation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gamma_symb <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">gamma_p^{openMSE}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">gamma_p^{Grym}"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>frmwk_gammas_est <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scen_id, Framework) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gamma_p =</span> <span class="fu">pmin</span>(gamma1, gamma2)) <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> scen_id,<span class="at">names_from =</span> Framework, <span class="at">values_from =</span> gamma_p) <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(scenarios_key, <span class="at">by =</span> <span class="st">"scen_id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(pr_scen_id<span class="sc">:</span>mat_scen_id, <span class="at">.after =</span> scen_id) <span class="sc">|&gt;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">layout =</span> <span class="st">"autofit"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">scenario_id =</span> <span class="st">"Scenario ID"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pr_scen_id =</span> <span class="st">"PR Scenario ID"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mat_scen_id =</span> <span class="st">"Maturity ID"</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">j =</span> <span class="sc">~</span> openMSE <span class="sc">+</span> Grym, </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">part =</span> <span class="st">"header"</span>, </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_equation</span>(gamma_symb))) <span class="sc">|&gt;</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span> <span class="sc">~</span> openMSE <span class="sc">+</span> Grym, <span class="at">align =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-openmse-vs-grym-selected-gamma" class="anchored">

<div class="tabwid"><style>.cl-054f63d6{table-layout:auto;width:75%;}.cl-053d5920{font-family:'Calibri';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-053d593e{font-family:'Calibri';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-054516b0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-054516c4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-054516ce{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-05453334{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0545333e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05453348{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05453352{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0545335c{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0545335d{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05453366{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05453370{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-054f63d6"><caption>Table&nbsp;3.2:  Estimated precautionary harvest rates under the openMSE and Grym frameworks for the considered input scenarios. </caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-05453334"><p class="cl-054516b0"><span class="cl-053d5920">scen_id</span></p></th><th class="cl-05453334"><p class="cl-054516b0"><span class="cl-053d5920">PR Scenario ID</span></p></th><th class="cl-05453334"><p class="cl-054516b0"><span class="cl-053d5920">Maturity ID</span></p></th><th class="cl-0545333e"><p class="cl-054516c4"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" data-external="1"><span class="cl-053d5920"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>γ</mi><mi>p</mi><mrow><mi>o</mi><mi>p</mi><mi>e</mi><mi>n</mi><mi>M</mi><mi>S</mi><mi>E</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\gamma_p^{openMSE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2744em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">MSE</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></th><th class="cl-0545333e"><p class="cl-054516c4"><span class="cl-053d5920"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>γ</mi><mi>p</mi><mrow><mi>G</mi><mi>r</mi><mi>y</mi><mi>m</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\gamma_p^{Grym}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2744em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">ry</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-05453348"><p class="cl-054516b0"><span class="cl-053d593e">scn-1</span></p></td><td class="cl-05453348"><p class="cl-054516b0"><span class="cl-053d593e">PR-emm21</span></p></td><td class="cl-05453348"><p class="cl-054516b0"><span class="cl-053d593e">mat-2010</span></p></td><td class="cl-05453352"><p class="cl-054516ce"><span class="cl-053d593e">0.0900</span></p></td><td class="cl-05453352"><p class="cl-054516ce"><span class="cl-053d593e">0.1075</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">scn-2</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">PR-emm21</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">mat-2021</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0650</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0900</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">scn-3</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">PR-amlr</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">mat-2010</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0000</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">scn-4</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">PR-amlr</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">mat-2021</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0000</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">scn-5</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">PR-atlantida</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">mat-2010</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0700</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0775</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">scn-6</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">PR-atlantida</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">mat-2021</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0525</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0675</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">scn-7</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">PR-amlr-haul</span></p></td><td class="cl-0545335c"><p class="cl-054516b0"><span class="cl-053d593e">mat-2010</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0000</span></p></td><td class="cl-0545335d"><p class="cl-054516ce"><span class="cl-053d593e">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-05453366"><p class="cl-054516b0"><span class="cl-053d593e">scn-8</span></p></td><td class="cl-05453366"><p class="cl-054516b0"><span class="cl-053d593e">PR-amlr-haul</span></p></td><td class="cl-05453366"><p class="cl-054516b0"><span class="cl-053d593e">mat-2021</span></p></td><td class="cl-05453370"><p class="cl-054516ce"><span class="cl-053d593e">0.0000</span></p></td><td class="cl-05453370"><p class="cl-054516ce"><span class="cl-053d593e">0.0000</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
</section>
<section id="discussion" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="discussion"><span class="header-section-number">3.6</span> Discussion</h2>
<p>The main objective of this analysis was to replicate the estimation of precautionary harvest rates for the Antarctic Krill, as currently performed under the Grym framework <span class="citation" data-cites="maschette_etal20 maschette_etal21">(<a href="../../references.html#ref-maschette_etal20" role="doc-biblioref">D. Maschette et al. 2020</a>; <a href="../../references.html#ref-maschette_etal21" role="doc-biblioref">D. Maschette et al. 2021</a>)</span>, using the <code>R</code> package <code>{openMSE}</code> <span class="citation" data-cites="hordyk_etal21">(<a href="../../references.html#ref-hordyk_etal21" role="doc-biblioref">Hordyk, Huynh, and Carruthers 2021</a>)</span>. In order to achieve this, the components of openMSE (i.e.&nbsp;Operating Model, Management Procedures and Performance Metrics) were configured to approximate the modelling features of the Grym approach, as specified in CCAMLR’s <a href="https://github.com/ccamlr/Grym_Base_Case/tree/Simulations">base-case</a> implementation for the Krill fishery. The effectiveness of the approximation was assessed by applying the openMSE implementation across a set of eight model input scenarios. These scenarios were designed to capture variations in Proportional Recruitment estimates (i.e.&nbsp;natural mortality, <span class="math inline">\(M\)</span>, and recruitment variability, <span class="math inline">\(CV_R\)</span>), as well as alternative maturity ogive curves. Each of these scenarios were also used in Grym simulations in a concurrent analysis (<a href="../2_GRYM_sims/grym_sims.html"><span>Chapter&nbsp;2</span></a>). By comparing the results obtained from openMSE with those from Grym under the same set of scenarios, we can examine the suitability of the openMSE framework to the Krill fishery.</p>
<p>Results revealed that the implemented openMSE approximation was able to generate estimates of precautionary harvest rates <span class="math inline">\(\gamma_p\)</span> that were either identical or reasonably close to those obtained under the Grym implementation, for the considered input scenarios. Discrepancies in the <span class="math inline">\(\gamma_p\)</span> estimates, as well as in the inherent estimates of harvest rates satisfying the depletion (<span class="math inline">\(\gamma_1\)</span>) and the escapement (<span class="math inline">\(\gamma_2\)</span>) rules, suggest that the openMSE approximation tends to yield slightly more conservative harvest rates than the Grym approach.</p>
<p>Discrepancies observed in results are likely due to fundamental structural differences between the two frameworks (see <a href="#sec-openmse-inherent-diffs"><span>Section&nbsp;3.2</span></a>) that could not be addressed in the present analysis. For example, the absence of the recruitment depletion factor, the additional 2-year historical period under stochasticity, and the difference in the estimation of <span class="math inline">\(SSB_0\)</span> are all contributing factors for higher variability in openMSE simulations, increasing the chances of stock depletion falling below the critical threshold level and consequently leading to lower estimates of <span class="math inline">\(\gamma_1\)</span>. On the other hand, openMSE is unable to approximate fine-scale temporal dynamics required for the calculation of key stock parameters at specific fractions of the year. For instance, Grym estimates <span class="math inline">\(SSB\)</span> specifically for the spawning season which, given the growth period under assumption, results in higher <span class="math inline">\(SSB\)</span> estimates compared to those calculated at the start of the year, as is the case with an annual model like openMSE. Consequently, Grym projections tend to return higher levels of escapement for the same level of exploitation, leading to higher estimates of <span class="math inline">\(\gamma_2\)</span>.</p>
<!-- Mention the inclusion of whithin-year patterns in M and F would most likely
further increase the deviations between frameworks-->
<p>The openMSE framework is still under active development, and it is possible that some of the missing Grym features could be incorporated with relative ease. However, increasing the temporal resolution to sub-year levels poses a significant technical challenge that would require substantial effort and development to implement.</p>
<p>The key strength of the openMSE framework is its capability to provide a comprehensive infrastructure to explore, evaluate and compare the performance of alternative management strategies. Furthermore, through its core package <code>{DLMtool}</code> <span class="citation" data-cites="carruthers_hordyk18">(<a href="../../references.html#ref-carruthers_hordyk18" role="doc-biblioref">Carruthers and Hordyk 2018</a>)</span>, openMSE offers a range of Management Strategies tailored for data-limited populations, further enhancing its applicability to the Antarctic Krill fishery.</p>
<p>This analysis demonstrates that the implemented openMSE approximation is able to produce results that are fairly aligned with those obtained under the modelling framework currently adopted for the management of the Krill fishery. These findings instill confidence in the validity and reliability of the openMSE framework for conducting Management Strategy Evaluation (MSE) analysis for the Antarctic Krill.</p>
<p>Which is what we focus on next!</p>
</section>
<section id="supplementary-code" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="supplementary-code"><span class="header-section-number">3.7</span> Supplementary Code</h2>
<section id="sec-openmse-om-builder" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="sec-openmse-om-builder"><span class="header-section-number">3.7.1</span> Operating Model builder function</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">#' ------------------------------------------------------------------------------</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#'  Build OM object that approximates Krill's Grym base case implementation</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#' ------------------------------------------------------------------------------</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#' </span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#' This function allows to create Operating Models configured to approximate the</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#' base case of krill fishery assessment implemented under the Grym framework</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#' (https://github.com/ccamlr/Grym_Base_Case/tree/Simulations)</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#'</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#' Within the Grym-approximated configuration, the function allows to specifying</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#' alternative input values for stock parameters such as M, maturity,</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#' selectivity, etc. In this way, it is a convenience function to generate</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">#' multiple OMs for alternative input scenarios.</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">#'</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">#' The two OM components that are configurable are the 'Stock' and 'Fleet'</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#' objects</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#'</span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co">#' --------------------------------------------------------------------------------</span></span>
<span id="cb16-18"><a href="#cb16-18"></a></span>
<span id="cb16-19"><a href="#cb16-19"></a></span>
<span id="cb16-20"><a href="#cb16-20"></a>build_OM_grym_approx <span class="ot">&lt;-</span> <span class="cf">function</span>(om_name, maxage, </span>
<span id="cb16-21"><a href="#cb16-21"></a>                                 Linf, K, t0, mat50Min, mat50Max, matrange, </span>
<span id="cb16-22"><a href="#cb16-22"></a>                                 sel50Min, sel50Max, selrange, a, b, </span>
<span id="cb16-23"><a href="#cb16-23"></a>                                 M_draws, RCV_draws,</span>
<span id="cb16-24"><a href="#cb16-24"></a>                                 n_iter, proj_yrs, maxF, <span class="at">seed =</span> <span class="dv">1001</span>){</span>
<span id="cb16-25"><a href="#cb16-25"></a>  </span>
<span id="cb16-26"><a href="#cb16-26"></a>  <span class="fu">require</span>(openMSE)</span>
<span id="cb16-27"><a href="#cb16-27"></a>  </span>
<span id="cb16-28"><a href="#cb16-28"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-29"><a href="#cb16-29"></a>  <span class="co">#           Stock Object</span></span>
<span id="cb16-30"><a href="#cb16-30"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-31"><a href="#cb16-31"></a>  <span class="co"># class?Stock</span></span>
<span id="cb16-32"><a href="#cb16-32"></a>  </span>
<span id="cb16-33"><a href="#cb16-33"></a>  krill_stock <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">"Stock"</span>)</span>
<span id="cb16-34"><a href="#cb16-34"></a>  </span>
<span id="cb16-35"><a href="#cb16-35"></a>  krill_stock<span class="sc">@</span>Name <span class="ot">&lt;-</span> <span class="st">"krill_stock"</span></span>
<span id="cb16-36"><a href="#cb16-36"></a>  krill_stock<span class="sc">@</span>Common_Name <span class="ot">&lt;-</span> <span class="st">"Antarctic Krill"</span></span>
<span id="cb16-37"><a href="#cb16-37"></a>  krill_stock<span class="sc">@</span>Species <span class="ot">&lt;-</span> <span class="st">"Euphausia superba"</span></span>
<span id="cb16-38"><a href="#cb16-38"></a>  <span class="co"># krill assumed to not live past 7 years-old</span></span>
<span id="cb16-39"><a href="#cb16-39"></a>  krill_stock<span class="sc">@</span>maxage <span class="ot">&lt;-</span> maxage</span>
<span id="cb16-40"><a href="#cb16-40"></a>  <span class="co"># arbitrary value number of individuals of age-0 recruitment to the population</span></span>
<span id="cb16-41"><a href="#cb16-41"></a>  krill_stock<span class="sc">@</span>R0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-42"><a href="#cb16-42"></a>  <span class="co"># M undefined as it will be provided as random draws via `cpars`</span></span>
<span id="cb16-43"><a href="#cb16-43"></a>  krill_stock<span class="sc">@</span>M <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>) </span>
<span id="cb16-44"><a href="#cb16-44"></a>  <span class="co"># M constant over time</span></span>
<span id="cb16-45"><a href="#cb16-45"></a>  krill_stock<span class="sc">@</span>Msd <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-46"><a href="#cb16-46"></a>  <span class="co"># approximation to Grym approach, where simulated recruitment is reduced when</span></span>
<span id="cb16-47"><a href="#cb16-47"></a>  <span class="co"># population falls below depletion levels (i.e. SSB = 0.2 x SSB0)</span></span>
<span id="cb16-48"><a href="#cb16-48"></a>  krill_stock<span class="sc">@</span>h <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.90</span>, <span class="fl">0.95</span>)</span>
<span id="cb16-49"><a href="#cb16-49"></a>  <span class="co"># Beverton Holt relationship</span></span>
<span id="cb16-50"><a href="#cb16-50"></a>  krill_stock<span class="sc">@</span>SRrel <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-51"><a href="#cb16-51"></a>  <span class="co"># M undefined as it will be provided as random draws via the `cpars` slot</span></span>
<span id="cb16-52"><a href="#cb16-52"></a>  krill_stock<span class="sc">@</span>Perr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb16-53"><a href="#cb16-53"></a>  <span class="co"># no autocorrelation between consecutive recruitments</span></span>
<span id="cb16-54"><a href="#cb16-54"></a>  krill_stock<span class="sc">@</span>AC <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-55"><a href="#cb16-55"></a>  <span class="co"># l@a - Linf assumed as known, as in Grym, from Constable and de la Mare (1996)</span></span>
<span id="cb16-56"><a href="#cb16-56"></a>  krill_stock<span class="sc">@</span>Linf <span class="ot">&lt;-</span> <span class="fu">c</span>(Linf,	Linf)</span>
<span id="cb16-57"><a href="#cb16-57"></a>  <span class="co"># l@a - no inter-annual variation in Linf</span></span>
<span id="cb16-58"><a href="#cb16-58"></a>  krill_stock<span class="sc">@</span>Linfsd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-59"><a href="#cb16-59"></a>  <span class="co"># l@a - k assumed as known, as in Grym, from Thanassekos et al (2021)</span></span>
<span id="cb16-60"><a href="#cb16-60"></a>  krill_stock<span class="sc">@</span>K <span class="ot">&lt;-</span> <span class="fu">c</span>(K,	K)</span>
<span id="cb16-61"><a href="#cb16-61"></a>  <span class="co"># l@a - no inter-annual variation in k</span></span>
<span id="cb16-62"><a href="#cb16-62"></a>  krill_stock<span class="sc">@</span>Ksd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-63"><a href="#cb16-63"></a>  <span class="co"># l@a - t0 assumed as known, as in Grym, from Thanassekos et al (2021)</span></span>
<span id="cb16-64"><a href="#cb16-64"></a>  krill_stock<span class="sc">@</span>t0 <span class="ot">&lt;-</span> <span class="fu">c</span>(t0, t0)</span>
<span id="cb16-65"><a href="#cb16-65"></a>  <span class="co"># l@a - low variation in length-at-age, assumed as known</span></span>
<span id="cb16-66"><a href="#cb16-66"></a>  krill_stock<span class="sc">@</span>LenCV <span class="ot">&lt;-</span>	<span class="fu">c</span>(<span class="fl">0.01</span>,	<span class="fl">0.01</span>)</span>
<span id="cb16-67"><a href="#cb16-67"></a>  <span class="co"># m@l - mid-point of maturity-at-size, from Maschette et al. (2021)</span></span>
<span id="cb16-68"><a href="#cb16-68"></a>  krill_stock<span class="sc">@</span>L50 <span class="ot">&lt;-</span> <span class="fu">c</span>(mat50Min,	mat50Max)</span>
<span id="cb16-69"><a href="#cb16-69"></a>  <span class="co"># m@l - Difference in lengths between 50% and 95% maturity - based on width of ogive</span></span>
<span id="cb16-70"><a href="#cb16-70"></a>  <span class="co"># ramp, as provided by Maschette et al (2021)</span></span>
<span id="cb16-71"><a href="#cb16-71"></a>  L50 <span class="ot">&lt;-</span> mat50Min <span class="co"># arbitrary as ogive width is treated as independent of L50 in Maschette et al (2021)</span></span>
<span id="cb16-72"><a href="#cb16-72"></a>  L95 <span class="ot">&lt;-</span> <span class="fu">qunif</span>(<span class="fl">0.95</span>, L50 <span class="sc">-</span> matrange<span class="sc">/</span><span class="dv">2</span>, L50 <span class="sc">+</span> matrange<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-73"><a href="#cb16-73"></a>  krill_stock<span class="sc">@</span>L50_95 <span class="ot">&lt;-</span> <span class="fu">c</span>(L95 <span class="sc">-</span> L50 ,	L95 <span class="sc">-</span> L50 )</span>
<span id="cb16-74"><a href="#cb16-74"></a>  <span class="co"># m@l - current stock depletion</span></span>
<span id="cb16-75"><a href="#cb16-75"></a>  krill_stock<span class="sc">@</span>D <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb16-76"><a href="#cb16-76"></a>  <span class="co"># w@l - a assumed as known, as in Grym, from CCAMLR (2000)</span></span>
<span id="cb16-77"><a href="#cb16-77"></a>  krill_stock<span class="sc">@</span>a <span class="ot">&lt;-</span> a</span>
<span id="cb16-78"><a href="#cb16-78"></a>  <span class="co"># w@l - a assumed as known, as in Grym, from CCAMLR (2000)</span></span>
<span id="cb16-79"><a href="#cb16-79"></a>  krill_stock<span class="sc">@</span>b <span class="ot">&lt;-</span> b</span>
<span id="cb16-80"><a href="#cb16-80"></a>  <span class="co"># areas of equal size</span></span>
<span id="cb16-81"><a href="#cb16-81"></a>  krill_stock<span class="sc">@</span>Size_area_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb16-82"><a href="#cb16-82"></a>  <span class="co"># equal fraction of unfished biomass in two areas</span></span>
<span id="cb16-83"><a href="#cb16-83"></a>  krill_stock<span class="sc">@</span>Frac_area_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb16-84"><a href="#cb16-84"></a>  <span class="co"># 50% chance of individuals remaining in area</span></span>
<span id="cb16-85"><a href="#cb16-85"></a>  krill_stock<span class="sc">@</span>Prob_staying <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb16-86"><a href="#cb16-86"></a>  <span class="co"># Zero discard mortality rate as discards are assumed non-existent</span></span>
<span id="cb16-87"><a href="#cb16-87"></a>  krill_stock<span class="sc">@</span>Fdisc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>) <span class="co"># c(1, 1)</span></span>
<span id="cb16-88"><a href="#cb16-88"></a>  <span class="co"># undefined since there are multiple sources</span></span>
<span id="cb16-89"><a href="#cb16-89"></a>  krill_stock<span class="sc">@</span>Source <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="dv">0</span>)</span>
<span id="cb16-90"><a href="#cb16-90"></a>  </span>
<span id="cb16-91"><a href="#cb16-91"></a>  </span>
<span id="cb16-92"><a href="#cb16-92"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-93"><a href="#cb16-93"></a>  <span class="co">#           Fleet Object</span></span>
<span id="cb16-94"><a href="#cb16-94"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-95"><a href="#cb16-95"></a>  <span class="co"># class?Fleet</span></span>
<span id="cb16-96"><a href="#cb16-96"></a>  </span>
<span id="cb16-97"><a href="#cb16-97"></a>  krill_fleet <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">"Fleet"</span>)</span>
<span id="cb16-98"><a href="#cb16-98"></a>  </span>
<span id="cb16-99"><a href="#cb16-99"></a>  krill_fleet<span class="sc">@</span>Name <span class="ot">&lt;-</span> <span class="st">"krill_fleet"</span></span>
<span id="cb16-100"><a href="#cb16-100"></a>  <span class="co"># Minimum allowed number of years</span></span>
<span id="cb16-101"><a href="#cb16-101"></a>  krill_fleet<span class="sc">@</span>nyears <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb16-102"><a href="#cb16-102"></a>  <span class="co"># final year of historic period</span></span>
<span id="cb16-103"><a href="#cb16-103"></a>  krill_fleet<span class="sc">@</span>CurrentYr <span class="ot">&lt;-</span> <span class="dv">2022</span></span>
<span id="cb16-104"><a href="#cb16-104"></a>  <span class="co"># Arbitrary value for grym approximation - at least 1 value required</span></span>
<span id="cb16-105"><a href="#cb16-105"></a>  krill_fleet<span class="sc">@</span>EffYears <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-106"><a href="#cb16-106"></a>  <span class="co"># stock remains unfished over historical period</span></span>
<span id="cb16-107"><a href="#cb16-107"></a>  krill_fleet<span class="sc">@</span>EffLower <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-108"><a href="#cb16-108"></a>  krill_fleet<span class="sc">@</span>EffUpper <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-109"><a href="#cb16-109"></a>  krill_fleet<span class="sc">@</span>Esd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-110"><a href="#cb16-110"></a>  <span class="co"># No change in mean gear efficiency over projection years, as in Grym</span></span>
<span id="cb16-111"><a href="#cb16-111"></a>  krill_fleet<span class="sc">@</span>qinc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-112"><a href="#cb16-112"></a>  <span class="co"># no inter-annual variability in gear efficiency over projection years, as in Grym</span></span>
<span id="cb16-113"><a href="#cb16-113"></a>  krill_fleet<span class="sc">@</span>qcv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-114"><a href="#cb16-114"></a>  <span class="co"># Shortest lt at which 5% of fish of that length-class are selected by fishery,</span></span>
<span id="cb16-115"><a href="#cb16-115"></a>  <span class="co"># based on data from Thanassekos et al (2021)</span></span>
<span id="cb16-116"><a href="#cb16-116"></a>  L50 <span class="ot">&lt;-</span> <span class="fu">c</span>(sel50Min, sel50Max)</span>
<span id="cb16-117"><a href="#cb16-117"></a>  L5 <span class="ot">&lt;-</span> <span class="fu">qunif</span>(<span class="fl">0.05</span>, L50 <span class="sc">-</span> selrange<span class="sc">/</span><span class="dv">2</span>, L50 <span class="sc">+</span> selrange<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-118"><a href="#cb16-118"></a>  krill_fleet<span class="sc">@</span>L5 <span class="ot">&lt;-</span> L5</span>
<span id="cb16-119"><a href="#cb16-119"></a>  <span class="co"># Shortest length at which 100% of fish of that length are selected by the fishery</span></span>
<span id="cb16-120"><a href="#cb16-120"></a>  krill_fleet<span class="sc">@</span>LFS <span class="ot">&lt;-</span> L50 <span class="sc">+</span> selrange<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb16-121"><a href="#cb16-121"></a>  <span class="co"># All krill selected at Linf</span></span>
<span id="cb16-122"><a href="#cb16-122"></a>  krill_fleet<span class="sc">@</span>Vmaxlen <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb16-123"><a href="#cb16-123"></a>  <span class="co"># selectectivity in absolute size</span></span>
<span id="cb16-124"><a href="#cb16-124"></a>  krill_fleet<span class="sc">@</span>isRel <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb16-125"><a href="#cb16-125"></a>  <span class="co"># no discards - i.e. all individuals selected by the gear are retained</span></span>
<span id="cb16-126"><a href="#cb16-126"></a>  krill_fleet<span class="sc">@</span>LR5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># L5</span></span>
<span id="cb16-127"><a href="#cb16-127"></a>  krill_fleet<span class="sc">@</span>LFR <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)  <span class="co">#LFS</span></span>
<span id="cb16-128"><a href="#cb16-128"></a>  <span class="co"># All krill retained at Linf</span></span>
<span id="cb16-129"><a href="#cb16-129"></a>  krill_fleet<span class="sc">@</span>Rmaxlen <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb16-130"><a href="#cb16-130"></a>  <span class="co"># No discards</span></span>
<span id="cb16-131"><a href="#cb16-131"></a>  krill_fleet<span class="sc">@</span>DR <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-132"><a href="#cb16-132"></a>  <span class="co"># fishing effort allocated across areas in proportion to the population density of that area</span></span>
<span id="cb16-133"><a href="#cb16-133"></a>  krill_fleet<span class="sc">@</span>Spat_targ <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb16-134"><a href="#cb16-134"></a>  <span class="co"># No MPA</span></span>
<span id="cb16-135"><a href="#cb16-135"></a>  krill_fleet<span class="sc">@</span>MPA <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb16-136"><a href="#cb16-136"></a>  </span>
<span id="cb16-137"><a href="#cb16-137"></a>  </span>
<span id="cb16-138"><a href="#cb16-138"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-139"><a href="#cb16-139"></a>  <span class="co">#           Obs Object</span></span>
<span id="cb16-140"><a href="#cb16-140"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-141"><a href="#cb16-141"></a>  <span class="co"># class?Obs</span></span>
<span id="cb16-142"><a href="#cb16-142"></a>  </span>
<span id="cb16-143"><a href="#cb16-143"></a>  <span class="co"># The Obs component is irrelevant for the approximation with GRYM, as specified</span></span>
<span id="cb16-144"><a href="#cb16-144"></a>  <span class="co"># MPs (one for each level of harvest rate 'gamma') don't require</span></span>
<span id="cb16-145"><a href="#cb16-145"></a>  <span class="co"># observed/sampled data from the fishery. So assigning 0s to all slots</span></span>
<span id="cb16-146"><a href="#cb16-146"></a>  </span>
<span id="cb16-147"><a href="#cb16-147"></a>  krill_obs <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">"Obs"</span>)</span>
<span id="cb16-148"><a href="#cb16-148"></a>  krill_obs<span class="sc">@</span>Name <span class="ot">&lt;-</span> <span class="st">"No bias and no observational errors"</span></span>
<span id="cb16-149"><a href="#cb16-149"></a>  krill_obs<span class="sc">@</span>Cobs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-150"><a href="#cb16-150"></a>  krill_obs<span class="sc">@</span>Cbiascv <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-151"><a href="#cb16-151"></a>  krill_obs<span class="sc">@</span>CAA_nsamp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-152"><a href="#cb16-152"></a>  krill_obs<span class="sc">@</span>CAA_ESS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-153"><a href="#cb16-153"></a>  krill_obs<span class="sc">@</span>CAL_nsamp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-154"><a href="#cb16-154"></a>  krill_obs<span class="sc">@</span>CAL_ESS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-155"><a href="#cb16-155"></a>  krill_obs<span class="sc">@</span>Iobs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-156"><a href="#cb16-156"></a>  krill_obs<span class="sc">@</span>Btobs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-157"><a href="#cb16-157"></a>  krill_obs<span class="sc">@</span>Btbiascv <span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-158"><a href="#cb16-158"></a>  krill_obs<span class="sc">@</span>beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-159"><a href="#cb16-159"></a>  krill_obs<span class="sc">@</span>LenMbiascv <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-160"><a href="#cb16-160"></a>  krill_obs<span class="sc">@</span>Mbiascv	<span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-161"><a href="#cb16-161"></a>  krill_obs<span class="sc">@</span>Kbiascv	<span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-162"><a href="#cb16-162"></a>  krill_obs<span class="sc">@</span>t0biascv <span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-163"><a href="#cb16-163"></a>  krill_obs<span class="sc">@</span>Linfbiascv <span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-164"><a href="#cb16-164"></a>  krill_obs<span class="sc">@</span>LFCbiascv	<span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-165"><a href="#cb16-165"></a>  krill_obs<span class="sc">@</span>LFSbiascv	<span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-166"><a href="#cb16-166"></a>  krill_obs<span class="sc">@</span>FMSY_Mbiascv <span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-167"><a href="#cb16-167"></a>  krill_obs<span class="sc">@</span>BMSY_B0biascv	<span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-168"><a href="#cb16-168"></a>  krill_obs<span class="sc">@</span>Irefbiascv <span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-169"><a href="#cb16-169"></a>  krill_obs<span class="sc">@</span>Brefbiascv <span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-170"><a href="#cb16-170"></a>  krill_obs<span class="sc">@</span>Crefbiascv <span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-171"><a href="#cb16-171"></a>  krill_obs<span class="sc">@</span>Dbiascv	<span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-172"><a href="#cb16-172"></a>  krill_obs<span class="sc">@</span>Dobs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-173"><a href="#cb16-173"></a>  krill_obs<span class="sc">@</span>hbiascv	<span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-174"><a href="#cb16-174"></a>  krill_obs<span class="sc">@</span>Recbiascv	<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-175"><a href="#cb16-175"></a>  krill_obs<span class="sc">@</span>sigmaRbiascv <span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-176"><a href="#cb16-176"></a>  krill_obs<span class="sc">@</span>Eobs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-177"><a href="#cb16-177"></a>  krill_obs<span class="sc">@</span>Ebiascv	<span class="ot">&lt;-</span> <span class="dv">0</span>	</span>
<span id="cb16-178"><a href="#cb16-178"></a>  </span>
<span id="cb16-179"><a href="#cb16-179"></a>  </span>
<span id="cb16-180"><a href="#cb16-180"></a>  </span>
<span id="cb16-181"><a href="#cb16-181"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-182"><a href="#cb16-182"></a>  <span class="co">#           Imp Object</span></span>
<span id="cb16-183"><a href="#cb16-183"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-184"><a href="#cb16-184"></a>  <span class="co"># class?Imp</span></span>
<span id="cb16-185"><a href="#cb16-185"></a>  </span>
<span id="cb16-186"><a href="#cb16-186"></a>  <span class="co"># To mimic Grym approach, assuming the imposed TACs are enforced perfectly -</span></span>
<span id="cb16-187"><a href="#cb16-187"></a>  <span class="co"># catches never exceed nor fall short of the imposed quota</span></span>
<span id="cb16-188"><a href="#cb16-188"></a>  </span>
<span id="cb16-189"><a href="#cb16-189"></a>  krill_imp <span class="ot">&lt;-</span> MSEtool<span class="sc">::</span>Perfect_Imp</span>
<span id="cb16-190"><a href="#cb16-190"></a>  </span>
<span id="cb16-191"><a href="#cb16-191"></a>  </span>
<span id="cb16-192"><a href="#cb16-192"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-193"><a href="#cb16-193"></a>  <span class="co">#        Create Operating Model</span></span>
<span id="cb16-194"><a href="#cb16-194"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-195"><a href="#cb16-195"></a>  </span>
<span id="cb16-196"><a href="#cb16-196"></a>  krill_OM <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">"OM"</span>, krill_stock, krill_fleet, krill_obs, krill_imp)</span>
<span id="cb16-197"><a href="#cb16-197"></a>  </span>
<span id="cb16-198"><a href="#cb16-198"></a>  </span>
<span id="cb16-199"><a href="#cb16-199"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-200"><a href="#cb16-200"></a>  <span class="co">#     Additional OM information </span></span>
<span id="cb16-201"><a href="#cb16-201"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-202"><a href="#cb16-202"></a>  <span class="co"># class?OM</span></span>
<span id="cb16-203"><a href="#cb16-203"></a>  </span>
<span id="cb16-204"><a href="#cb16-204"></a>  krill_OM<span class="sc">@</span>Name <span class="ot">&lt;-</span> om_name</span>
<span id="cb16-205"><a href="#cb16-205"></a>  krill_OM<span class="sc">@</span>Agency <span class="ot">&lt;-</span> <span class="st">"CCAMLR"</span></span>
<span id="cb16-206"><a href="#cb16-206"></a>  krill_OM<span class="sc">@</span>Region <span class="ot">&lt;-</span> <span class="st">"FAO Area 48"</span></span>
<span id="cb16-207"><a href="#cb16-207"></a>  krill_OM<span class="sc">@</span>Sponsor <span class="ot">&lt;-</span> <span class="st">"Norwegian Polar Institute"</span></span>
<span id="cb16-208"><a href="#cb16-208"></a>  krill_OM<span class="sc">@</span>Latitude <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">60</span></span>
<span id="cb16-209"><a href="#cb16-209"></a>  krill_OM<span class="sc">@</span>Longitude <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">40</span></span>
<span id="cb16-210"><a href="#cb16-210"></a>  krill_OM<span class="sc">@</span>nsim <span class="ot">&lt;-</span> n_iter</span>
<span id="cb16-211"><a href="#cb16-211"></a>  krill_OM<span class="sc">@</span>proyears <span class="ot">&lt;-</span> proj_yrs</span>
<span id="cb16-212"><a href="#cb16-212"></a>  krill_OM<span class="sc">@</span>interval <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-213"><a href="#cb16-213"></a>  <span class="co"># MPs based on the median of distribution of recommendations</span></span>
<span id="cb16-214"><a href="#cb16-214"></a>  krill_OM<span class="sc">@</span>pstar <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb16-215"><a href="#cb16-215"></a>  krill_OM<span class="sc">@</span>maxF <span class="ot">&lt;-</span> maxF</span>
<span id="cb16-216"><a href="#cb16-216"></a>  <span class="co"># MPs are the median value of distribution of recommendations </span></span>
<span id="cb16-217"><a href="#cb16-217"></a>  krill_OM<span class="sc">@</span>reps <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-218"><a href="#cb16-218"></a>  krill_OM<span class="sc">@</span>seed <span class="ot">&lt;-</span> seed</span>
<span id="cb16-219"><a href="#cb16-219"></a>  </span>
<span id="cb16-220"><a href="#cb16-220"></a>  </span>
<span id="cb16-221"><a href="#cb16-221"></a>  </span>
<span id="cb16-222"><a href="#cb16-222"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-223"><a href="#cb16-223"></a>  <span class="co">#         Custom Parameters </span></span>
<span id="cb16-224"><a href="#cb16-224"></a>  <span class="co"># ---------------------------------- #</span></span>
<span id="cb16-225"><a href="#cb16-225"></a>  </span>
<span id="cb16-226"><a href="#cb16-226"></a>  <span class="co"># Switch off age-plus group</span></span>
<span id="cb16-227"><a href="#cb16-227"></a>  krill_OM<span class="sc">@</span>cpars<span class="sc">$</span>plusgroup <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-228"><a href="#cb16-228"></a>  <span class="co"># Pre-generated samples of M</span></span>
<span id="cb16-229"><a href="#cb16-229"></a>  M_draws[<span class="fu">which</span>(M_draws <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="fl">1e-5</span> <span class="co"># openMSE crashes if M == 0, so a slightly naughty work-around</span></span>
<span id="cb16-230"><a href="#cb16-230"></a>  krill_OM<span class="sc">@</span>cpars<span class="sc">$</span>M <span class="ot">&lt;-</span> M_draws</span>
<span id="cb16-231"><a href="#cb16-231"></a>  <span class="co"># Pre-generated samples of Perr</span></span>
<span id="cb16-232"><a href="#cb16-232"></a>  krill_OM<span class="sc">@</span>cpars<span class="sc">$</span>Perr <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">log</span>(RCV_draws<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)) <span class="co"># converting CV from PR to lognormal SD</span></span>
<span id="cb16-233"><a href="#cb16-233"></a>  <span class="co"># switch off depletion optimization step - thus, depletion calculated from the selectivity and pattern in F</span></span>
<span id="cb16-234"><a href="#cb16-234"></a>  krill_OM<span class="sc">@</span>cpars<span class="sc">$</span>qs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, n_iter)</span>
<span id="cb16-235"><a href="#cb16-235"></a>  </span>
<span id="cb16-236"><a href="#cb16-236"></a>  <span class="fu">return</span>(krill_OM)</span>
<span id="cb16-237"><a href="#cb16-237"></a>}</span>
<span id="cb16-238"><a href="#cb16-238"></a></span>
<span id="cb16-239"><a href="#cb16-239"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-carruthers_hordyk18" class="csl-entry" role="doc-biblioentry">
Carruthers, Thomas R., and Adrian R. Hordyk. 2018. <span>“The Data-Limited Methods Toolkit (DLMtool): An R Package for Informing Management of Data-Limited Populations.”</span> <em>Methods in Ecology and Evolution</em> 9 (12): 2388–95. <a href="https://doi.org/10.1111/2041-210X.13081">https://doi.org/10.1111/2041-210X.13081</a>.
</div>
<div id="ref-constable_delamare96" class="csl-entry" role="doc-biblioentry">
Constable, A, and W. de la Mare. 1996. <span>“A Generalised Model for Evaluating Yield and the Long-Term Status of Fish Stocks Under Conditions of Uncertainty.”</span> <em>CCAMLR Science</em> 3: 31–54.
</div>
<div id="ref-hordyk_etal21" class="csl-entry" role="doc-biblioentry">
Hordyk, Adrian, Quang Huynh, and Thomas Carruthers. 2021. <span>“openMSE: Easily Install and Load the <span>‘openMSE’</span> Packages.”</span> R. <a href="https://CRAN.R-project.org/package=openMSE">https://CRAN.R-project.org/package=openMSE</a>.
</div>
<div id="ref-kawaguchi16" class="csl-entry" role="doc-biblioentry">
Kawaguchi, So. 2016. <span>“Reproduction and Larval Development in Antarctic Krill (Euphausia Superba).”</span> In <em>Biology and Ecology of Antarctic Krill</em>, edited by Volker Siegel, 225–46. Advances in Polar Ecology. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-29279-3_6">https://doi.org/10.1007/978-3-319-29279-3_6</a>.
</div>
<div id="ref-kinzey21" class="csl-entry" role="doc-biblioentry">
Kinzey, D. 2021. <span>“Summary of Proportional Recruitment and Multiyear Biomass Variability for Krill in Subarea 48 from Research Surveys.”</span> WG-SAM-2021/21 Rev1. CCAMLR.
</div>
<div id="ref-maschette_etal20" class="csl-entry" role="doc-biblioentry">
Maschette, D., S. Wotherspoon, C. Pavez, P. Ziegler, S. Thanassekos, K Reid, D Kawagushi, D Welsford, and A Constable. 2020. <span>“Generalised R Yield Model (Grym).”</span> Scientific Committee SC-CAMLR-39/BG/19. CCAMLR.
</div>
<div id="ref-maschette_etal21" class="csl-entry" role="doc-biblioentry">
Maschette, D, S Wotherspoon, S Kawaguchi, and Philippe Ziegler. 2021. <span>“Grym Assessment for Subarea 48.1 Euphausia Superba Populations.”</span> WG-FSA-2021/39. Hobart, Autralia: CCAMLR. <a href="https://meetings.ccamlr.org/en/wg-fsa-2021/39">https://meetings.ccamlr.org/en/wg-fsa-2021/39</a>.
</div>
<div id="ref-sc-camlr00" class="csl-entry" role="doc-biblioentry">
SC-CAMLR. 2000. <span>“Report of the Bo Workshop.”</span> SC-CAMLR-XIX. Annex 4, Appendix G. CCAMLR.
</div>
<div id="ref-thanassekos_etal21" class="csl-entry" role="doc-biblioentry">
Thanassekos, S, K Reid, S Kawaguchi, S Wotherspoon, D Maschette, P Ziegler, D Welsford, et al. 2021. <span>“Grym Parameter Values for Subareas 48.1, 48.2 and 48.3.”</span> WG-SAM-2021/12. CCAMLR.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>In addition to the configuring steps described in this section, we also <a href="https://github.com/Blue-Matter/MSEtool/compare/master...bcaneco:MSEtool:master" class="external" target="_blank">modified</a> one of the internal functions of openMSE’s core package <code>{MSEtool}</code> to allow a minimum historical period of 2 years. To make the modified source code available for the simulations, <code>{MSEtool}</code> needs to be re-installed from the forked branch, e.g.&nbsp;via <code>renv::install("https://github.com/bcaneco/MSEtool")</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../part1_openMSE_GRYM_approx/2_GRYM_sims/grym_sims.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">GYM/Grym Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../part1_openMSE_GRYM_approx/5_appendices/krill_om_report_example.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Appendix: OM Report (<em>scn-1</em>)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>