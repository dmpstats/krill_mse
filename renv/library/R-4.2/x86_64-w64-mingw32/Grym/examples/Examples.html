<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Examples</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Examples</h1>


<div id="TOC">
<ul>
<li><a href="#vonbertalanffyal" id="toc-vonbertalanffyal">vonBertalanffyAL</a></li>
<li><a href="#powerlw" id="toc-powerlw">powerLW</a></li>
<li><a href="#rampogive" id="toc-rampogive">rampOgive</a></li>
<li><a href="#logisticogive" id="toc-logisticogive">logisticOgive</a></li>
<li><a href="#doublenormalselectivity" id="toc-doublenormalselectivity">doubleNormalSelectivity</a></li>
<li><a href="#trapz" id="toc-trapz">trapz</a></li>
<li><a href="#meantrapz" id="toc-meantrapz">meanTrapz</a></li>
<li><a href="#project" id="toc-project">project</a></li>
<li><a href="#projectc" id="toc-projectc">projectC</a></li>
<li><a href="#advance" id="toc-advance">advance</a></li>
<li><a href="#rescaleprojection" id="toc-rescaleprojection">rescaleProjection</a></li>
<li><a href="#agestructured" id="toc-agestructured">ageStructureD</a></li>
<li><a href="#agestructures" id="toc-agestructures">ageStructureS</a></li>
<li><a href="#stock-summary" id="toc-stock-summary">Stock
Summary</a></li>
<li><a href="#spawningb0d" id="toc-spawningb0d">spawningB0D</a></li>
<li><a href="#spawningb0s" id="toc-spawningb0s">spawningB0S</a></li>
<li><a href="#prrecruits" id="toc-prrecruits">prRecruits</a></li>
<li><a href="#prrecruitsgym" id="toc-prrecruitsgym">prRecruitsGYM</a></li>
<li><a href="#prbootstrap" id="toc-prbootstrap">prBootstrap</a></li>
<li><a href="#resamplergym" id="toc-resamplergym">resampleRGYM</a></li>
<li><a href="#surveysurvival" id="toc-surveysurvival">surveySurvival</a></li>
<li><a href="#surveyadjustgym" id="toc-surveyadjustgym">surveyAdjustGYM</a></li>
</ul>
</div>

<p>This document collates and annotates the examples from Grym.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Grym)</span></code></pre></div>
<div id="vonbertalanffyal" class="section level2">
<h2>vonBertalanffyAL</h2>
<p>The GYM uses the von Bertalanffy growth curve <span class="math display">\[
L = L_{\infty} \left ( 1 - e^{-K (A-t_{0})} \right )
\]</span> to map ages to lengths.</p>
<p>The <code>vonBertalanffyAL</code> function implments the von
Bertalanffy growth curve as parameterized in the GYM</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert age to length</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>age, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>len</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">309.8225</span> <span class="fl">384.6515</span> <span class="fl">430.0376</span> <span class="fl">457.5657</span> <span class="fl">474.2623</span> <span class="fl">484.3893</span> <span class="fl">490.5316</span></span></code></pre></div>
<p>and <code>vonBertalanffyLA</code> is the inverse mapping</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert length to age</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyLA</span>(<span class="at">L=</span>len, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>age</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span></span></code></pre></div>
<div id="length-at-age" class="section level4">
<h4>Length at age</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create a matrix of the age at each time step of each age class</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span></code></pre></div>
<p>Use a von Bertalanffy length at age relationship to create a matrix
of the length at each time step of each age class</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length conversion</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>ls, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length&quot;</span>, <span class="at">main=</span><span class="st">&quot;Length at Age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The restricted model assumes that growth is restricted to some
fraction of the year</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length conversion - growth occurs in middle of the year</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyRAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>, <span class="at">f0=</span><span class="fl">0.3</span>, <span class="at">f1=</span><span class="fl">0.7</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>ls, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length&quot;</span>, <span class="at">main=</span><span class="st">&quot;Length at Age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is possible for for the growth period to extend across the year
boundary, but no growth occurs before <code>f0</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length conversion - growth occurs across the year boundary</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyRAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>, <span class="at">f0=</span><span class="fl">0.8</span>, <span class="at">f1=</span><span class="fl">1.2</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>ls, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length&quot;</span>, <span class="at">main=</span><span class="st">&quot;Length at Age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="powerlw" class="section level2">
<h2>powerLW</h2>
<p>The GYM uses a simple power law model <span class="math display">\[
W = a L^b
\]</span> to map lengths to weights.</p>
<p>The <code>powerLW</code> function implements the power law model as
parameterized in the GYM</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">150</span>, <span class="at">to=</span><span class="dv">450</span>, <span class="at">by=</span><span class="dv">50</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert length to weight</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>wgt <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>len, <span class="at">a=</span><span class="fl">9.0E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>wgt</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.01509613</span> <span class="fl">0.03923396</span> <span class="fl">0.08230066</span> <span class="fl">0.15075963</span> <span class="fl">0.25150604</span> <span class="fl">0.39181556</span> <span class="fl">0.57930604</span></span></code></pre></div>
<p>and <code>powerWL</code> is the inverse mapping</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert weigth to length</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="fu">powerWL</span>(<span class="at">W=</span>wgt, <span class="at">a=</span><span class="fl">9.0E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>len</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">150</span> <span class="dv">200</span> <span class="dv">250</span> <span class="dv">300</span> <span class="dv">350</span> <span class="dv">400</span> <span class="dv">450</span></span></code></pre></div>
<div id="weight-at-age" class="section level4">
<h4>Weight at age</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create a matrix of the age at each time step of each age class</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span></code></pre></div>
<p>Use a von Bertalanffy length at age relationship to create a matrix
of the length at each time step of each age class</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length conversion</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span></code></pre></div>
<p>and a power law weight-length relationship to create a matrix of the
weight at each time step of each age class</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Length-weight conversion</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>ws, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Weight&quot;</span>,<span class="at">main=</span><span class="st">&quot;Weight at Age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="rampogive" class="section level2">
<h2>rampOgive</h2>
<p>The GYM uses a simple ramp shaped ogive to model both maturity and
fishing selectivity.</p>
<p>The <code>rampOgive</code> function implements a ramp ogive
parameterized in terms of the mid-point and width of the ramp</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">150</span>, <span class="at">to=</span><span class="dv">450</span>, <span class="at">by=</span><span class="dv">10</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(x, <span class="at">x50=</span><span class="dv">300</span>, <span class="at">xrange=</span><span class="dv">80</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>x, <span class="at">y=</span>p, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="logisticogive" class="section level2">
<h2>logisticOgive</h2>
<p>Grym provides a logistic ogive to model both maturity or fishing
selectivity.</p>
<p>The <code>logisticOgive</code> function implements a logistic ogive
parameterized in terms of the 50th and 95th percentiles</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">150</span>, <span class="at">to=</span><span class="dv">450</span>, <span class="at">by=</span><span class="dv">10</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">logisticOgive</span>(x, <span class="at">x50=</span><span class="dv">300</span>, <span class="at">x95=</span><span class="dv">380</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>x, <span class="at">y=</span>p, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="doublenormalselectivity" class="section level2">
<h2>doubleNormalSelectivity</h2>
<p>The <code>doubleNormalSelectivity</code> function implements a double
Normal or dome shaped selectivity function.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">150</span>, <span class="at">to=</span><span class="dv">450</span>, <span class="at">by=</span><span class="dv">2</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">doubleNormalSelectivity</span>(x, <span class="at">x1=</span><span class="dv">250</span>, <span class="at">x2=</span><span class="dv">320</span>, <span class="at">s1=</span><span class="dv">30</span>, <span class="at">s2=</span><span class="dv">15</span>, <span class="at">y1=</span><span class="fl">0.1</span>, <span class="at">y2=</span><span class="fl">0.7</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>x, <span class="at">y=</span>p, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="trapz" class="section level2">
<h2>trapz</h2>
<p>The <code>trapz</code> function implements the composite trapezoidal
rule for numerical quadrature, and <code>ctrapz</code> implements a
cumulative trapezoidal rule.</p>
<p>Consider the definite integral <span class="math display">\[
\int_{1}^{x} 2 x dx = x^2 - 1
\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The definite integral of 2*x from 1 to x is x^2-1</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ctrapz</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="dv">0</span>  <span class="dv">3</span>  <span class="dv">8</span> <span class="dv">15</span> <span class="dv">24</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">trapz</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">24</span></span></code></pre></div>
<p>For a matrix argument, these functions operate column by column</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Integrate cos(x),  sin(x)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">2</span><span class="sc">*</span>pi, <span class="at">by=</span>h)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">cos</span>(x), <span class="fu">sin</span>(x))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>x, <span class="at">y=</span><span class="fu">ctrapz</span>(<span class="at">fs=</span>cs, <span class="at">h=</span>h), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;firebrick&quot;</span>)) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="meantrapz" class="section level2">
<h2>meanTrapz</h2>
<p>The <code>meanTrapz</code> computes averages over a time interval,
but if the interval consists of a single point the value at that point
is returned.</p>
<p>Consider the expected value <span class="math display">\[
\frac{\int_{1}^{x} 2 x dx}{x-1} =
\begin{cases}
  x+1 &amp; x \neq 1\\
  0 &amp; x=1
\end{cases}
\]</span></p>
<p>For an interval <code>trapzMean</code> computes averages with the
trapezoidal rule</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The average of 2*x from 1 to 5</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">trapzMeans</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">6</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">trapz</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x, <span class="at">h=</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">6</span></span></code></pre></div>
<p>But if the interval is a single point, the value of the function at
that point is returned.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For a single point return the function value</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">trapzMeans</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span></span></code></pre></div>
<p>For a matrix argument, these functions operate column by column</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Average of cos(x), sin(x) from 0 to 2 pi</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">2</span><span class="sc">*</span>pi, <span class="at">by=</span>h)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">cos</span>(x), <span class="fu">sin</span>(x))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">trapzMeans</span>(<span class="at">fs=</span>cs)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">4.218847e-17</span> <span class="sc">-</span><span class="fl">1.241954e-18</span></span></code></pre></div>
</div>
<div id="project" class="section level2">
<h2>project</h2>
<p>The <code>project</code> function projects abundance, biomass and
yield by age class forward over one year when natural and fishing
mortalities are known.</p>
<div id="setup" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral
and the annual scaling</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort,
assuming fishing occurs on days 80 to 119, and define a length based
selectivity</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral
and the annual scaling.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fwy<span class="sc">*</span>ss</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="projection-from-equilibrium" class="section level4">
<h4>Projection from equilibrium</h4>
<p>Project forward one year from an equilibrium age structure.</p>
<p>Compute an intial age structure assuming constant mortalities and
assuming no plus class</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>F<span class="sc">*</span>Fsf)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year with known mortalities</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Examine the final abundance and total yield</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Final abundance</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>N[nsteps<span class="sc">+</span><span class="dv">1</span>,]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span> <span class="fl">0.1794040</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Total annual yield</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2811238</span></span></code></pre></div>
<p>Plot the initial age structure and resulting profiles of abundance,
biomass and yield by age class</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot initial abundance, projected abundance, biomass and yield</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>Ages, <span class="at">y=</span>N0, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>N, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>B, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>Y, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="projection-from-survey" class="section level4">
<h4>Projection from survey</h4>
<p>Project forward one year, matching given average relative abundance
and total biomass over a set of reference time steps obtained from a
survey</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection given relative abundance and total</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="do">## biomass estimated from a five day mid-year survey (days 150 to 154)</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>Nsurvey <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">0.67</span>,<span class="fl">0.46</span>,<span class="fl">0.33</span>,<span class="fl">0.25</span>,<span class="fl">0.18</span>,<span class="fl">0.13</span>) </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>Bsurvey <span class="ot">&lt;-</span> <span class="dv">15000</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>Nsurvey, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">nref=</span><span class="dv">151</span><span class="sc">:</span><span class="dv">155</span>, <span class="at">Bref=</span>Bsurvey, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Examine the total annual yield</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Total annual yield</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1954.908</span></span></code></pre></div>
<p>Plot the initial age structure and resulting profiles of abundance,
biomass and yield by age class</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot initial abundance, projected abundance, biomass and yield</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>],<span class="at">l=</span><span class="dv">65</span>,<span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>Ages, <span class="at">y=</span>pr<span class="sc">$</span>N[<span class="dv">1</span>,], <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>N, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span> ,<span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>B, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>Y, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="multi-year-projection" class="section level4">
<h4>Multi-year projection</h4>
<p>Project forward 10 years from a virgin stock assuming constant
fishing mortality, collating annual abundance, biomass and yield.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance, biomass and yield</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(Years), <span class="at">ncol=</span> <span class="fu">length</span>(Ages))</span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural
mortality and no fishing, assuming no plus class and 8000 recruits per
year.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing and 8000</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="do">## new recruits each year</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span></code></pre></div>
<p>For each year, project forward from the initial abundance assuming
constant fishing mortality, update the the initial abundance for the
next projection assuming 8000 new recruits, and record the final
abundance, biomass and yield from the projection</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project forward with constant fishing mortality</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>Nf)) {</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  Nf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  Bf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  Yf[k,] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age
class</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance, biomass and yield</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="projectc" class="section level2">
<h2>projectC</h2>
<p>The <code>projectC</code> function projects abundance, biomass and
yield by age class forward over one year when natural mortality and
total annual yield are known.</p>
<div id="setup-1" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral
and the annual scaling</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort,
assuming fishing occurs on days 80 to 119, and define a length based
selectivity</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral
and the annual scaling.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fwy<span class="sc">*</span>ss</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="projection-from-equilibrium-1" class="section level4">
<h4>Projection from equilibrium</h4>
<p>Project forward one year from an equilibrium age structure.</p>
<p>Compute an intial age structure assuming constant mortalities and
assuming no plus class</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>F<span class="sc">*</span>Fsf)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year, selecting the annual scaling of
fishing mortality to reproduce the known catch</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">projectC</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">Fs=</span>Fs, <span class="at">fs=</span>fs, <span class="at">Catch=</span><span class="fl">0.2811238</span>, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
<p>This determines the fishing mortality required to reproduce the
target yield</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fishing mortality and total annual yield</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>F</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2811238</span></span></code></pre></div>
<p>Plot the initial age structure and resulting profiles of abundance,
biomass and yield by age class</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot initial abundance, projected abundance, biomass and yield</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>Ages, <span class="at">y=</span>N0, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>N, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>B, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>Y, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="projection-from-survey-1" class="section level4">
<h4>Projection from survey</h4>
<p>Project forward one year, matching given average relative abundance
and total biomass over a set of reference time steps obtained from a
survey</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection given relative abundance and total</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="do">## biomass estimated from a five day mid-year survey (days 150 to 154)</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>Nsurvey <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.67</span>, <span class="fl">0.46</span>, <span class="fl">0.33</span>, <span class="fl">0.25</span>, <span class="fl">0.18</span>, <span class="fl">0.13</span>) </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>Bsurvey <span class="ot">&lt;-</span> <span class="dv">15000</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">projectC</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">Fs=</span>Fs, <span class="at">fs=</span>fs, <span class="at">Catch=</span><span class="fl">1954.908</span>, <span class="at">Nref=</span>Nsurvey, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">nref=</span><span class="dv">151</span><span class="sc">:</span><span class="dv">155</span>, <span class="at">Bref=</span>Bsurvey, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
<p>This determines the fishing mortality required to reproduce the
target yield</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fishing mortality and total annual yield</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>F</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1954.908</span></span></code></pre></div>
<p>Plot the initial age structure and resulting profiles of abundance,
biomass and yield by age class</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot initial abundance, projected abundance, biomass and yield</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>Ages, <span class="at">y=</span>pr<span class="sc">$</span>N[<span class="dv">1</span>,], <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>N, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>B, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>Y, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="unattainable-target" class="section level4">
<h4>Unattainable target</h4>
<p>If the target catch cannot be recovered without exceeding
<code>Fmax</code>, the projection is performed with <code>F</code>
capped at <code>Fmax</code></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Unattainable target catch - F is capped at Fmax</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">projectC</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">Fs=</span>Fs, <span class="at">fs=</span>fs, <span class="at">Catch=</span><span class="dv">2</span>, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">2</span>, <span class="at">Fmax=</span><span class="fl">2.5</span>)</span></code></pre></div>
<p>the yield does not match the target</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Yield does not match target</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.463323</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>F<span class="sc">==</span><span class="fl">2.5</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div id="multi-year-projection-1" class="section level4">
<h4>Multi-year projection</h4>
<p>Project forward 10 years from a virgin stock assuming constant catch,
collating annual abundance, biomass and yield.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance, biomass and yield</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Years), <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural
mortality and no fishing, assuming no plus class and 8000 recruits per
year.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing and 8000</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="do">## new recruits each year</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span></code></pre></div>
<p>For each year, project forward from the initial abundance assuming
constant catch, update the the initial abundance for the next projection
assuming 8000 new recruits, and record the final abundance, biomass and
yield from the projection</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project forward with constant catch</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>Nf)) {</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">projectC</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">Fs=</span>Fs, <span class="at">fs=</span>fs, <span class="at">Catch=</span><span class="dv">4000</span>, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  Nf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  Bf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  Yf[k,] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age
class</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance, biomass and yield</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAh1BMVEUAAAAAAEgAAHQASEgASJwAdL8AtusAwJRIAABIAEhIAHRISEhISHRIdHRInL9InN9TtAB0AAB0AEh0AHR0SAB0SJx0v/+cSACcSEicSHSc39+c3/+liv+/dAC/nEi/35y////EmgDfnEjfv7/f35zf///4dm37Ydf/v3T/35z//7///9////+nEcnUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAX0UlEQVR4nO2d62LbuNGGldRxsj053m3t9rPVbtx1JNu4/+v7CJKSKBEkB3wH4IB6nx9rb8KQ1OjhDAY8bRwhAJuld4CUDQUiEBSIQFAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQFIhAUCACQYEIBAUiEBSIQFAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQFIhAUCACQYEIBAUiEBSIQFAgAkGBCAQFIhAUiEBQIAKBC7QpGoUQXnd8FASC17AgOQRKv4l0UKAJKNA4FGgCCjQOBZqAAo2TUaCfhaH18aXx+TFG+r2YCTPQBEYykFmpKNAERgQKYcIpCjSBYYEC5E9UFGiCsgQKkdYpCjRB+QIFUExUFGiCVQoUYqZOagJtmzMjd/PXYJOEOy8/nZQfsUpaAm1vXpufX+auwShXk4GGmFBJSaD3X5+aX97+/Pu8NVjl6gU6EVSJAk1AgQJ0LFIrYW3pOpSy+DUYJZ9AX9NvKQFqg+gXDqJHETQZRRqUsY03dhJHiJJAgibj+3ULFNPGh+axss/BC9ERSDJGvHVfv6tsLCuW23gTTuUTqDaoOIUK68LyJyqtEiZoMm79KKg0hQoTKERap7R2XtJk1AYVptA623jFRJV1HqgxqCiFrqeNn+lUxjb+KFBJCqVs4y2fLKyR+JSvjX92HYOKUYhn408EVcrYhZ0bVIhCltv45ehYtJxAXiH7Dq2gC0tLxja+b1ABaYgCTZCzjQ8ZZD0NrbONVyTfFYn+Zsbnnz9vf369vMXx+/f8t1VOI43PWtr4mSiOgfbT8QmlII/dNBQh0Mfj5uaPQIVS2IZh9ATa+yT9EjCo3cTO/6c2KHha3qhCcoE+Hu/2N68vgRLleb+/c2/fNptAE0aBaoE+Hh/c+BjxYFAoBXlMpiG5QFUMKoFCAXC1XU1sXlbRxnfIKNCkQRbTUGwGCg2SXZOia3fYhQV5v//8ex2f0QNsoojVWEtDcWOgzWaggn38q63xFGiA9/vNp6dgk9rZhMQgY2lIqwvbf6pztC9lM9dglLx3ZUwXsRpDCqm18dURVvHpaf4abKK08z59+2NrKkN7gyZTkDNUySIEevulGud8Zhs/xL4a5oSPINdMtPr6NVnipQZZSUMxg2jfRQy18dg2DCPe+So+7/cP++Emo1ZMJJCgiNVYSENRbbwLp2B8G4YR77yf5ggL4o7nCvfBmdjzTRwNEt3ls7hCESWsPt010MaD2zBMTAZ6GZ5obc8VvmwCY4CLTciLWM3CCim18eA2DBMxBqoGQH6cGOTjsTVoWqCDQZIiVrNoJUt5SaveGhYkbxtfE1fEapZziAJNsIBAcwxazKEIgfb19Roz+vgrEWi0jY/bxKmIRd0vv4RCEV3Y/QO2jcUbhlnotPGxmzgaFK1Q7iDHtvHQNizMW8Si08aHVz1y29PJoNinvmQOckQJC51Ijt5GcQ4ptfGxmzjNJ8YmIZc3yDElTGkM9L0oiZTa+OhNdFLQDIXyObRQF1aOQ0t0YTVnBs15elmeGC/Xxhfi0GICXRo05/llGUIcMwZSb+NLcEgukHp8zg2aq1DiEEe18f6S1tB9KbI1DNxrYNwheReGxqdHdyBdM+8himlDHNXGv/8W1aZermHg89seVMe08WB8elykoJlJyCUtZVHXA3386wkKUDmXip+IaePR+PToGQQolCjAcVck7sO3Vg79y95E2fil4iYdko+BouMj2ETfoPlPk04T4Mxd2Pint1jMluvCakIGzX+edIL45m7jBVf62nJoYYFCBiEKqcdXKFA7DQ21qe2k6vTyphJRzEx0kqsVGoNuz/8QUUh3SB17LgxpU8UGOUMSxbTxaTYRNAhVSC24WS+qjzHIGZEopo1Ps4l2OujSIEwhNYdi2nj8ovr4U4OLSxQxE61xtUKI0DCoBlNIx6HYi+rnBKmzjdvIJFRj/KLxA+mu2Bw0CFVIIbTZT6bOMcj2ReMtycZAbmgYVIMqhA6pMwr03PyYZ9BixWz5MZBnxKCFFcp5UT1okFskEUWUsNjyHvMk/zGDNBSaHdeMF9VXEWgUAgzK71BECUt618qoQbhCs9NQ1ovqD0kIMihzMVt6JvrIuEEqCs2Jau6L6lUMcqau+c21idqgQYE0FJqThjJeVF9PiKkZlCsRyQVK/uyA3WgKcssolLON3zVzqrVCc+82uCC9RBHXA41OtGq8zWjSoCqguStZ3nmgThK6VVIotUSRbfzQqR6Vtxm1w6BRhXKnoYwlzNMvYxoHTUqJdDKQ0stoDlPSGRSShjM2A21n9PLdNfTLmFP5xG65K+4OjI2BtN5mdHz4VHKFpGkoVqDBs/HiGt8tY8c/VElDSRKRUhem9Tajg0HjQyGdgIqCGSvQfqCERdT4oEFaaUhdIq02XuttRieDJhTKlIaix0DhEhaVonfHB7KfR0EpDTlViWTfrr+nJ+1M9JGjQbkUGo+kUhcWWeNDA6EaNYXUJNLKQHovJT4ZNFXH1DqUkb/UauMja/xAGXOaacipSKQ1BlJ8KXHXoEmFUqchtQvKImv8UBnzqDqESiT8dv27VP7vMXkX1tAxSKZQwjSU95LWLoNlzKPrECKR8Nvd+vftfQlnGKf+UuLd7mSQRKGEA2q1i+rja3x/WvqMrzYkEg+im3dBDM5EK7+UuGtQRoX6EYw9Gz90W8+cGh+cVDxD2aE5EikJpP5S4jODhAqlSENCgaZuLJyZoieSkEfbIf2ThZ5pgUKrjrgisc+5QSKFUqShZdr4I9NJyC3skJZAem38gQuDpAopp6FIgfZDE2Wza3y3HRteKoVDWud6PJO3fmu28QcuDZIppDygjhJoO/L0kvk1/pSERgOgPahWO9cjQbkLa+kZVEUwVxo6xC6mjY+dp5fW+E4dy3CK8IxphywLFDAoZxqqkQr09m1z8/r+27BAUI0/1THB+Z28xczY2fgLQgaJFVIJpLQLq4+gEYHQGi+sYzVZi5m1s/EXVIde3yChQippSJqBqgI2loHwFH12biPT9HyXIYe0BBoB20TQIOFgSCGMEYPo7cgYSKPG1wo9C69UcAkSUdAh8wJ5g0IKZXIoqgsbeYakSo0/JaGIfiLx+Q77AtUDoaBC8lI2P4iR80Bv34aSkEqN7yahmENIW6LO/yl1YWPzRPAmmqghaWh+ELWuB9Jaw7lC0kNIW6LvMRNlMgZO0+tsojuh30Pq0LxEpCWQnyXy2Qef5+gpJPz46pcRNT+1BPp4HJyD1djEQSGolM2JoeYViX78ozFRtuteMOUiHVJuzkoYAzXs2jPTYBqKdUj1ZOrAKx9nXjB1fq5Z+vm1JSpGoI5COR3SPRu/v/lDaaq+p5D//EtIVJBAh8tjBtNQilyuWcKc78XUuoyzyzZbIhzSkqgogQ5JaDgNxRyHogDqDaJbgxTb1F1oiizGoVoi0KKyBOooNOyQajGz1safE1Qoqpg51KKEAmFXJA5yUkjLobHo2RZoSKFoiVJOlMGob6KjkHcoaTGzLlCr0NAsa/pUVKJA5wqlLWb2BfLRqB0atihmZbEWlSnQpULjDiEz1SUI5BqH3KBFsakoxqJSBTrE7MSwQ3KJ+nErRCB3iseoRfoVrVyBXNAhFYk6/1eOQO6iRR0ZF2k2+kUL5GqH9CXqxKwogS4OqUGLWo2iJq6HLCpdIM+lQxoSHQJWmECuF42pWMQMEecNEmEybKLv0HTgZCsuTyAXLu2DwYgqa3MGiTA5BHJNMQtkotH2bDpqRQrkQtEYDYaL0Og8Fa1HoJpdpEaTQStVoJpANGQaiW4dan5ZmUANu7jIjYWsaIEaBoMx4tFRpEmVVilQS8CjkciFw7UCgRp2w9EYE2lSpTUL1BKVji5DtRqBDux2fZWen+erdAUCNUQl8lOQVifQid059Z89nzH4T29jAgRjQ6CG6ESuJpD+A5SU2fV5DnD5z65MoAPiRK52SWuCByglJ+DU7jJKaveFWT/AhhhM5M1f615Uf35fWKIr7tJyeegp7XyRB1iI+PjMFyhqDVbR2fn1HGCXKN+Vof0ApeVJKJDuJhZCbRCd6AFKi6NVwq73AFNo44sG/vgNYwdY0Ux//UoRBNZtebGkWP7g4vhQoOWw/MEpkM5iSbH8wSmQzmJJsfzBKZDOYkmx/MEpkM5iSbH8wSmQzmJJsfzBKZDOYkmx/MFNCESuAApEICgQgaBABIICEQgKRCAoEIGgQASCAhEICkQgKBCBSCbQ27fN5kG0YOBOhh6HF5ZNb/TTk2yL1RoH3xGbg7XEJ5VA7/cPbi/YWee2kv3c3ry+/TK5Nr/R0Os8Lpfyi2y/jL1mMDmriU8qgfY3r5XEgkNs/yfBEXa88Wocf+hMLvqy+Vu7mOjYTsRq4pNyDOSFn+Lj3/8V7Kbwq/bfyD5wa9YZ/3v1axPFMjGriE9KgV6m9tUvcyf58Pub/4hGDFXhFmzTikCriE9CgaarbXUQ/vNVFKBqhCgYMbzf30m2akSgdcQnnUAvkiHi9kGUfoUjBuGntiHQSuKTTCDJ8VUdEvX9s6JPrhugpQfRq4lPKoEETeVhSclubu/8S6OnlvJvbxem6KXb+NXEJ5VAW9mh4yImygQri5goqw7uJScSVxMfnsogEBSIQFAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQFIhAUCACQYEIBAUiEBSIQFAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQFIhAmBPo47G+e9vfhUsCWIuPOYHa0EgePHCdGIuPPYHqWyzlN25eH7biY1Agt/3i78E93hy532w2X9zbX/+x6CPpDGEqPhYFer//i0/Q/mkBVaZuHwb39k30RMFrwFR8LArUPuqm8yyJ6oedpL08luJjUqDmeQL+Oab+WQD+Z3WELfksFmNYio9lgZqQ+EPLH2EU6Iil+BgWyNf46jffdGyZgbpYio9hgXyXUWVo/+ibvz8+UKATluJjUiBSDhSIQFAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQFIhAUCACQYEIBAUiEBSIQFAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQFIhAUCACQYEIBAUiEBSIQFAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQFIhAUCACQYEIBAUiEBSIQFAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQFIhAUCACQYEIBAUiEBSIQFAgAkGBCAQFIhC4QJuiUQjhdaMgkMJeLEbRO28CCkQgKBCBoEAE4koF+v69+VnkzpviKgU66FPkzhvjCgU66VPgzpvj6gTq6lPczhvkygQ616ewnTfJVQl0qU9RO2+UKxKor09BO2+WqxEopE8xO2+YKxEorE8hO2+aaxDo+5A+Jey8ddYv0LA9zv7O22flAo0knxrTO18EqxZowh5neucLYX4ErV/UN5V8aqzufDmsNQNJ7HFWd74kVimQKPnUGNz5wlihQGJ7nMGdL461CSRPPjW2dr5E1iVQnD3O1s6XyZoEitbH0s6XynoEmqGPnZ0vl7UINEsfKztfMusQaKY+Nna+bNYg0Gx9LOx86ZQvEKDP8jtfPqULBOmz9M6vAWEEt81507v5a0hB5KxhAAqEIovg9ua1+fll7hoSANvjKBCOKILvvz41v7z9+fd5a1AHTz41FAilTIF07HEUCEdYwtrSdShl8WtQRCn51FAgFGEEX8wMohXtcRQIp6w2XjP51FAglJLaeG17HAXCKaaNV08+NRQIpYwuLI09jgLhlCBQKnscBcIx38YnSz41FAjFdhuf1h5HgXAs35ma2h5HgXDkY6B93gyUPPnUUCAUsUB7Pwx6CRiU4jvIY4+jQDhSgT4eH1yuLiyXPY4C4dgTKKM+FAhHJtD9599f6hKWfCY6qz4UCKeO4Pv9oaP63M8wrl3i01NwGkjzO8g29DlCgVCOEayTyzbUZknXgJLdHkeBcA4RbM5WhMY40jWALKEPBcI5RPDjsc5AoRolXAPEMvpQIJxjBD8eqyFQYIzsGR0jKXwHS+lDgXCkF5QNqCVfwyD5R84dKBCKMIIfj4PDa+w7WNIeR4FwhG381BpmsrA+FAhnyYvqF9eHAuEsJ5ABfSgQTrcLu/ljxjTQzO/AhD4UCOc0D3S3v3l9yTQPZEQfCoTTmYmuBMozE21GHwqEc56BcsxEG9KHAuGcz0TP8CfuO1h01jAABULJ2oUZs8dRIJyMAtnThwLhNDPRvz61k9HpZqIt6kOBcDJlIJv6UCCcLDcWWtWHAuE0Jey3GTPQZ2sYw64+FAinieB2VgPfXcMg0fp8nUWanSeTHCL4Mluh0e9ArA+qwkydKBDK+USichcm0QfLIOMrnV4vBUJpI+jPxWtnoEl9EpgT3sbwdigQSh1BQJ+h72DqnEUGd/ob7G+SAqGk6cJG7cmReEa33dk4BUJJMJE4knyWdOdiN5rfKBCKmkDtlzJojxF3LqBAKGoC3XrClth0p4YCoagJ9Oy5PdIKY9idGgqEoiZQXbqej5xpZBcKhJLqbPxJI3gDKaFAKGoC7TyXf2deIgqEopuBdkdOf2ZaIgqEkqqEnXtkViIKhCJ9vMvMVx10LDrv0oJE7rsCFAhFFkHsfWEni7xEIwvm14kCocge86vwuqejReMOdcihEQVCySZQTSuRVCFPWo0oEIqwhCm+L6x2SJyGWlJVNQqEIoyg7vvC2jQU55BHXSMKhLLQA6biS1kHxXREgVASt/EjzCplXTQ8okAoOdr4QQ6lDLAILGsUCGV+F6byysvuBNESGlEglLxtfIjOibNn1KPoqkaBUPK38QEuzuNnTEcUCGWRNj5A/1oQ1CJROqJAKAu18SH6lxNNnjyTMKoRBUKRj4EyvPY7cEmaU0hFngGLKBCKWKBMr/0OO6QwLvL0JaJAKFKBMr72e8ghp6LReSqiQCgGBXLHs/YDwN2+OzpEgVBkAuV77feJ4FX6XeZ79KOi+Y0CoQgjmOe1332mJHKRZe3Hj5M8HgqEYqiNH2IyFXkmNbpUp4ECoRQgUM3lzUJh+lXtx4HwP6BAKKUI1CDTqPVoxJsjFAilLIEaevcuuk6mOWkjGWRTIJQSBar58aP1aKxCeUY9okAohQn0oz+miSprl39KgVDMCxSoTSFmakSBUEwJ9CNA1Ar6j3YIcpKIAqEsJxAqyxihp4QEoUAoeQSCU8tsJlSiQCgJBFpMlnGCKlEgFDWBbNkySsciCoRiahCdn6J33gTL3ZlqgqJ33gSL3pm6PEXvvAnU7kz9WRgRH5+MsPydqYtS9M6bwMSdqctR9M6bwMqdqQtR9M6bQKGNLxqFEF43KSMoXLflxcgUFIhAUCACQYEIBAUiEBSIQFAgAkGBCAQDSSAoEIGgQASCAhEICkQgKBCBoEAEggIRCApEICgQgaBABCKZQG/fNpsH0YKBW4V6fDyGr+jvb/TTk2yL1Ro/CzZMJkgl0Pv9g9sLvkzntpLvcXvz+vbL5Nr8Rl8mV+efu1/fqRS6z5ZEkkqg/c2ra96vMbXgnwQZ6Hhn4zg+tUwu+rL5W7uYKPeRcVKOgXxCmOLj3/8VfI3Cr9obuw+9jqHL/1792kSukWlSCvQy9V36Ze4kcuxv/iMaUVUDG8E2KZAiCQWaHo1USeqfryKBqhG0YET1fn8n2SoFUiSdQC+SIfT2QVSehCMqoRUUSJFkAknyj3+LlEdkhq5AHEQrkUogQdN9WFLyNW6rEjZt5MejuISxjVcilUBbWWpxEROJgpVFTCRWyY8TiQrwVAaBoEAEggIRCApEICgQgaBABIICEQgKRCAoEIGgQASCAhEICkQgKBCBoEAEggIRCApEICgQgaBABIICEQgKRCAoEIGgQATCnEAfj/Xd7f4uZVIA5gRq1ZE8mIEYwJ5A9S2o8htbybIYFMhtv/h7lI83j+43m80X9/bXf/BOUoNYFOj9/i++gPmnKVSVrH1Y3ts30RMXSWYsCtQ+CqjzrI3qB4uaTUwK1DxvwT/n1T8rwf+sMhCfxWISywI1yvjU4zMQBTKJYYH8GKj6zTdlW2YgqxgWyHdhVQXzjwb6++MDBbKJSYFIOVAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQFIhAUCACQYEIBAUiEBSIQFAgAkGBCAQFIhAUiEBQIAJBgQgEBSIQ/w/USwsw3xdJ9AAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
</div>
<div id="advance" class="section level2">
<h2>advance</h2>
<p>The <code>advance</code> function constructs the initial abundance
for the next annual projection given the projected abundances for the
current year. Essentially, <code>advance</code> advances the final
abundance of each cohort by an age class filling the first age class
with recruits. If the last age class is a plus class, the surviving
individuals of the plus class are retained when the classes advance,
otherwise these individuals are lost to the population.</p>
<div id="setup-2" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">1</span>,<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the
annual scaling</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Define the intra-annual fishing mortality, its integral and the
annual scaling, assuming fishing occurs on days 80 to 119 and there is
length based selectivity</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define fishing mortalities - mid-year fishing with length based selectivity </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>fs[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fs<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fs<span class="sc">*</span><span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>Compute an intial age structure assuming constant mortalities</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>F<span class="sc">*</span>Fsf)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year with known mortalities</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0)</span></code></pre></div>
<p>The projected final abundance is</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Final abundance</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>N[nsteps<span class="sc">+</span><span class="dv">1</span>,]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span> <span class="fl">0.1794040</span></span></code></pre></div>
</div>
<div id="advance-1" class="section level4">
<h4>Advance</h4>
<p>Advance the final cohort numbers by one age class to form the initial
numbers for the next projection. If the final age class is not a plus
group individuals in the final age class are discarded in the
advancement</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial abundance for next projection assuming no plus group</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">1</span>, <span class="at">plus=</span><span class="cn">FALSE</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>If the final age class is a plus group the individuals in the final
age class are retained</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial abundance for next projection assuming plus group</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">1</span>, <span class="at">plus=</span><span class="cn">TRUE</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.4215740</span></span></code></pre></div>
</div>
<div id="project-without-plus-class" class="section level4">
<h4>Project without plus class</h4>
<p>Project forward 10 years from a virgin stock assuming constant
fishing mortality, collating annual abundance, biomass and yield,
assuming the final class is not a plus class.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance, biomass and yield</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Years), <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages)) <span class="co">#produce identical matrices Nf, Bf and Yf</span></span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural
mortality and no fishing, assuming no plus class and 8000 recruits per
year.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing and 8000</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="do">## new recruits each year</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span></code></pre></div>
<p>For each year, project forward from the initial abundance assuming
constant fishing mortality, update the the initial abundance for the
next projection assuming 8000 new recruits, and record the final
abundance, biomass and yield from the projection</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project forward with constant fishing mortality</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>Nf)) {</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  Nf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  Bf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  Yf[k,] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age
class</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance, biomass and yield</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="project-with-plus-class" class="section level4">
<h4>Project with plus class</h4>
<p>Project forward 10 years from a virgin stock assuming constant
fishing mortality, collating annual abundance, biomass and yield,
assuming the final class is a plus class.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance, biomass and yield</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Years), <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural
mortality and no fishing with 8000 recruits per year. Treat the last
class as a plus group assuming an additional 50 age classes are
aggregated into the plus class</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing, 8000</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="do">## new recruits each year and a plus class</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>, <span class="at">plus=</span><span class="dv">50</span>)</span></code></pre></div>
<p>For each year, project forward from the initial abundance assuming
constant fishing mortality, update the the initial abundance for the
next projection assuming 8000 new recruits and assuming the last class
is a plus class, and record the final abundance, biomass and yield from
the projection</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project forward with constant fishing mortality assuming plus class</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>Nf)) {</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>, <span class="at">plus=</span><span class="cn">TRUE</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  Nf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  Bf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  Yf[k,] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age
class</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance, biomass and yield</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="rescaleprojection" class="section level2">
<h2>rescaleProjection</h2>
<p>The <code>rescaleProjection</code> function rescales an existing
projection to reproduce a prescribed reference abundance or biomass.</p>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral
and the annual scaling</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort,
assuming fishing occurs on days 80 to 119, and define a length based
selectivity</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral
and the annual scaling.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fwy<span class="sc">*</span>ss</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>Project forward 10 years from a virgin stock assuming constant
fishing mortality, collating annual abundance, biomass and yield.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance,  biomass and yield</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Years), <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural
mortality and no fishing, assuming no plus class and 8000 recruits per
year.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span></code></pre></div>
<p>For the first year, project forward from the initial abundance
assuming constant fishing mortality, update the the initial abundance
for the next projection assuming 8000 new recruits, and record the final
abundance, biomass and yield from the projection</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project first year</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>Nf[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>Bf[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>Yf[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span></code></pre></div>
<p>As the mortalities are constant from year to year, the projections
for the subsequent years can be computed by rescaling the initial
projection</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute projections for subsequent years by rescaling</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(Nf)) {</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">rescaleProjection</span>(<span class="at">pr=</span>pr, <span class="at">Nref=</span>N0)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  Nf[k, ] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  Bf[k, ] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  Yf[k, ] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age
class</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance,  biomass and yield</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAh1BMVEUAAAAAAEgAAHQASEgASJwAdL8AtusAwJRIAABIAEhIAHRISEhISHRIdHRInL9InN9TtAB0AAB0AEh0AHR0SAB0SJx0v/+cSACcSEicSHSc39+c3/+liv+/dAC/nEi/35y////EmgDfnEjfv7/f35zf///4dm37Ydf/v3T/35z//7///9////+nEcnUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATlUlEQVR4nO2d62LjthFGtVvf0rS1nbR2Uq+ajRJHss33f74SulmSKWKgDyAH1jk/bLfLEOToEMCAADRpAAQmY18A1A0CgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgYQu0KRqMoTwvOOTQSD5DCMyhEDliygHAkVAoH4QKAIC9YNAERConwEF+qsyct2+NT6/V4Y1PtRAn6CIciBQBATqB4EiIFA/JQWyjzU5BoH6oQaKgED9IFAEBOoHgSIgUD8IFAGB+kGgCAjUDwJFGE6g6/IlFSCbQNNVxn57+hl8UvDiD4c5qjQol0DTi+fV78tTz+CUAZuwcxbo9aen1R8vf/9+2hm8MpxAd3fXd+ULyw0CRRi0E319t6R8kfnI1oStm65NU5Z+BqcMJ9DVthGrSaNsnehZtBM99vyVVJJuX2FTxNV+N+jOOdb4kMYPVcRVjf1o0vgIQ/aBajSIND7CoJ3oCg0iC4uAQP0gUIRh34XVZxBpfISBX6ZWZ9CAaXydIFA/zImOMJxA35Y/azOIND7CgDXQxqCzFIg0PoLhAauyCkoQ6O1xcvFnR5IVIAuLYHrAajTILtDb4+3i4nnWkWU1CBTDGJ8KGzG7QG0MWoG6AhAgje8lUaCKDEqtgboEWUIa34vxAavPoLQ+0GRyzB+tDMfkunjjA7Y06JMK1Mvr/W3zcjOZdPQRESihiOqqoEwCte3bqnmfkcZ3Yx0nq82gBIFefnhqZl+Pp/FLd844C1t8/T6bfHnq/kf7OFlljVhKJ/qh/XkkjX/75alZnLdAbXxe7x8Wpw9zzFe/KquCktL4pjsAgcWXp2BYaMpOKMMx5osPwxxfvx+JjymNPzDoswm0qn2PpvGv96GJ76zBz0Og9vmZHR1oNaXxa4HqasRI4yMk9IHaxyf0E7uxpPE1NmKsyohQ8OI/TnepsBFDoAgZX2Us+mugsDf1fLVF9bfw4+qvv65bRtsnO4Y1PtsjFsun5UgebzpDjeRJ44NAyyx11p9kHHaDWq6XmK9iaBKysPuHYmU4JlsavxoGiQ1zHHaDNlx79Sg1jS9ThmOypfE2gfYMuvpw6LUjrPHZHtH1lqL/vzyrOdG9afzrfdu+LZuw6Eh0v0HuSGnC6AP10p/Gt+Fr+0edw2jHBarAILKwCAO/jW9qM2hAgXb2BKmITAKFUdiQgFneFVbViKX0gXI0YYfby7jHLlBvfMKrjNB+pQrk3qCkND5Mae0aCTupjJG2RbJjDZAlPqsU9kiW9qGImgxKSuNffz6WpoplOCYljT8en/UYyKJzXdTHIioyKGk+0NsvT0cFOvuVqf3xWb+Nn3U1cR1FrAxaCeTboLQZiYtuQxpWpjaR+Lw9rg1KEaiGKihTFsbCwsxFVGMQAkUYSaBqDDIKtB6G7k9Tl7/Pd2Vq5tkKlRiU+i7saBp/9itTc89W2BPIr0Gpb+OFNN7hXAQDKWl83iLqqIJS0vjeSfWGNL5KgxJGolNnK8SKqMKg1En1x4JkSuM9ToiKMVofqKnDoIGzsPoMGq0P1BxMcHVq0NBpfHUGjdcHaqowKEGg3iranMbXZlBCE5a7D9R0TrJ3RtLb+L7DzGl8ZR2hhCasxIxN9walpvFJ5z4yJ7oqg8Yaid7gvSOdbVJ9PI1/v/uaDBpbIO8G5ZpUb0njr7a3X1EzZheo1N4Bvg0aNgursBJKmA/UO9DadWrbsiff3aCB0/j6DEpM40vM2HRtULYmzJjG7zRj5msclYI1kLmIfYMCyWUUI7UGmh7L5c1pfGUdofH7QM3hgGKztsiFSqkCZaii62rGRs/ClnwwaMvVaFgvfv+IRe9AWffK8MnBze9mY9fe6yEfAh3MDnJEch+ouwnrnbG4OcO3d4V2//lwvwdf2AQKa3rK7h3g1aBMWVjzchN6P701ULNbCXWeZKR9So6QcvsStiKcGpRLoNWClZhA75XQ+L0/I24EcmpQrgllTWjGLqMCRSshdxg/3bB7y38fy+5i69KgbFNaA4vu+O2X8V4JWa5vdIyf7jR818xl96ucTEX4NGjASfVbqmrGzJ3o1XdBFN074HgyPx6pb+OF3Tnm2/+jpmbMk0AeDTIKFF1YaCljvlWoor60K4EcGpQvC7OcoasScq6QL4H8GZQo0EIcKOuohJy3Y0aBojV0ru1vvBmUJND06O4l9jJ2FNr84boSyjQOlG/7G2cGpaTxqR2gIxOmuiohvwrlESjn7iW+DLIK9HIzuXh+/Tm9/eooo6MS8tuO+RPIl0HWLGwZgEwCVVUJ5WrCcm5/48kgaw3UNmDZaqDmSGfapUK53oVl3f5m7mdMOqETPT1pEOhYGbXkY35epu7hxqCkLOz4HpKnlLEzKOR4XDGXQLl3sfViUOI40MtNxglT8xrGFd2l8RucGJRtJPqkJ6yjEnI0X3yJwyxsjQ+Dcgl04hM271Jow3jzxXf89SuQD4MyCXR6gHoVcoDHNH6DB4NGF8i7Qi7T+A0bg7acfKaTydaEKU+YZ4UKpvHGtfF9zA/+97cBWd9E/DZtt6I9YX4VytgHinxv/EnMDxUammHnA/XgVaF8Alm+N/4ERjZo3DR+D58KZRPI+LXf6Yxr0Mhp/D4eFfIv0LgGOcjCdvGnUCaB7N8bfwJjGuRMoKBQx1vWEcmVhZm/N/4URuxKu0jjD3ClkNO38YeMZpCTNP4ARwpVItBoBpVM45WBsveWbGSFahForGbMURp/yI5CrofqLZj2T1IZxSBXafwh8w9Plcehehs9uy5kq+TGqITcZWEHVDBUb+Pt8ehkzoyt5PDR8i7Q6ApV0wdaMXi0PKbxh3xsyQakMoEGr4R8pvEfGM+h6gQa2CA3b+OjzMeRqD6Bhm3GcgkUVs6H2qfEy8J3RnCoQoEGrYRy9oFC/6esQM3wDlUp0ICVUNYsbPH1e3GBmoEbszoFWgVpiCjlTeMXF38OIFBg/k6Bs+9Qq0BLBghS5jR+VnKo/gjzQgxy8QMVUSJI1ou3dqLXBg0vUFk+iUDFqCeNHwkE6geBIiBQP4MIVDXy7Z97fEpG0Hhuz4cVxfONm+ODQOPh+cYRKM9hRfF84wiU57CieL5xBMpzWFE83zgC5TmsKJ5vHIHyHFYUzzeOQHkOK4rnG3chEJwBCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSxQR6uZlMHkwHdixW/MBmcX680C9PthLbM572HbGZ+CzxKSXQ6/1DszBcbNNMLdc5vXh++SF6tlBo19K1w6PCIdPLvn3pivNp4lNKoMXFc7Pa/j924N8MT9h2i7R+wqMTPXQ2+ef6MNOzXYhPE5+SfaAgfIy3X38zXKbxow6fyKJrt/hd/ngOZzPFsjCfIj4lBZrFrjUcc2u5+cXF/0w9hrbhNpTpRaBPEZ+CAsVb2/Yh/M+zKUBtD9HQY3i9v7WU6kSgzxGfcgLNLF3E6YOp+jX2GIx37UOgTxKfYgJZnq/NFu+mO88boLE70Z8mPqUEMiSVmyMtlzm9DRukxY4K230bq+ix0/hPE59SAk1tj06TMFBmOFnCQFn7cI85kPhp4sOrDJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBwJ9Db43L1dliFCx14i487gdahsWw8cJ44i48/gZZLLO0LN88PX/FxKFAzvQxrcLeLIxeTyeSyefnHv0fdks4RruLjUaDX+x9DBR12C2hr6vVmcC83ph0FzwFX8fEo0Hqrm529JNpffirt8fEUH5cCrfYTCPuYhr0Awu/2CRtzLxZneIqPZ4FWIQmPVnjCEGiLp/g4Fii08e1fIemYUgPt4ik+jgUKWUZbQ4etb/71+IBA73iKj0uBoB4QCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCR0gSZVkyGE500GgTJcxWhUffEuQCCQQCCQQCCQyCbQlXyiMUAglXw1UJUGIZCKMYLTVdJ723eGGg1CIBVbBKcXz6vfl31nqNAgBFIxRfD1p6fVHy9//953hvoMQiCVbAJ9Cz+qMwiBVIxN2Lrp2jRlXWcIBiHQ2WGM4Czaib67+3Z3V51BCKSScyDxW2vR1d0K+bTDgEAqGdP4vVbszjtJtw9HyZnGV9gPQiCV07Owzik1tRmEQCrZ0vj56ldlBiGQSr40vkqDEEglWxpfp0EIpJIzjV8ZVNWQNAKp2CL4en/bvNxMJh1J2O4Z3g1CoHPBFMG3x9tV/3kWSeOrMwiBVMxZ2NKdyNv4+gxCIBVbDfTLU7MwCVSbQQikYovg4svT2+PDsimLnaEugxBIxRjB1/uQxX95Mpxhx6DrDcoVFgWBVAos6+mog679kev2z50S68IqasUQSKXIwsIdg5wrhEAqZVamVjMmjUAqhZY212IQAqmUWhu/Nsh7RwiBVIptrlDHu3kEUjk9grFNvqowCIFUCm7vsmuQV4UQSKXk/kAbgxxXQgikUnSDqbVBjpsxBFIpu0PZ3HtHCIFUSm9x59wgBFIpvkfiTkfIYVcagVTKb7LpuhlDIJWsa+OP4NggBFLJuzb+CHsjQleeWjIEUsm6xd1R5juvxpq1RS5UQiCVYQTaq4R2uRqNlIuH4+RbGx/hiEEjg0AqGdfGRzhoxnyAQCrl0/h3HFZCCKQyRBq/xZ9BCKSyjOBq1Vfg68dOckBM47e4a8YQSGUbweXa92lXFZOyxV0UZ5UQAqlsIrhypCtNb7Kk8VvmO/PtxweBVDYRfHtc1kAdaXogQxr/jqdmDIFUthF8e5x0byC1JEMa/46jSgiBVIZM499xYxACqaREcNbZwJ30GawqofGbMQRSMaXxvf9+4mfgoxJCIBVbBF9uQu8nYw3UODEIgVSsEZy1dU9egVw0YwikspuFXfzZPQy05PX+MrNA7wn9htPPdCoIpPI+DnS7uHjuVmTNYpJboO186TXfBkS/eAjsjES3Ah0ZiTad4TTm8UNKgkAq+zXQsZFoyxlOZD6qQgiksj8SfYI/+mcwpkEIpDLOSPQ+I1ZCCKTiQaARFUIgldVI9E9P68HmIxPKomeQGUkhBFIpt0NZKqMohEAqPpqwFSMohEAqqybs5/SWa/8MmRhcIQRSWUVwelICv3uGXAysEAKpbCI4O1mh3J/BoAohkMr+QOJ4WdguAyqEQCrrCIZ38U5qoMD8nQJn3wGBVJYRFPQp/hnMCzHIxZ8BvrKwwan64l0w6Np4f1R98S4YZIs7v1R98S4Yaocyp1R98S5AIJAYbIs7n1R98S4Ybos7l1R98S7w9DZ+BKq+eBeQxoMEaTxInJ6F5Z6ROApVX7wLSONBgjQeJEjjQYI0HiRsEQzTFUPtQx8IDrD3gUL/B4HggIQsbPH1OwLBASlp/KJzC7OqP4OqL94FSWn8LOMurT6o+uJdYO1Erw1CINiHNB4kEAgkEAgkEAgkEAgkEAgk/GxxNwpVX7wLqIFAAoFAAoFAAoFAAoFAAoFAAoFAIptAv1dGrts/d6iBQAKBQAKBQAKBQAKBQAKBQAKBQIIt7kCCLe5AItsWd39VRsLtQw9scQcSbHEHEmxxBxIZ0viqyRDC86ZkBI3n9nwYxEAgkEAgkEAgkEAgkEAgkEAgkEAgkCCQIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIFFMoJebyeTBdGDHUqEPbL42Ol7olydbie0ZO749D1IpJdDr/UOzMHyYTTO1fI7Ti+eXH6JnC4V2fani4VHhkOll5zpbSKSUQIuL5/YhN1RBi78ZaqDtysZ+QtUSPXQ2+ef6MFPdB/2U7AOFCiHG26+/GT5G40cdjF10rH3c44/ncDaTaxCnpECz2GcZjrm1yLG4+J+pR9V2bAxlIlBGCgoU7420ldR/nk0CtT1oQ4/q9f7WUioCZaScQDNLF3r6YGqejD0qoxUIlJFiAlnqn7bKWK4vNpmRVyA60ZkoJZAh6d4cafkYp20TFjfy7dHchJHGZ6KUQFNb1dIkDCQaTpYwkNhWfgwkZoBXGSCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCDhTqC3x+Xq9rBKGSrAnUBrdSwbM4AD/Am0XIJqX9gK4+JQoGZ6GdYobxePLiaTyWXz8o9/s5LUIR4Fer3/MTRgYTeFtiVbb5b3cmPacREGxqNA662AdvbaaH/RqPnEpUCr/RbCPq9hr4Twu62B2IvFJZ4FWikTqp5QAyGQSxwLFPpA7V8hKZtSA3nFsUAhC2tbsLA10L8eHxDIJy4FgnpAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJD4P3u39+9e/+LRAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="agestructured" class="section level2">
<h2>ageStructureD</h2>
<p>The <code>ageStructureD</code> function computes the equilibrium age
structure of the population assuming the recruitment and the annual
scalings of natural and fishing mortality are constant</p>
<div id="setup-3" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the
annual scaling</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(Ages))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="age-structure" class="section level4">
<h4>Age structure</h4>
<p>Compute and initial age structure assuming no fishing and no plus
group</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing and no plus</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="do">## group</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span></span></code></pre></div>
<p>Projecting forward with the same mortality used to compute the
equilibrium age structure should leave the abundances stable</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms,<span class="at">Nref=</span>N0)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial and final abundance</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>N[<span class="fu">c</span>(<span class="dv">1</span>,nsteps<span class="sc">+</span><span class="dv">1</span>),]</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>          [,<span class="dv">1</span>]      [,<span class="dv">2</span>]      [,<span class="dv">3</span>]      [,<span class="dv">4</span>]      [,<span class="dv">5</span>]      [,<span class="dv">6</span>]      [,<span class="dv">7</span>]</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,] <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span> <span class="fl">0.2465970</span></span></code></pre></div>
<p>The deterministic age structure should match the stochastic age
structure for constant recruitment and mortalities. If the last class is
not a plus class</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure with no plus class</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Stochastic initial age structure with constant recruitment</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span></span></code></pre></div>
<p>If the last class is a plus class aggregrating 50 additional age
classes</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming the plus class</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="do">## aggregates 50 additional age classes</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">plus=</span><span class="dv">20</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">1.6366683</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Stochastic initial age structure with constant recruitment with</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="do">## plus class</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">7</span><span class="sc">+</span><span class="dv">20</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M, <span class="at">plus=</span><span class="cn">TRUE</span>)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">1.6366683</span></span></code></pre></div>
<p>For the deterministic computation, the plus class can contain an
infinite number of additional age classes</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no upper limit on age</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">plus=</span><span class="cn">Inf</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">1.6615847</span></span></code></pre></div>
</div>
<div id="scaling" class="section level4">
<h4>Scaling</h4>
<p>By default the scaling of the abundances are determined by the level
of recruitment</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scale to recruitment</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">8000.000</span> <span class="fl">6549.846</span> <span class="fl">5362.560</span> <span class="fl">4390.493</span> <span class="fl">3594.632</span> <span class="fl">2943.036</span> <span class="fl">2409.554</span></span></code></pre></div>
<p>Alternately, the age structure can used as a relative abundances and
scaled to a mid-year survey biomass with <code>project</code></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scale age structure to biomass estimated from a five day mid-year</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="do">## survey (days 150 to 154)</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>Bsurvey <span class="ot">&lt;-</span> <span class="dv">15000</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span><span class="dv">0</span>, <span class="at">Ffs=</span><span class="dv">0</span>, <span class="at">Nref=</span>N0, <span class="at">nref=</span><span class="dv">1</span>, <span class="at">Bref=</span>Bsurvey, <span class="at">bref=</span><span class="dv">151</span><span class="sc">:</span><span class="dv">155</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">initial</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">7627.544</span> <span class="fl">6244.904</span> <span class="fl">5112.895</span> <span class="fl">4186.085</span> <span class="fl">3427.276</span> <span class="fl">2806.016</span> <span class="fl">2297.372</span></span></code></pre></div>
</div>
</div>
<div id="agestructures" class="section level2">
<h2>ageStructureS</h2>
<p>The <code>ageStructureS</code> function computes a stochastic initial
age structure of the population assuming both the recruitment and the
annual scalings of natural and fishing mortalities may vary
inter-annually.</p>
<div id="setup-4" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the
annual scaling</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(Ages))</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="log-normal-recruitment" class="section level4">
<h4>Log Normal Recruitment</h4>
<p>Compute an initial age structure assuming numbers of recruits are log
Normally distributed. Recruitment must be simulated for at least as many
years as there are age classes with non neglible abundance in the
population (including age classes aggregated into the plus group).</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Stochastic initial age structure with log Normal recruitment</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>), <span class="at">sdlog=</span><span class="fl">0.2</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">10.179796</span>  <span class="fl">7.396523</span>  <span class="fl">5.306573</span>  <span class="fl">5.208238</span>  <span class="fl">4.339462</span>  <span class="fl">2.497055</span>  <span class="fl">3.318796</span></span></code></pre></div>
<p>Compare 100 stochastic structures based on log Normal recruitment to
the corresponding deterministic age structure</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot 100 replicates</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>Rs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">100</span>, </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">expr=</span><span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>), <span class="at">sdlog=</span><span class="fl">0.2</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M))</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Rs,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="fu">exp</span>(<span class="at">x=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>)<span class="sc">+</span><span class="fl">0.1</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)), <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be more efficient to base each simulated profile on the
previous but simulate forward fewer years.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>Rs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Ages), <span class="at">ncol=</span><span class="dv">100</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>Rs[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>), <span class="at">sdlog=</span><span class="fl">0.2</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(<span class="at">x=</span>Rs))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  Rs[,k] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>), <span class="at">sdlog=</span><span class="fl">0.2</span>),<span class="at">Msf=</span>Msf, <span class="at">M=</span>M, <span class="at">N0=</span>Rs[,k<span class="dv">-1</span>])</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Rs, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="fu">exp</span>(<span class="at">x=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>)<span class="sc">+</span><span class="fl">0.1</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)), <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="stock-summary" class="section level2">
<h2>Stock Summary</h2>
<p>The <code>spawningStock</code> function extracts the spawning stock
abundance or biomass from a projection, while
<code>vulnerableStock</code> and <code>vulnerableStockGYM</code>
extracts abundance or biomass vulnerable to fishing from a
projection.</p>
<div id="setup-5" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral
and the annual scaling</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort,
assuming fishing occurs on days 80 to 119, and define a length based
selectivity</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral
and the annual scaling.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fwy<span class="sc">*</span>ss</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>Compute an intial age structure assuming constant mortalities and
assuming no plus class</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>F<span class="sc">*</span>Fsf)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year with known mortalities</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="initial-and-final" class="section level4">
<h4>Initial and Final</h4>
<p>Extract the initial and final abundances in each age class</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial abundance</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">initial</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Final abundance</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span> <span class="fl">0.1794040</span></span></code></pre></div>
</div>
<div id="mean-stock" class="section level4">
<h4>Mean Stock</h4>
<p>The mean total abundance and biomass from day 100 to 150 (time steps
101 to 150)</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>monitor <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">150</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean total abundance in the monitoring period</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">meanStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>N, <span class="at">period=</span>monitor)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">4.025763</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean total biomass in the monitoring period</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">meanStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">period=</span>monitor)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.989678</span></span></code></pre></div>
</div>
<div id="spawning-stock" class="section level4">
<h4>Spawning Stock</h4>
<p>Determine the fraction mature at age from length at age</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Maturity at age</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">410</span>, <span class="at">xrange=</span><span class="dv">40</span>)</span></code></pre></div>
<p>If the spawning period is from day 200 to day 280 (time steps 201 to
281)</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Increments in the spawning period</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>spawn <span class="ot">&lt;-</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">281</span></span></code></pre></div>
<p>then the spawning stock abundance and biomass are</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Spawning stock abundance</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spawningStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>N, <span class="at">gs=</span>gs, <span class="at">period=</span>spawn)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.414319</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Spawning stock biomass</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spawningStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">gs=</span>gs, <span class="at">period=</span>spawn)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.499233</span></span></code></pre></div>
</div>
<div id="exploitable-and-vulnerable-stock" class="section level4">
<h4>Exploitable and Vulnerable Stock</h4>
<p>The <code>exploitableStock</code> function calculates the mean
abundance or biomass that can be exploited by scaling the abundance or
biomass by selectivity, <code>vulnerableStock</code> computes the effort
weighted mean exploitable stock abundance or biomass.</p>
<p>If the exploitable and vulnerable biomass are identical when fishing
effort is constant within the monitoring period</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Monitoring period within fishing season</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>monitor <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">151</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Exploitable biomass</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exploitableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">period=</span>monitor)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.419356</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Weighted vulnerable biomass</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vulnerableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">fwy=</span>fwy, <span class="at">period=</span>monitor)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.419356</span></span></code></pre></div>
<p>but may differ if the fishing effort varies varies within the
monitoring period</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Monitoring period spans fishing season</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>monitor <span class="ot">&lt;-</span> <span class="dv">41</span><span class="sc">:</span><span class="dv">101</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Exploitable biomass</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exploitableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">period=</span>monitor)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.498579</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Vulnerable biomass weights by effort</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vulnerableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">fwy=</span>fwy, <span class="at">period=</span>monitor)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.477055</span></span></code></pre></div>
<p>If the monitoring period is outside the fishing season, vulnerable
biomasss is zero</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="do">## No effort in monitoring period</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>monitor <span class="ot">&lt;-</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">31</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Exploitable biomass</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exploitableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">period=</span>monitor)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.460039</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Vulnerable biomass weights by effort</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vulnerableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">fwy=</span>fwy, <span class="at">period=</span>monitor)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span></code></pre></div>
</div>
</div>
<div id="spawningb0d" class="section level2">
<h2>spawningB0D</h2>
<p>The <code>spawningB0D</code> function provides a deterministic
estimate of the virgin spawning stock biomass by deterministically
computing the virgin age structure and projecting forward to compute the
spawning biomass.</p>
<div id="setup-6" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the
annual scaling</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.128707</span></span></code></pre></div>
</div>
<div id="virgin-spawning-biomass" class="section level4">
<h4>Virgin Spawning Biomass</h4>
<p>Determine the fraction mature at age from length at age</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Maturity at age</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">410</span>, <span class="at">xrange=</span><span class="dv">40</span>)</span></code></pre></div>
<p>If the spawing period is from day 200 to day 280 (time steps 201 to
281)</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Increments in the spawning period</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>spawn <span class="ot">&lt;-</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">281</span></span></code></pre></div>
<p>then the deterministic estimate of virgin spawning stock biomass
is</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Virgin spawning stock abundance</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spawningB0D</span>(<span class="at">gs=</span>gs, <span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">spawn=</span>spawn)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.170942</span></span></code></pre></div>
</div>
</div>
<div id="spawningb0s" class="section level2">
<h2>spawningB0S</h2>
<p>The <code>spawningB0S</code> function provides a stochastic estimate
of the virgin spawning stock biomass by repeatedly simulating the virgin
age structure and projecting forward to compute the spawning
biomass.</p>
<div id="setup-7" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">1</span>,<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days,<span class="at">Y=</span>Ages,<span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages,<span class="at">t0=</span><span class="fl">0.0667</span>,<span class="at">K=</span><span class="fl">0.5</span>,<span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the
annual scaling</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>,<span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="fu">length</span>(Ages))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms,<span class="at">h=</span>h))</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms,<span class="at">h=</span>h)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span></code></pre></div>
</div>
<div id="random-recruits" class="section level4">
<h4>Random Recruits</h4>
<p>Calculate model parameters for the proportional recruitment model
when <span class="math inline">\(R\)</span> has mean and variance 0.3
and 0.01</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsIB</span>(<span class="at">Msf=</span>Msf,<span class="at">mnR=</span><span class="fl">0.2</span>,<span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.128707</span></span></code></pre></div>
<p>Generate 1000 sets of 10 recruitment events</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">10000</span>,<span class="at">ps=</span>ps),<span class="at">nrow=</span><span class="dv">1000</span>,<span class="at">ncol=</span><span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="virgin-spawning-biomass-1" class="section level4">
<h4>Virgin Spawning Biomass</h4>
<p>Determine the fraction mature at age from length at age</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Maturity at age</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls,<span class="at">x50=</span><span class="dv">410</span>,<span class="at">xrange=</span><span class="dv">40</span>)</span></code></pre></div>
<p>If the spawing period is from day 200 to day 280 (time steps 201 to
281)</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Increments in the spawning period</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>spawn <span class="ot">&lt;-</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">281</span></span></code></pre></div>
<p>then estimates of the median, mean and standard deviation of the
virgin spawning stock biomass are</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Virgin spawning stock abundance</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spawningB0S</span>(<span class="at">R=</span>R,<span class="at">gs=</span>gs,<span class="at">ws=</span>ws,<span class="at">Ms=</span>Ms,<span class="at">M=</span>ps<span class="sc">$</span>M,<span class="at">spawn=</span>spawn)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>median</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.112722</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mean</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.167149</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>sd</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5168235</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1000</span></span></code></pre></div>
</div>
</div>
<div id="prrecruits" class="section level2">
<h2>prRecruits</h2>
<p>Grym offers several variants of the proportional recruitment model
implemented in the GYM.</p>
<p>Let <span class="math inline">\(A_{k}\)</span> be the number of
individuals in age class <span class="math inline">\(k\)</span> and
define <span class="math display">\[
R = \frac{A_{r}}{\sum_{k=r} A_{k}}
\]</span> the number of individuals in age class <span class="math inline">\(r\)</span> as a proportion of all individuals of
that age or older. Given estimates of the mean and variance of <span class="math inline">\(R\)</span> from independent surveys, the
proportional recruitment model determines the scaling of natural
mortality M and the distribution of random recruits that will reproduce
the observed mean and variance of R.</p>
<div id="setup-8" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the
annual scaling</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span></code></pre></div>
<p>Let <span class="math inline">\(R\)</span> be the proportion of the
number of recruits as a fraction of the total population.</p>
</div>
<div id="inverse-beta" class="section level4">
<h4>Inverse Beta</h4>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the
scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.1, </span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsIB</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3194035</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileIB</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">92.7501</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsIB</span>(<span class="dv">10</span>, ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">35.76553</span>  <span class="fl">84.91303</span>  <span class="fl">69.87547</span> <span class="fl">207.56580</span>  <span class="fl">84.48061</span> <span class="fl">153.51301</span>  <span class="fl">92.76493</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">113.61759</span>  <span class="fl">88.69235</span>  <span class="fl">72.30085</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.45615</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(R)</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3003241</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(R)</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.008681138</span></span></code></pre></div>
<p>The random recruits have a scaled inverse Beta distribution</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&lt;</span> <span class="dv">350</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">350</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Inverse Beta&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Repeat for the case where R is the proportion of individuals in age
class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsIB</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2380231</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileIB</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">93.15843</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">50.61651</span>  <span class="fl">88.28608</span> <span class="fl">199.31596</span>  <span class="fl">80.14353</span> <span class="fl">125.00658</span> <span class="fl">105.59532</span>  <span class="fl">59.45119</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">56.93413</span> <span class="fl">128.03149</span>  <span class="fl">77.65508</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.83956</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3011197</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.008945291</span></span></code></pre></div>
</div>
<div id="gamma" class="section level4">
<h4>Gamma</h4>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the
scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsG</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3194035</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileG</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">93.98026</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">108.65527</span> <span class="fl">145.86549</span>  <span class="fl">57.22718</span> <span class="fl">101.64628</span> <span class="fl">122.15178</span> <span class="fl">230.34918</span> <span class="fl">118.47731</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">40.11330</span>  <span class="fl">69.67919</span> <span class="fl">126.22100</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.92812</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3005887</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.009197483</span></span></code></pre></div>
<p>The random recruits have a scaled Gamma distribution</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsG</span>(<span class="dv">100000</span>, ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&lt;</span> <span class="dv">350</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">350</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Gamma&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Repeat for the case where R is the proportion of individuals in age
class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsG</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2380231</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileG</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">94.199</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">141.73520</span> <span class="fl">131.11183</span>  <span class="fl">56.81592</span> <span class="fl">179.36492</span> <span class="fl">169.04090</span> <span class="fl">162.64041</span>  <span class="fl">62.33943</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">51.46065</span>  <span class="fl">74.81807</span> <span class="fl">126.94591</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.45947</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3017854</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.009260248</span></span></code></pre></div>
</div>
<div id="log-normal" class="section level4">
<h4>Log Normal</h4>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the
scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsLN</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3194035</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileLN</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">91.95218</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">88.96458</span>  <span class="fl">99.85926</span> <span class="fl">156.09618</span> <span class="fl">136.85468</span> <span class="fl">107.18931</span>  <span class="fl">57.21556</span> <span class="fl">165.03870</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">109.50617</span> <span class="fl">111.56755</span>  <span class="fl">64.71214</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">100.2132</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2995976</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.008322976</span></span></code></pre></div>
<p>The random recruits have a scaled log Normal distribution</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&lt;</span> <span class="dv">350</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">350</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Log Normal&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Repeat for the case where R is the proportion of individuals in age
class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsLN</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2380231</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileLN</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">92.2145</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">104.10692</span>  <span class="fl">86.15870</span>  <span class="fl">95.17609</span> <span class="fl">106.56725</span> <span class="fl">124.95658</span>  <span class="fl">73.11769</span>  <span class="fl">99.47485</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">170.82276</span>  <span class="fl">86.15891</span> <span class="fl">123.32486</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.87571</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3009667</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.008510379</span></span></code></pre></div>
</div>
<div id="delta-inverse-beta" class="section level4">
<h4>Delta Inverse Beta</h4>
<p>The Delta-Inverse Beta model may provide a closer fit to abundance
data with a zero-inflated distribution.</p>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the
scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population,  assuming</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="do">## zero recruitment occurs with probability 0.4</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDIB</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>)</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.672917</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDIB</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="fl">59.01825</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">144.18957</span> <span class="fl">424.41095</span>  <span class="fl">35.79476</span> <span class="fl">268.75908</span> <span class="fl">276.71206</span> <span class="fl">184.85625</span> <span class="fl">160.18091</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">66.64040</span> <span class="fl">182.23708</span>   <span class="fl">0.00000</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.83625</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3575664</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.114891</span></span></code></pre></div>
<p>The random non-zero recruitment events have a scaled Inverse Beta
distribution</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> rs <span class="sc">&lt;</span> <span class="dv">600</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">600</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Delta Inverse Beta&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>But there are many zero recruitment events</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fraction of zero recruitments</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>rs<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.40057</span></span></code></pre></div>
<p>Repeat for the case where R is the proportion of individuals in age
class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older,  assuming</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="do">## recruitment occurs with probability 0.4</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDIB</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5928293</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDIB</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="fl">57.55216</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]   <span class="fl">0.00000</span> <span class="fl">358.97939</span>   <span class="fl">0.00000</span> <span class="fl">293.58829</span>   <span class="fl">0.00000</span> <span class="fl">273.42159</span> <span class="fl">261.42704</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">39.18023</span> <span class="fl">119.86683</span>   <span class="fl">0.00000</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">100.1837</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3584411</span></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1139135</span></span></code></pre></div>
</div>
<div id="delta-gamma" class="section level4">
<h4>Delta Gamma</h4>
<p>The Delta-Gamma model may provide a closer fit to abundance data with
a zero-inflated distribution.</p>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the
scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population,  assuming</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="do">## zero recruitment occurs with probability 0.4</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDG</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>)</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.672917</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDG</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="fl">28.85033</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]   <span class="fl">0.00000</span>  <span class="fl">62.82072</span>  <span class="fl">84.23420</span>   <span class="fl">0.00000</span>   <span class="fl">0.00000</span>   <span class="fl">0.00000</span>  <span class="fl">39.84184</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]   <span class="fl">0.00000</span> <span class="fl">253.08739</span>  <span class="fl">76.08888</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.49526</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3386194</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1227908</span></span></code></pre></div>
<p>The non-zero recruits have a scaled Gamma distribution</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> rs <span class="sc">&lt;</span> <span class="dv">600</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">600</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Delta Gamma&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>But there are many zero recruitment events</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fraction of zero recruitments</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>rs<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.39899</span></span></code></pre></div>
<p>Repeat for the case where R is the proportion of individuals in age
class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="do">## fraction of individuals that are that age or older, assuming</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="do">## recruitment occurs with probability 0.4</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDG</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5928293</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDG</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="fl">28.98105</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">59.47994</span>   <span class="fl">0.00000</span>  <span class="fl">53.90227</span>   <span class="fl">0.00000</span>   <span class="fl">0.00000</span> <span class="fl">944.87961</span> <span class="fl">193.57847</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">62.82589</span>   <span class="fl">0.00000</span> <span class="fl">193.75237</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.78788</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3329895</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1221531</span></span></code></pre></div>
</div>
<div id="delta-log-normal" class="section level4">
<h4>Delta Log Normal</h4>
<p>The Delta-Log Normal model may provide a closer fit to abundance data
with a zero-inflated distribution.</p>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the
scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population,  assuming</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="do">## zero recruitment events occur with probability 0.4.</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDLN</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.1</span>, <span class="at">p=</span><span class="fl">0.4</span>)</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.4421236</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDLN</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="fl">75.09216</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">119.54577</span>   <span class="fl">0.00000</span> <span class="fl">243.80287</span> <span class="fl">247.02325</span>  <span class="fl">89.00987</span>   <span class="fl">0.00000</span>  <span class="fl">57.18439</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]   <span class="fl">0.00000</span> <span class="fl">157.10870</span>   <span class="fl">0.00000</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.9098</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2970294</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.08369969</span></span></code></pre></div>
<p>The non-zero recruits have a scaled Log Normal distribution</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> rs <span class="sc">&lt;</span> <span class="dv">600</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">600</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Delta Log Normal&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAvVBMVEUAAAAAAEgAAHQASEgASHQASJwAdHQAdJwAdL9IAABIAEhIAHRISABISEhISHRISJxIdJxIdL9InN90AAB0AEh0SAB0SEh0dAB0nL90nN90v790v990v/+cSACcdACcdEicnHScnL+cv5ycv9+c37+c3/+/dAC/dEi/dJy/nHS/35y/37+/3/+//7+//9+////T09PfnEjfnHTfv3Tfv5zf37/f39/f/7/f////v3T/35z/37///7///9////8LG/MDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAR2klEQVR4nO2diXrjthVGaWfc2mm6RErSJXbTzeo2qc02aS2PzPd/rBIEVy2WwB8kAfKcb76RxhavKPDMJXBBQkkGIJBMvQMQNwgEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEosQKE0Krn71sfvzt4fk5iV/+NvTsW2uHi8KvkmS+/xht05unXes3IGYWZJAuUL3nZ/b4/fp62tRICMBAs2YWqA9Kezx2ySqQCYFIdCMSa0iP36dFAf57a+5SV++lMfPCGB+/0P+2+QXj802bYF++CZJPvtNcazN1h8eG+s2dvNKoOaVeYQ/fZ1c/zP/xQ9fJFffZv++yzcsXlO9FQLFQSmQOcj58cr/Nnx46gi03UtRHYHKFHZjpTMv+6IjULKqBGq90j69+d+6zH5flKZmzVshUBxUAtknefL4mL3e5Qe9dQrLn/70xf602qYRKP9x/rrUeGKO/u3L2yZpCXT96/wfVqD2K/O/bz5m/zW+rrL/5MZ8a3/ReisEioOWQFeP+QFdlT/b6wP9+Pcvkroj0xaofMWm1O+pyGUtgf6Ry2AFar8yrYdnNu3dtAQt3wqB4qAjUH4Qq1NIW6C37+xPjwhUHea03iTL2n2g66dNcvWXdUuIYuMygjWrTlCr9lshUBx0BNomxwQyXZsPf/xxfUygqn+cb3lfPe8KlIvxE/OL9itPCtR6KwSKg0qg/HgVB7uqBrUEsrlhd1Sg8xnIdpgvzECtt0KgOCgF+vSQtLJE1hGoyBmnOtHn+kBP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" /><!-- --></p>
<p>But there are many zero recruitment events</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fraction of zero recruitments</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>rs<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.39782</span></span></code></pre></div>
<p>Repeat for the case where R is the proportion of individuals in age
class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="do">## fraction of individuals that are that age or older,  assuming</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="do">## recruitment occurs with probability 0.4</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDLN</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5928293</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDLN</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="fl">51.71143</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated
parameters</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">139.80203</span> <span class="fl">157.24572</span>   <span class="fl">0.00000</span>   <span class="fl">0.00000</span>   <span class="fl">0.00000</span> <span class="fl">136.68089</span>   <span class="fl">0.00000</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">25.52025</span>   <span class="fl">0.00000</span>  <span class="fl">91.61322</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">101.7434</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of
recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3463817</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.115136</span></span></code></pre></div>
</div>
</div>
<div id="prrecruitsgym" class="section level2">
<h2>prRecruitsGYM</h2>
<p>Grym offers the same proprtional recruitment model based on the Beta
distribution offered in the GYM.</p>
<p>Let <span class="math inline">\(A_{k}\)</span> be the number of
individuals in age class <span class="math inline">\(k\)</span> and
define <span class="math display">\[
R = \frac{A_{r}}{\sum_{k=r} A_{k}}
\]</span> the number of individuals in age class <span class="math inline">\(r\)</span> as a poportion of all individuals of
that age or older. Given estimates of the mean and variance of <span class="math inline">\(R\)</span> from independent surveys, the
proportional recruitment model determines the scaling of natural
mortality M and the distribution of random recruits that will reproduce
the observed mean and variance of R.</p>
<div id="setup-9" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the
annual scaling</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="gym" class="section level4">
<h4>GYM</h4>
<p>Let <span class="math inline">\(R\)</span> be the proportion of the
number of recruits as a fraction of the total population.</p>
<p>Generate model parameters from the mean and variance of R. This
computes an estimate of the scaling of natural mortality required to
reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsGYM</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3263206</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileGYM</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">91.30353</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimate
parameters</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">145.60804</span> <span class="fl">110.39502</span> <span class="fl">105.01715</span>  <span class="fl">75.05919</span> <span class="fl">194.20826</span>  <span class="fl">53.48986</span>  <span class="fl">65.14028</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">107.33559</span> <span class="fl">184.61384</span> <span class="fl">117.91774</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.87962</span></span></code></pre></div>
<p>Simulate the 1000 stochastic age profiles with this distributionof
recruits and check the the observed mean and variance of R are
reproduced</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3041893</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.01031551</span></span></code></pre></div>
<p>The random recruits have a scaled inverse Beta distribution</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&lt;</span> <span class="dv">350</span>], <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">350</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;GYM&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Repeat for the case where R is the proportion of individuals in age
class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older</span></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsGYM</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2499531</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileGYM</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">112.4347</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimate
parameters</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">125.95836</span> <span class="fl">313.79214</span>  <span class="fl">96.91870</span> <span class="fl">181.94104</span> <span class="fl">132.96426</span> <span class="fl">100.64455</span> <span class="fl">164.27624</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">87.69838</span> <span class="fl">126.10463</span> <span class="fl">143.13822</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">122.031</span></span></code></pre></div>
<p>Simulate the 1000 stochastic age profiles with this distributionof
recruits and check the the observed mean and variance of R are
reproduced</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">100000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3047951</span></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.01042589</span></span></code></pre></div>
</div>
</div>
<div id="prbootstrap" class="section level2">
<h2>prBootstrap</h2>
<p>Let <span class="math inline">\(A_{k}\)</span> be the number of
individuals in age class <span class="math inline">\(k\)</span> and
define <span class="math display">\[
R = \frac{A_{r}}{\sum_{k=r} A_{k}}
\]</span> the number of individuals in age class <span class="math inline">\(r\)</span> as a poportion of all individuals of
that age or older.</p>
<p>The proportional1 recruitment model assumes estimates of the mean and
variance of <span class="math inline">\(R\)</span> from independent
surveys. To allow for uncertainty in these estimates,
<code>prBootstrap</code> uses parametric bootstrap to simulates new
values for the mean and variance of <span class="math inline">\(R\)</span> that are consistent with the observed
values.</p>
<div id="setup-10" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age
class</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the
annual scaling</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="inverse-beta-1" class="section level4">
<h4>Inverse Beta</h4>
<p>Generate model parameters from the observed mean and variance of R
assuming the Inverse Beta model</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsIB</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf)</span></code></pre></div>
<p>Simulate a new values for the mean and variance on which subsequent
projections could be based, assuming the original estimates were
generated from 17 independent survey</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate new mean and variance for 17 surveys</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsIB, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mnR</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2978607</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>vrR</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.00573041</span></span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>p</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">17</span></span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>r</span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<p>Generate 2000 bootstrap samples and examine the distribution of the
simulated mean and variance</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution of 2000 samples</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">2000</span>, <span class="at">expr=</span><span class="fu">unlist</span>(<span class="at">x=</span><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsIB, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)))</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Mean R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(bs[<span class="dv">1</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="gamma-1" class="section level4">
<h4>Gamma</h4>
<p>Generate model parameters from the observed mean and variance of R
assuming the Gamma model</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsG</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf)</span></code></pre></div>
<p>Simulate a new values for the mean and variance on which subsequent
projections could be based, assuming the original estimates were
generated from 17 independent survey</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate new mean and variance for 17 surveys</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsG, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mnR</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2853317</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>vrR</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.00836791</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>p</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">17</span></span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>r</span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<p>Generate 2000 bootstrap samples and examine the distribution of the
simulated mean and variance</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution of 2000 samples</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">2000</span>, <span class="at">expr=</span><span class="fu">unlist</span>(<span class="at">x=</span><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsG, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)))</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Mean R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAdVBMVEUAAAAAAEgAAHQASJwAdHQAdL9IAABIAEhIAHRISEhInN90AAB0AEh0AHR0dAB0nJx0v790v/+cSACcSEicdACcnHScv5yc3/+/dAC/35y//7+//9+////T09PfnEjf/9/f////AAD/v3T/35z//7///9//////zyTYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAT0UlEQVR4nO2diZbbuBEANXY82Xicw8phJfEoXo3E///EiDdBEiKABkAAqnpvvRLZaIk9RYgneKgABBz2/gKQNwgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEJG0QL/v/QUSItVaIFAmpFoLBMqEVGuBQJmQai0QKBNSrQUC+eR2PDR8+uk9daq1QCCPnA9f2xeX/oU/Uq0FAvnjdhy0OX/+5Tl5qrVAIH9c3773Ly/ef8RSrQUC+YMeKDVSLZqO86HrgtgG2p96ZybVomm5vrV7Yb76nyZZ+zLVWqQr0Pv7e6pFi0ZdBASypl2LEQiBHKnL9p6hQNe3esvn4vFAIgI5kbVAzf7XZIdeBAI5kbNAnTqeduMRyImcBfp4bQSaHUg8DNhlRCAnchZoowdCoBjkK1Ddx3yp+s3pFRAoBrkKVDUOvfx4cCAagWKQsUBbIFAMEGgIRyAXEGgIRyAXEGgIRyAXchWoPxf/4KpoBIpBrgJVt+PWSTAEioEikMsB3N24Hb88DkCgGKgCvY9FTJ/L4fFZVASKQcYCbYFAMUCgIRyBXECgIRyBXECgIRyBXECgIRyBXECgIRyBXECgIRyBXECgIRyBXECgIRyBXBgF6m4wRCAEsmEUqPv/0wtUjxOQaA1S/FoINIT3AtW9cZAvJCbFr4VAQzgCuYBAQzgCuYBAQ3hpAgUcxnYCAg3hhQkUchjbCQg0hJclUNBBJCcg0BBelkBBh7GdgEBDeFkC0QOJeW6Bgg5jOwGBhvDCBPI+jO06CNTGticCixIoDgjUxrYLj0DWIFAbW5xA/oexXQeB2tgyBfI6jO06CNTGFimQ32Fs10GgNrZIgfwOY6v5TgjUxBYpkN9hbDXfCYGa2E6gdne+DIF8D2OrSYJATWwnUPtfCQJV3oex1SRBoCa2RIGipEOgNhaBXJMgUBOLQK5JEKiJRSDXJAjUxBYnkP9hbDXfCYGa2OIE8j+MrSYJAjWx5QnkfRhbTRIEamILFMj3MLYrCYbxFBCoRIGCpzsMziDQTKA0x1tHoKhIBEqzDAgUFQQKnQ6BxlgEckmAQEMsArkkQKAhFoFcEiDQELsUKME9MQSKilCgBEuBQFFBoNDpEGiMRSCXBAg0xK4LlNh2EAJFxYNAiZUDgaKCQKHTIdAYi0AuCbQCZfX8bx0IFDrdA4FK6IoQKHQ6BBpjEcglAQINsQhk2ba/nBWB2lgEsmz7Ppbr2QXq1iUEsmqLQGNcu+QIZNUWgcY4BHJoi0BjHAI5tEWgMQ6BHNoi0BiHQA5tEWiMQyCHtgg0xiGQQ1sEGuMQyKEtAo1xCOTQNn+BNh9KjEAB0+Uv0PZDiREoYLrsBTJ4JCgCBUyXvUAGDyVGoIDpHgk0jFvm7ZsGwFMPNLmqRSdQQhf3ZiLQtCtKl+2HEhsJNC6wTqCEKoFAPtl8KDECBUxXgECbIFDAdAjUxSCQY9v8BfJyIBGBXNtmL5CfA4kI5No2d4F87cYjkGNbE4ESOgKyQH8g0eqhxAjk2tZEoIRKt4AeaN902QvEgcR90+UvEAcSd01XgECbIFCgdMpTnhAoR4Huve/Gw+Ss0tm2W1UlJYHi1SdTgepNwINu288lnV275AWKV59sBao81Khkgaqt+nh6KHHOArUl2nqyrkU643Z5CLRRHz8PJc5YoMu9Ot/vZdDuhdqls2mXhUCb9fHyUOJcBao74LYyugt6rdJZtktfIKP6+HgocaYCXd9efnhMZ9sueYHi1SdTgfZNl75AfihaoNO9g9aexGnxduflol0GAhnUZ5OSBTo1P/DXtwebgf7uvFy0S18gg/psU7BA/cUsD7YQPd55uWiXvEAG9TGgYIF6O876Anm883LRLnmBDOpjQMECdRezfLzqf+SfugcyqI8BJQt0r8198/jhvqqfC6ZW26UvkEF9tilaIAO8XDC12i4DgXzw7AIFS4dAk5hMBdo8xmOXzrJd+gJFq0+uAp0MKvPMBxJN6rNJwQJd37Z3L575QKJJfbYpWqDH55GrJ9+NN6iPAQULtHkpi7c7L1e/RvICGdTHgIIF2ryU5cl7IIP6GFCwQMMFvQ+2FZ/5QKJJfbYpWCAjOJAo5NkFCpYOgSYxuQp0714+/zqFv2BqtV0GAsWqT64CXV5+3DeNhYc7ogi0zyBB0eqTqUD1Lla9bxX+epfVdjYCve9Rv3j1yVSg+iBPXaAHV9x5uvNytV3yAhnUx4CCBerXsNODuwr93Hk5bzIZ2j9hgUzqs03BAnW/8eeHh8u83Hk5b6IxJDGBjOqzSckCtb9QG1fc+bjzct4kE4GM6rNF0QLtlC4bgXzgUSDZyUdvIFBUPAqUSEdkdS7MIp1FkzwESu5cWGoCdcj2UgsWqCNCffIWqDoFv3V33iQrgSLUJ3OBwh8omzfJS6BkDiSmKlD0UxmZCZTMqYxEBYow+sS8SVYCpTM6R2oCbV4rZpfOokkeAsWrT6YC7ZYuE4H8gED+0yHQPCZPgQyu1bBJZ9EkD4Hi1SdTgbrzpBHONs+b5CFQvPpkKtDt2FZGd8eXZTqLJnkIFK8+mQp0/dZeqMCBxHXi1SdTgfo1LPwVd/MmeQgUrz6ZClRfcXf/9yy7YqpcgeLVJ1eB2v0M2XGykgWKVp9sBdopXTYC+QCB/KdDoHlMrgLtdGtzNgIldmtzcgLtdWtzLgKldmtzagLtdmtzJgIld2tzagLFu3V33iQPgZK7tTk1geLdujtvkodAyd3anJpA8W7dnTfJQ6Dkbm1OTqBot+7Om2QiUJz6TAaayE6gndJlI5APtgVaKpKJQJMxfH2ks2iSh0CR6pOvQPFGYp83yUOgSPXJVyDpTbvzdOZN8hAoUn3yFYjBFR4TqT75CrRbukwE8gMC+U+HQMPMdh8+R4H8bCFWxQoUpz5La/ISyMeOaskCBa+Pk0B7D3OHQCYkLNDevRACmYBA+i/d/ItAj0Eg/Zdu/kWgxyCQ/ks3/yLQYxBI/6Wbf/0MPVEVLFDo+kweGGIv0J47YhxIjIpeoFVrDAXasxwIFBUE8p8OgZoZCOSaDoGaGQjkmq4kgW7HjQ1tBPKfriCBzoduR/9y0OzxI5DfdP3OaxkCTQ4U6QbCQyC/6da9yVWgyUUfuutfEchvurIEogeKnk4g0N7Xwawx3LbKNlCkdAKBkuyFNh+ogUB+05Um0CYI5Dfdswg0norVRiCQS7qyBGpHL7vsdSBxn81CBPJHI1Cz/6W9iyOoQLuUBIH8UQvUqbPHbnwOArmf69GEFyfQx2sj0B4HEjMQSHCuRxNenED0QA+QHGnVfHphAtW985eq35xe4bkFkpzr0Xx6UQJVjUMvP/QddDiB+kuqAy2XHnqgqAQTaLeSWG4DOZ/r0YQjUD/jKQQSnOvRhCNQP+M5BPKdDoGGGc8t0Pa5Hk0TBOpnPINAknM9y8gHYiBQwQI5nutZRiKQMuNZBHI90rqMRCBlxrMI5HquZxnpQaAkr2t9CAIl1QO9Z9cNPbtA7ud6lpEIpMx4BoEqwbmeZSQCKTOeRCB/6RBInYFAlukQSJ2BQJbpEEidgUCW6RBInYFAlukQSJ2BQJbpEEidgUCW6RBInYFAlukQSJ2BQJbpEEidgUCW6RBInYFAlukQSJ2BQJbpEEid4U+guNe4IFBUoggUtSgIFBUE8pYOgcaJk/tTEMg4EoGGidteINAyEoGGiR4FajszBEIgR4G6tzsvUYx0CDRORCCHdAg0TkQgh3QINE5EIId0CDRORCCHdAg0TkQgh3QINE5EIId0CDRORCCHdAg0TkQgy3Qbj0pFIATaiDIRw1SgrIZ4QSAv6bwKlFUvhEBe0iGQOhGBLNMhkDoRgSzTIZA6EYEs0yGQOhGBLNMhkDoRgSzTIZA6EYEs0yGQOtG/QPEOjiFQVGIJFK8oCBQVBPKSDoHUiQhkmQ6B1IkIZJkOgSZTlLtSEcgsCoHGKYZeINA0CoHGKQhklc7kSZcIhED6ABMfEAiBtAFBBLJ/5u9OIJA0XRiBsumK4gsUer1CoKioX7AfjCWMQIdxezPaEoVPh0DTd/q/vgeBFp1RhCUKnw6Bpu8QyDodAk3fIZB1OgSavkMgq3SmN6QiEAKtz7T1AYEQSJmJQAgkSYdACCRKh0AIJEqHQAgkSodACCRKh0AIJEoXQaDUr+kYv9vkwrooAoWqTGECvSfeDU0EMv7rexIoUGUQKCo7CRTwsg4EispOAvX/BV2i8OkQKA2BvG4OFSpQqlvTaQjkcy0rVaBEuyIEckg33jMRSaDhqpH0eqFnF+h2bE349NMinbU3UoGUF8o3Ca2URX12EWiyIo+V6F461saqyfnwtX1x6V+YpEtIoHef694Sm/rsItCjDsmxX7JpcjsOZTl//vUg3UHlWQSyq08CArVdzlQg+17IJvz69r1/eVE76dmtoQdP/O4rkYJdgVKpT5harGG30J57IL/8HuEzPBK0PqnWwnIbqFvFtL/xfkm1aDpC1ifVWth1WNe3tpeL0v+kWzQtAeuTai0SO06ikmrR9iDVWiBQJqRaCwTKhFRrgUCZkGotECgTUq0FAmVCqrVAoExItRYIlAmp1iK2QFZnZcKd/4m81GZEr4WXL+0jSajPCxacqEBxg/xUAYHSAYF8fx4ChQxCIPdgBDKPipEk1OchUMggBHIPRiDzqBhJQn0eAoUMQiD3YAQyj4qRJNTnIVDIoDwFgsJAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBiPACXQ6Hlx/d62YU03rspXYgnS8Pg6tz/0aZuhGsyTxPcWqG8NEkjoLy2Zf5ouoKZJ6pqj5++2mZyYHgAl3ui3PpFul2vL841wvz8cfVv9s0uDp/+tm+UaZuBa9nnqe4NGNAaRJHQfns4c3wQlMg80y1Oc1AjRaZXAgtUDtu4KldAT5e6yHgmr/16kjKSvD17Ws95Ys6dSt4PfM8xX2tvAukSRwF5bOHN+PU9QKZZ2q6oiaHeSYnQgs0OjNQryDn1b/aMrh2YiWFPng98zz2/Pkfd4E0iaOgfPbwZpy6XiDzTPUwja065pmcCC5Q04Eqa8Hp/ub0p25jaCP4fJdtJYU+eD3zLPb+tt4G0iSOgvLZw5tx6nqBzDNVw//MMzkRWqD291jd/Ph6/wmpN0FO88WaB1+aJV+meBC8nlmNrfv5WiBN4igonz28GV5oCmSeqXlTC2SRyYnoAl3GHYLFur/8i96On38ZCtQGr2dWY+tBnBMXqAsy6Rw3BLLI5ETsn7DpCMrtD/aD4KqphfFP2Fj5eeZlN5/6T1gbNC+QeaaqUpbMKJMTkTeiz9Nf48UO5spW7X2S8Ub0WKZ5ZiX23A1uokscha2N6DbIZA9csxFdqQIF25ePuhs/DOXeLudi3V/Z57/HmOzGD8HrmZcpTmnvxmsKZJ6p6ptbZHIi6oHEj9e+/2kWcbllpxwTG/7GJgcSh+D1zIsUp8QPJGoKZJ6pGvbCzDO5EP5URneOoT5I0/14NAWqf0MeBk9izutnHNaD1zMrsVV/KkOTOArKNxq+yPBCUyDzTEO3Y5HJAU6mgggEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCKSEeh27EZ+aQdQ3QhtCDduWxrcjt2YGsMd/T3XN9Ob3YPXKiWBWnFOBgI19bwEHDIgDfolFCxp8FolJNAfvjUjbP/5L4YCLdbL4ri+tUt42qqInuC1SkigL80gNpdmBN5mJJim2+0GJ7m+/e2tH6Wkr4agrplw+tSONd+MGtUV4ts/D5/+0/yELUpz7oakP4+/WcFrlZJAl3Y80XpZm+F9X7vxouo317d6dOl25Jun6YH64cX6EafaQtzL02wDLUrTvvk6Fq96sh6ofrbD9Vs9hHO7zl0+/bzWP2t1GZsp3RiIXTXOxW8D9WNn1coohagFWpSmLVrfYXWjSwWvVUoC3Y7f779gv079yL6dL5e6f27WuW7no9+zKN6fdrjMYejQRSHUKX2cUrzgtUpJoHpU/lMzBvilH0i1/jn/9O/XuUD141pei/8Bq9olbsdcXRZiPqUfiXUsXhWhVkkJ9PHbf//+oxp6oKpbjz7WBFJGnC6X0+f/NUu7LMRiitoDdQSvVVIC3Y5/vW8GNdtAfa9dr32XxU9Ys0KddhsfMyKXl3+NY4crhVhMGbeBJr9XwWuVlED3HdMv7TZj+9yUlx/tGtY8XWMhUPsUiMK5Hf/ULOWyEMspddGaLYGueG37wLVKS6DmgOmpPw5Ur2LNqLWn+ukjC4HUYe9LpV/IZSFWpwzHgWZnQYLVKhmBIE8QCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhH/B/c6TTm7bB79AAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="log-normal-1" class="section level4">
<h4>Log Normal</h4>
<p>Generate model parameters from the observed mean and variance of R
assuming the log Normal model</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsLN</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf)</span></code></pre></div>
<p>Simulate a new values for the mean and variance on which subsequent
projections could be based, assuming the original estimates were
generated from 17 independent survey</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate new mean and variance for 17 surveys</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsLN, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mnR</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2693648</span></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>vrR</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.007350162</span></span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>p</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">17</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>r</span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<p>Generate 2000 bootstrap samples and examine the distribution of the
simulated mean and variance</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution of 2000 samples</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">2000</span>, <span class="at">expr=</span><span class="fu">unlist</span>(<span class="at">x=</span><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsLN, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)))</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Mean R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,]),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="gym-1" class="section level4">
<h4>GYM</h4>
<p>Generate model parameters from the observed mean and variance of R
assuming the model implemented in the GYM</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsGYM</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf)</span></code></pre></div>
<p>Simulate a new values for the mean and variance on which subsequent
projections could be based, assuming the original estimates were
generated from 17 independent survey</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate new mean and variance for 17 surveys</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsGYM, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mnR</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2967118</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>vrR</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.02058631</span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>p</span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">17</span></span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>r</span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<p>Generate 2000 bootstrap samples and examine the distribution of the
simulated mean and variance</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution of 2000 samples</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">2000</span>,<span class="at">expr=</span><span class="fu">unlist</span>(<span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsGYM, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)))</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Mean R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="resamplergym" class="section level2">
<h2>resampleRGYM</h2>
<p>The <code>resampleRGYM</code> function resamples the mean and
variance of <span class="math inline">\(R\)</span> using the same
procedure implemented in the GYM. <strong>This procedure is based on a
false premise and should not be used</strong>.</p>
<p>The variances simulated by this technique are often larger than it is
possible for the variance of a proportion to be.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate the varianceof R</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>vs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">expr=</span><span class="fu">resampleRGYM</span>(<span class="at">mnR=</span><span class="fl">0.5</span>, <span class="at">vrR=</span><span class="fl">0.17</span>, <span class="at">n=</span><span class="dv">17</span>)<span class="sc">$</span>vrR)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="do">## The simulated variance is often larger than it is possible for the</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="do">## variance of a proprtion to be</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>vs, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;Resampled Variances&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="surveysurvival" class="section level2">
<h2>surveySurvival</h2>
<p>The <code>surveySurvival</code> function computes the total survival
of a cohort from time of recruitment to a nominated survey period given
specified natural and fishing mortalities. The resulting survivals can
be used to backproject age based abundance survey data to estimate
recruitment.</p>
<div id="setup-11" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Define the intra-annual natural mortality and its integral</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span></code></pre></div>
<p>Suppose surveys are conducted in years 3, 4 and 5, starting on time
step 190 in year 1, time step 220 in year 2 and time step 150 in year 3,
and in each case the survey lasted 12 days and all age classes were
surveyed.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survey year,  period and age classes</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>svy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yr=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">s1=</span><span class="fu">c</span>(<span class="dv">190</span>, <span class="dv">220</span>, <span class="dv">150</span>), <span class="at">s2=</span><span class="fu">c</span>(<span class="dv">201</span>, <span class="dv">231</span>, <span class="dv">161</span>))</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>svy <span class="ot">&lt;-</span> <span class="fu">cbind</span>(svy[<span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each=</span><span class="dv">7</span>), ], <span class="at">cls=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(svy)</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>    yr  s1  s2 cls</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">1</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a><span class="fl">1.1</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">2</span></span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">3</span></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">4</span></span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a><span class="fl">1.4</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">5</span></span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a><span class="fl">1.5</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">6</span></span></code></pre></div>
</div>
<div id="constant-mortality" class="section level4">
<h4>Constant mortality</h4>
<p>Assume there is no inter-annual variability in natural mortality and
the annual scalings of natural mortality is constant</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant mortality</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>The total mean survival for the cohort from the start of the year in
which they were in the first age class to the survey period is</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survival to the survey period from age class 1</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">surveySurvival</span>(<span class="at">yr=</span>svy<span class="sc">$</span>yr, <span class="at">cls=</span>svy<span class="sc">$</span>cls, <span class="at">s1=</span>svy<span class="sc">$</span>s1, <span class="at">s2=</span>svy<span class="sc">$</span>s2, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">0.8989089</span> <span class="fl">0.7359644</span> <span class="fl">0.6025567</span> <span class="fl">0.4933317</span> <span class="fl">0.4039058</span> <span class="fl">0.3306901</span> <span class="fl">0.2707462</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">0.8842531</span> <span class="fl">0.7239652</span> <span class="fl">0.5927326</span> <span class="fl">0.4852884</span> <span class="fl">0.3973205</span> <span class="fl">0.3252985</span> <span class="fl">0.2663319</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">15</span>] <span class="fl">0.9188285</span> <span class="fl">0.7522732</span> <span class="fl">0.6159092</span> <span class="fl">0.5042638</span> <span class="fl">0.4128563</span> <span class="fl">0.3380181</span> <span class="fl">0.2767458</span></span></code></pre></div>
<p>The computed survivals can be used to project cohort abundances the
initial abundance for the first age class.</p>
<p>To compute the mean survival for the cohort from the start of the
year in which they were in the third age class o the survey period</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survival to the survey period from age class 3</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">surveySurvival</span>(<span class="at">yr=</span>svy<span class="sc">$</span>yr, <span class="at">cls=</span>svy<span class="sc">$</span>cls, <span class="at">s1=</span>svy<span class="sc">$</span>s1, <span class="at">s2=</span>svy<span class="sc">$</span>s2, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M, <span class="at">rcls=</span><span class="dv">3</span>)</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">1.3410145</span> <span class="fl">1.0979298</span> <span class="fl">0.8989089</span> <span class="fl">0.7359644</span> <span class="fl">0.6025567</span> <span class="fl">0.4933317</span> <span class="fl">0.4039058</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">1.3191507</span> <span class="fl">1.0800292</span> <span class="fl">0.8842531</span> <span class="fl">0.7239652</span> <span class="fl">0.5927326</span> <span class="fl">0.4852884</span> <span class="fl">0.3973205</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">15</span>] <span class="fl">1.3707311</span> <span class="fl">1.1222597</span> <span class="fl">0.9188285</span> <span class="fl">0.7522732</span> <span class="fl">0.6159092</span> <span class="fl">0.5042638</span> <span class="fl">0.4128563</span></span></code></pre></div>
<p>For age classes younger than third age class at the time of survey
the surival is greater than 1.</p>
</div>
<div id="variable-mortality" class="section level4">
<h4>Variable mortality</h4>
<p>When there is inter-annual variability in natural mortality</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable mortality</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">rate=</span><span class="dv">100</span>)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>M</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">0.2565043</span> <span class="fl">0.1945826</span> <span class="fl">0.1828530</span> <span class="fl">0.2005039</span> <span class="fl">0.1378985</span> <span class="fl">0.2422316</span> <span class="fl">0.2118495</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">0.3217360</span> <span class="fl">0.2093846</span> <span class="fl">0.1328408</span></span></code></pre></div>
<p>the labelling of survey years (<code>yr</code>) corresponds to the
elements of <code>M</code> (so <code>yr==1</code> corresponds to
<code>M[1]</code>) and survival cannot be estimated for cohorts that
must be projected outside the time interval spanned by
<code>M</code>.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survival cannot be projected outside the period for which mortality</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="do">## is specified.</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="fu">surveySurvival</span>(<span class="at">yr=</span>svy<span class="sc">$</span>yr, <span class="at">cls=</span>svy<span class="sc">$</span>cls, <span class="at">s1=</span>svy<span class="sc">$</span>s1, <span class="at">s2=</span>svy<span class="sc">$</span>s2, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M)</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">0.9071598</span> <span class="fl">0.7467542</span> <span class="fl">0.5778023</span>        <span class="cn">NA</span>        <span class="cn">NA</span>        <span class="cn">NA</span>        <span class="cn">NA</span></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">0.8839791</span> <span class="fl">0.7362579</span> <span class="fl">0.6060714</span> <span class="fl">0.4689488</span>        <span class="cn">NA</span>        <span class="cn">NA</span>        <span class="cn">NA</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">15</span>] <span class="fl">0.9433010</span> <span class="fl">0.7719204</span> <span class="fl">0.6429253</span> <span class="fl">0.5292421</span> <span class="fl">0.4095019</span>        <span class="cn">NA</span>        <span class="cn">NA</span></span></code></pre></div>
</div>
</div>
<div id="surveyadjustgym" class="section level2">
<h2>surveyAdjustGYM</h2>
<p>The <code>surveySurival</code> function adjusts surveyed age class
abundances to initial abundances at a reference age class as implemented
in the GYM. Where abundance is estimated from multiple surveys,
abundance is estimated as a geometric mean of the estimates from
individual surveys weighted by the inverse of the squared
<em>coefficient of variation</em> of the surveyed density.</p>
<div id="survey-data" class="section level4">
<h4>Survey Data</h4>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make some survey data</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>survey.df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text=</span><span class="st">&quot;Survey, Year, Age, Density, SE, Scale, Start, End</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 3, 0.01, 0.01, 50340.67, 178, 179</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 4, 8.15, 8.96, 50340.67, 178, 179</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 5, 6.58, 7.13, 50340.67, 178, 179</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 6, 0.01, 0.01, 50340.67, 178, 179</span></span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 7, 0.01, 0.01, 50340.67, 178, 179</span></span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 3, 10.02, 8.97, 42308.13, 281, 282</span></span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 4, 14.12, 12.9, 42308.13, 281, 282</span></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 5, 0.01, 0.01, 42308.13, 281, 282</span></span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 6, 15.96, 19.26, 42308.13, 281, 282</span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 7, 19.87, 21.84, 42308.13, 281, 282</span></span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 3, 8.72, 7.63, 81105.82, 120, 121</span></span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 4, 0.01, 0.01, 81105.82, 120, 121</span></span>
<span id="cb239-15"><a href="#cb239-15" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 5, 73.32, 65.51, 81105.82, 120, 121</span></span>
<span id="cb239-16"><a href="#cb239-16" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 6, 94.41, 104.99, 81105.82, 120, 121</span></span>
<span id="cb239-17"><a href="#cb239-17" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 7, 0.01, 0.01, 81105.82, 120, 121</span></span>
<span id="cb239-18"><a href="#cb239-18" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 8, 36.55, 31.68, 81105.82, 120, 121</span></span>
<span id="cb239-19"><a href="#cb239-19" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 3, 7.04, 8.31, 84767.1, 175, 176</span></span>
<span id="cb239-20"><a href="#cb239-20" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 4, 12.6, 15.56, 84767.1, 175, 176</span></span>
<span id="cb239-21"><a href="#cb239-21" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 5, 30.79, 35.74, 84767.1, 175, 176</span></span>
<span id="cb239-22"><a href="#cb239-22" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 6, 56.52, 47.78, 84767.1, 175, 176</span></span>
<span id="cb239-23"><a href="#cb239-23" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 7, 27.55, 30.16, 84767.1, 175, 176</span></span>
<span id="cb239-24"><a href="#cb239-24" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 3, 10.51, 9.37, 86130.6, 175, 176</span></span>
<span id="cb239-25"><a href="#cb239-25" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 4, 14.51, 17.19, 86130.6, 175, 176</span></span>
<span id="cb239-26"><a href="#cb239-26" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 5, 0.01, 0.01, 86130.6, 175, 176</span></span>
<span id="cb239-27"><a href="#cb239-27" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 6, 37.78, 42.56, 86130.6, 175, 176</span></span>
<span id="cb239-28"><a href="#cb239-28" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 7, 30.29, 37.05, 86130.6, 175, 176</span></span>
<span id="cb239-29"><a href="#cb239-29" aria-hidden="true" tabindex="-1"></a><span class="st">6, 2002, 3, 8.59, 10.36, 42865.61, 153, 154</span></span>
<span id="cb239-30"><a href="#cb239-30" aria-hidden="true" tabindex="-1"></a><span class="st">6, 2002, 4, 24.15, 23.4, 42865.61, 153, 154</span></span>
<span id="cb239-31"><a href="#cb239-31" aria-hidden="true" tabindex="-1"></a><span class="st">6, 2002, 5, 35.82, 30.15, 42865.61, 153, 154</span></span>
<span id="cb239-32"><a href="#cb239-32" aria-hidden="true" tabindex="-1"></a><span class="st">6, 2002, 6, 24.58, 21.35, 42865.61, 153, 154</span></span>
<span id="cb239-33"><a href="#cb239-33" aria-hidden="true" tabindex="-1"></a><span class="st">7, 2003, 3, 0.01, 0.01, 86229.58, 156, 157</span></span>
<span id="cb239-34"><a href="#cb239-34" aria-hidden="true" tabindex="-1"></a><span class="st">7, 2003, 4, 25.4, 28.86, 86229.58, 156, 157</span></span>
<span id="cb239-35"><a href="#cb239-35" aria-hidden="true" tabindex="-1"></a><span class="st">7, 2003, 5, 68.98, 66, 86229.58, 156, 157</span></span>
<span id="cb239-36"><a href="#cb239-36" aria-hidden="true" tabindex="-1"></a><span class="st">7, 2003, 6, 59.71, 74.47, 86229.58, 156, 157</span></span>
<span id="cb239-37"><a href="#cb239-37" aria-hidden="true" tabindex="-1"></a><span class="st">8, 2004, 3, 0.01, 0.01, 85208.41, 156, 157</span></span>
<span id="cb239-38"><a href="#cb239-38" aria-hidden="true" tabindex="-1"></a><span class="st">8, 2004, 4, 0.01, 0.01, 85208.41, 156, 157</span></span>
<span id="cb239-39"><a href="#cb239-39" aria-hidden="true" tabindex="-1"></a><span class="st">8, 2004, 5, 28.67, 29.37, 85208.41, 156, 157</span></span>
<span id="cb239-40"><a href="#cb239-40" aria-hidden="true" tabindex="-1"></a><span class="st">8, 2004, 6, 24.2, 29.24, 85208.41, 156, 157</span></span>
<span id="cb239-41"><a href="#cb239-41" aria-hidden="true" tabindex="-1"></a><span class="st">9, 2005, 3, 0.01, 0.01, 84305.83, 171, 172</span></span>
<span id="cb239-42"><a href="#cb239-42" aria-hidden="true" tabindex="-1"></a><span class="st">9, 2005, 4, 11.77, 11.17, 84305.83, 171, 172</span></span>
<span id="cb239-43"><a href="#cb239-43" aria-hidden="true" tabindex="-1"></a><span class="st">9, 2005, 5, 0.01, 0.01, 84305.83, 171, 172</span></span>
<span id="cb239-44"><a href="#cb239-44" aria-hidden="true" tabindex="-1"></a><span class="st">9, 2005, 6, 19.68, 18.49, 84305.83, 171, 172&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="setup-12" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Define the intra-annual natural mortality and its integral</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(Ages))</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span></code></pre></div>
<p>Suppose surveys are conducted in years 3, 4 and 5, starting on time
step 190 in year 1, time step 220 in year 2 and time step 150 in year 3,
and in each case the survey lasted 12 days and all age classes were
surveyed.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survey year,  period and age classes</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>svy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yr=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">s1=</span><span class="fu">c</span>(<span class="dv">190</span>, <span class="dv">220</span>, <span class="dv">150</span>), <span class="at">s2=</span><span class="fu">c</span>(<span class="dv">201</span>, <span class="dv">231</span>, <span class="dv">161</span>))</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>svy <span class="ot">&lt;-</span> <span class="fu">cbind</span>(svy[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each=</span><span class="dv">7</span>), ], <span class="at">cls=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(svy)</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>    yr  s1  s2 cls</span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">1</span></span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a><span class="fl">1.1</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">2</span></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">3</span></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">4</span></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a><span class="fl">1.4</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">5</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a><span class="fl">1.5</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">6</span></span></code></pre></div>
</div>
<div id="constant-mortality-1" class="section level4">
<h4>Constant mortality</h4>
<p>Assume there is no inter-annual variability in natural mortality and
the annual scalings of natural mortality is constant</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant mortality</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>Convert surveyed age to the modelled age class</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert age to age class</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>survey.df<span class="sc">$</span>AgeClass <span class="ot">&lt;-</span> survey.df<span class="sc">$</span>Age<span class="sc">-</span><span class="fu">min</span>(Ages)<span class="sc">+</span><span class="dv">1</span></span></code></pre></div>
<p>Estimate the abundance of the first age class</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjust survey abundances to abundance of reference age class</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">surveyAdjustGYM</span>(<span class="at">survey.df=</span>survey.df, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M, <span class="at">rcls=</span><span class="dv">1</span>)</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>     Year       RAbund</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1984</span> <span class="dv">1984</span> <span class="fl">1.508180e+03</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1985</span> <span class="dv">1985</span> <span class="fl">1.234793e+03</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1986</span> <span class="dv">1986</span> <span class="fl">6.652137e+05</span></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1987</span> <span class="dv">1987</span> <span class="fl">1.340961e+06</span></span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1988</span> <span class="dv">1988</span> <span class="fl">1.660966e+04</span></span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1989</span> <span class="dv">1989</span> <span class="fl">8.989819e+02</span></span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1990</span> <span class="dv">1990</span> <span class="fl">1.039266e+06</span></span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1991</span> <span class="dv">1991</span> <span class="fl">6.038108e+05</span></span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1992</span> <span class="dv">1992</span> <span class="fl">1.050824e+07</span></span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1993</span> <span class="dv">1993</span> <span class="fl">2.353877e+03</span></span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a><span class="dv">1994</span> <span class="dv">1994</span> <span class="fl">1.819462e+07</span></span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a><span class="dv">1995</span> <span class="dv">1995</span> <span class="fl">9.455491e+06</span></span>
<span id="cb245-16"><a href="#cb245-16" aria-hidden="true" tabindex="-1"></a><span class="dv">1996</span> <span class="dv">1996</span> <span class="fl">5.501951e+05</span></span>
<span id="cb245-17"><a href="#cb245-17" aria-hidden="true" tabindex="-1"></a><span class="dv">1997</span> <span class="dv">1997</span> <span class="fl">2.644355e+06</span></span>
<span id="cb245-18"><a href="#cb245-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1998</span> <span class="dv">1998</span> <span class="fl">2.030516e+05</span></span>
<span id="cb245-19"><a href="#cb245-19" aria-hidden="true" tabindex="-1"></a><span class="dv">1999</span> <span class="dv">1999</span> <span class="fl">2.766914e+06</span></span>
<span id="cb245-20"><a href="#cb245-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span> <span class="dv">2000</span> <span class="fl">3.067984e+06</span></span>
<span id="cb245-21"><a href="#cb245-21" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span> <span class="dv">2001</span> <span class="fl">2.743771e+06</span></span>
<span id="cb245-22"><a href="#cb245-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span> <span class="dv">2002</span> <span class="fl">1.388601e+03</span></span>
<span id="cb245-23"><a href="#cb245-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span> <span class="dv">2003</span> <span class="fl">5.189675e+04</span></span>
<span id="cb245-24"><a href="#cb245-24" aria-hidden="true" tabindex="-1"></a><span class="dv">2004</span> <span class="dv">2004</span> <span class="fl">1.130551e+03</span></span></code></pre></div>
</div>
<div id="variable-mortality-1" class="section level4">
<h4>Variable mortality</h4>
<p>When there is inter-annual variability in natural mortality</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable mortality (22 years between 0.2 &amp; 0.201)</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">22</span>, <span class="at">min=</span><span class="fl">0.2</span>, <span class="at">max=</span><span class="fl">0.201</span>)</span></code></pre></div>
<p>The labelling of survey years (<code>Year</code>) must corresponds to
the elements of <code>M</code> (so <code>Year==1</code> corresponds to
<code>M[1]</code>)</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="do">## M[1] must correspond to Year==1</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>survey.df<span class="sc">$</span>Year0 <span class="ot">&lt;-</span> survey.df<span class="sc">$</span>Year</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>survey.df<span class="sc">$</span>Year <span class="ot">&lt;-</span> survey.df<span class="sc">$</span>Year0<span class="dv">-1983</span></span></code></pre></div>
<p>Estimate the abundance of the first age class</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjust survey abundances to abundance of reference age class</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>rec.df <span class="ot">&lt;-</span> <span class="fu">surveyAdjustGYM</span>(<span class="at">survey.df=</span>survey.df, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M, <span class="at">rcls=</span><span class="dv">1</span>)</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>rec.df<span class="sc">$</span>Year <span class="ot">&lt;-</span> rec.df<span class="sc">$</span>Year<span class="sc">+</span><span class="dv">1983</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>rec.df</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>   Year       RAbund</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1984</span> <span class="fl">1.511409e+03</span></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">1985</span> <span class="fl">1.237384e+03</span></span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">1986</span> <span class="fl">6.662134e+05</span></span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">1987</span> <span class="fl">1.343472e+06</span></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">1988</span> <span class="fl">1.663260e+04</span></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">1989</span> <span class="fl">9.010653e+02</span></span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  <span class="dv">1990</span> <span class="fl">1.041584e+06</span></span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>  <span class="dv">1991</span> <span class="fl">6.047915e+05</span></span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>  <span class="dv">1992</span> <span class="fl">1.055160e+07</span></span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1993</span> <span class="fl">2.361652e+03</span></span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> <span class="dv">1994</span> <span class="fl">1.823828e+07</span></span>
<span id="cb248-17"><a href="#cb248-17" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> <span class="dv">1995</span> <span class="fl">9.473838e+06</span></span>
<span id="cb248-18"><a href="#cb248-18" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> <span class="dv">1996</span> <span class="fl">5.510567e+05</span></span>
<span id="cb248-19"><a href="#cb248-19" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> <span class="dv">1997</span> <span class="fl">2.646540e+06</span></span>
<span id="cb248-20"><a href="#cb248-20" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> <span class="dv">1998</span> <span class="fl">2.034155e+05</span></span>
<span id="cb248-21"><a href="#cb248-21" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> <span class="dv">1999</span> <span class="fl">2.771189e+06</span></span>
<span id="cb248-22"><a href="#cb248-22" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> <span class="dv">2000</span> <span class="fl">3.072933e+06</span></span>
<span id="cb248-23"><a href="#cb248-23" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> <span class="dv">2001</span> <span class="fl">2.746786e+06</span></span>
<span id="cb248-24"><a href="#cb248-24" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> <span class="dv">2002</span> <span class="fl">1.389255e+03</span></span>
<span id="cb248-25"><a href="#cb248-25" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span> <span class="dv">2003</span> <span class="fl">5.192345e+04</span></span>
<span id="cb248-26"><a href="#cb248-26" aria-hidden="true" tabindex="-1"></a><span class="dv">21</span> <span class="dv">2004</span> <span class="fl">1.131333e+03</span></span></code></pre></div>
<p>Abundance cannot be estimated for cohorts that must be projected
outside the time interval spanned by <code>M</code></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>survey.df<span class="sc">$</span>Year <span class="ot">&lt;-</span> survey.df<span class="sc">$</span>Year0<span class="dv">-1985</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjust survey abundances to abundance of reference age class</span></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>rec.df <span class="ot">&lt;-</span> <span class="fu">surveyAdjustGYM</span>(<span class="at">survey.df=</span>survey.df, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M, <span class="at">rcls=</span><span class="dv">1</span>)</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>rec.df<span class="sc">$</span>Year <span class="ot">&lt;-</span> rec.df<span class="sc">$</span>Year<span class="sc">+</span><span class="dv">1985</span></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>rec.df</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a>   Year       RAbund</span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">1</span> <span class="dv">1984</span>           <span class="cn">NA</span></span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1985</span>           <span class="cn">NA</span></span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1986</span> <span class="fl">6.662393e+05</span></span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">1987</span> <span class="fl">1.343715e+06</span></span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">1988</span> <span class="fl">1.663217e+04</span></span>
<span id="cb249-12"><a href="#cb249-12" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">1989</span> <span class="fl">9.001011e+02</span></span>
<span id="cb249-13"><a href="#cb249-13" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">1990</span> <span class="fl">1.040269e+06</span></span>
<span id="cb249-14"><a href="#cb249-14" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">1991</span> <span class="fl">6.041441e+05</span></span>
<span id="cb249-15"><a href="#cb249-15" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  <span class="dv">1992</span> <span class="fl">1.056232e+07</span></span>
<span id="cb249-16"><a href="#cb249-16" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>  <span class="dv">1993</span> <span class="fl">2.364560e+03</span></span>
<span id="cb249-17"><a href="#cb249-17" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>  <span class="dv">1994</span> <span class="fl">1.825905e+07</span></span>
<span id="cb249-18"><a href="#cb249-18" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1995</span> <span class="fl">9.483600e+06</span></span>
<span id="cb249-19"><a href="#cb249-19" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> <span class="dv">1996</span> <span class="fl">5.514622e+05</span></span>
<span id="cb249-20"><a href="#cb249-20" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> <span class="dv">1997</span> <span class="fl">2.648126e+06</span></span>
<span id="cb249-21"><a href="#cb249-21" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> <span class="dv">1998</span> <span class="fl">2.033122e+05</span></span>
<span id="cb249-22"><a href="#cb249-22" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> <span class="dv">1999</span> <span class="fl">2.769242e+06</span></span>
<span id="cb249-23"><a href="#cb249-23" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> <span class="dv">2000</span> <span class="fl">3.071687e+06</span></span>
<span id="cb249-24"><a href="#cb249-24" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> <span class="dv">2001</span> <span class="fl">2.748030e+06</span></span>
<span id="cb249-25"><a href="#cb249-25" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> <span class="dv">2002</span> <span class="fl">1.390756e+03</span></span>
<span id="cb249-26"><a href="#cb249-26" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> <span class="dv">2003</span> <span class="fl">5.193750e+04</span></span>
<span id="cb249-27"><a href="#cb249-27" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> <span class="dv">2004</span> <span class="fl">1.130743e+03</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
